import{A as wb,B as Eb,C as vn,D as fi,E as fh,F as Yc,G as Ny,H as Ib,I as Cb,J as z,K as tn,L as lt,M as Py,N as Db,O as Zc,P as le,Q as an,R as ph,S as ky,T as _n,U as pi,V as vs,W as gh,X as Tb,Y as jn,Z as vt,a as x,b as ge,c as Sy,d as xy,e as _,f as hb,g as ch,h as fb,i as pb,j as D,k as Fo,l as uh,m as gb,n as mb,o as yt,p as lh,q as Qc,r as My,s as yb,t as ar,u as Ry,v as dh,w as vb,x as _b,y as hh,z as et}from"./chunk-NARZPOI4.js";var bb=null;var Oy=1,Fy=Symbol("SIGNAL");function Ie(t){let e=bb;return bb=t,e}var Ab={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function zL(t){if(!(jy(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Oy)){if(!t.producerMustRecompute(t)&&!Vy(t)){t.dirty=!1,t.lastCleanEpoch=Oy;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Oy}}function Sb(t){return t&&(t.nextProducerIndex=0),Ie(t)}function xb(t,e){if(Ie(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(jy(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Ly(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Vy(t){mh(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(zL(n),r!==n.version))return!0}return!1}function Mb(t){if(mh(t),jy(t))for(let e=0;e<t.producerNode.length;e++)Ly(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Ly(t,e){if(WL(t),mh(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Ly(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];mh(i),i.producerIndexOfThis[r]=e}}function jy(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function mh(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function WL(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function KL(){throw new Error}var QL=KL;function Rb(t){QL=t}function Q(t){return typeof t=="function"}function Vo(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var yh=Vo(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function _s(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var We=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(Q(r))try{r()}catch(s){e=s instanceof yh?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{Nb(s)}catch(o){e=e??[],o instanceof yh?e=[...e,...o.errors]:e.push(o)}}if(e)throw new yh(e)}}add(e){var n;if(e&&e!==this)if(this.closed)Nb(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&_s(n,e)}remove(e){let{_finalizers:n}=this;n&&_s(n,e),e instanceof t&&e._removeParent(this)}};We.EMPTY=(()=>{let t=new We;return t.closed=!0,t})();var Uy=We.EMPTY;function vh(t){return t instanceof We||t&&"closed"in t&&Q(t.remove)&&Q(t.add)&&Q(t.unsubscribe)}function Nb(t){Q(t)?t():t.unsubscribe()}var Un={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Lo={setTimeout(t,e,...n){let{delegate:r}=Lo;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=Lo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function _h(t){Lo.setTimeout(()=>{let{onUnhandledError:e}=Un;if(e)e(t);else throw t})}function ws(){}var Pb=By("C",void 0,void 0);function kb(t){return By("E",void 0,t)}function Ob(t){return By("N",t,void 0)}function By(t,e,n){return{kind:t,value:e,error:n}}var Es=null;function jo(t){if(Un.useDeprecatedSynchronousErrorHandling){let e=!Es;if(e&&(Es={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=Es;if(Es=null,n)throw r}}else t()}function Fb(t){Un.useDeprecatedSynchronousErrorHandling&&Es&&(Es.errorThrown=!0,Es.error=t)}var Is=class extends We{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,vh(e)&&e.add(this)):this.destination=XL}static create(e,n,r){return new Ur(e,n,r)}next(e){this.isStopped?qy(Ob(e),this):this._next(e)}error(e){this.isStopped?qy(kb(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?qy(Pb,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},YL=Function.prototype.bind;function $y(t,e){return YL.call(t,e)}var Hy=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){wh(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){wh(r)}else wh(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){wh(n)}}},Ur=class extends Is{constructor(e,n,r){super();let i;if(Q(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&Un.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&$y(e.next,s),error:e.error&&$y(e.error,s),complete:e.complete&&$y(e.complete,s)}):i=e}this.destination=new Hy(i)}};function wh(t){Un.useDeprecatedSynchronousErrorHandling?Fb(t):_h(t)}function ZL(t){throw t}function qy(t,e){let{onStoppedNotification:n}=Un;n&&Lo.setTimeout(()=>n(t,e))}var XL={closed:!0,next:ws,error:ZL,complete:ws};var Uo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function At(t){return t}function Gy(...t){return zy(t)}function zy(t){return t.length===0?At:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var ne=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=e2(n)?n:new Ur(n,r,i);return jo(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=Vb(r),new r((i,s)=>{let o=new Ur({next:a=>{try{n(a)}catch(c){s(c),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[Uo](){return this}pipe(...n){return zy(n)(this)}toPromise(n){return n=Vb(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function Vb(t){var e;return(e=t??Un.Promise)!==null&&e!==void 0?e:Promise}function JL(t){return t&&Q(t.next)&&Q(t.error)&&Q(t.complete)}function e2(t){return t&&t instanceof Is||JL(t)&&vh(t)}function Wy(t){return Q(t?.lift)}function X(t){return e=>{if(Wy(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function Y(t,e,n,r,i){return new Ky(t,e,n,r,i)}var Ky=class extends Is{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(c){e.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){e.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function Bo(){return X((t,e)=>{let n=null;t._refCount++;let r=Y(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var $o=class extends ne{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Wy(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new We;let n=this.getSubject();e.add(this.source.subscribe(Y(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=We.EMPTY)}return e}refCount(){return Bo()(this)}};var Lb=Vo(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var tt=(()=>{class t extends ne{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new Eh(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new Lb}next(n){jo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){jo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){jo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Uy:(this.currentObservers=null,s.push(n),new We(()=>{this.currentObservers=null,_s(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new ne;return n.source=this,n}}return t.create=(e,n)=>new Eh(e,n),t})(),Eh=class extends tt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Uy}};var St=class extends tt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var Xc={now(){return(Xc.delegate||Date).now()},delegate:void 0};var Ih=class extends tt{constructor(e=1/0,n=1/0,r=Xc){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let c=1;c<r.length&&r[c]<=o;c+=2)a=c;a&&r.splice(0,a+1)}}};var Ch=class extends We{constructor(e,n){super()}schedule(e,n=0){return this}};var Jc={setInterval(t,e,...n){let{delegate:r}=Jc;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=Jc;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var qo=class extends Ch{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return Jc.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&Jc.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,_s(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var Ho=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};Ho.now=Xc.now;var Go=class extends Ho{constructor(e,n=Ho.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var Cs=new Go(qo);var Dh=class extends qo{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var Th=class extends Go{};var Qy=new Th(Dh);var nn=new ne(t=>t.complete());function jb(t){return t&&Q(t.schedule)}function Yy(t){return t[t.length-1]}function zo(t){return Q(Yy(t))?t.pop():void 0}function cr(t){return jb(Yy(t))?t.pop():void 0}function Ub(t,e){return typeof Yy(t)=="number"?t.pop():e}var bh=t=>t&&typeof t.length=="number"&&typeof t!="function";function Ah(t){return Q(t?.then)}function Sh(t){return Q(t[Uo])}function xh(t){return Symbol.asyncIterator&&Q(t?.[Symbol.asyncIterator])}function Mh(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function t2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Rh=t2();function Nh(t){return Q(t?.[Rh])}function Ph(t){return fb(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield ch(n.read());if(i)return yield ch(void 0);yield yield ch(r)}}finally{n.releaseLock()}})}function kh(t){return Q(t?.getReader)}function Ae(t){if(t instanceof ne)return t;if(t!=null){if(Sh(t))return n2(t);if(bh(t))return r2(t);if(Ah(t))return i2(t);if(xh(t))return Bb(t);if(Nh(t))return s2(t);if(kh(t))return o2(t)}throw Mh(t)}function n2(t){return new ne(e=>{let n=t[Uo]();if(Q(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function r2(t){return new ne(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function i2(t){return new ne(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,_h)})}function s2(t){return new ne(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function Bb(t){return new ne(e=>{a2(t,e).catch(n=>e.error(n))})}function o2(t){return Bb(Ph(t))}function a2(t,e){var n,r,i,s;return hb(this,void 0,void 0,function*(){try{for(n=pb(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function rn(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function wn(t,e=0){return X((n,r)=>{n.subscribe(Y(r,i=>rn(r,t,()=>r.next(i),e),()=>rn(r,t,()=>r.complete(),e),i=>rn(r,t,()=>r.error(i),e)))})}function Bn(t,e=0){return X((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function $b(t,e){return Ae(t).pipe(Bn(e),wn(e))}function qb(t,e){return Ae(t).pipe(Bn(e),wn(e))}function Hb(t,e){return new ne(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function Gb(t,e){return new ne(n=>{let r;return rn(n,e,()=>{r=t[Rh](),rn(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>Q(r?.return)&&r.return()})}function Oh(t,e){if(!t)throw new Error("Iterable cannot be null");return new ne(n=>{rn(n,e,()=>{let r=t[Symbol.asyncIterator]();rn(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function zb(t,e){return Oh(Ph(t),e)}function Wb(t,e){if(t!=null){if(Sh(t))return $b(t,e);if(bh(t))return Hb(t,e);if(Ah(t))return qb(t,e);if(xh(t))return Oh(t,e);if(Nh(t))return Gb(t,e);if(kh(t))return zb(t,e)}throw Mh(t)}function fe(t,e){return e?Wb(t,e):Ae(t)}function U(...t){let e=cr(t);return fe(t,e)}function Wo(t,e){let n=Q(t)?t:()=>t,r=i=>i.error(n());return new ne(e?i=>e.schedule(r,0,i):r)}function Zy(t){return!!t&&(t instanceof ne||Q(t.lift)&&Q(t.subscribe))}var Br=Vo(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function O(t,e){return X((n,r)=>{let i=0;n.subscribe(Y(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:c2}=Array;function u2(t,e){return c2(e)?t(...e):t(e)}function Fh(t){return O(e=>u2(t,e))}var{isArray:l2}=Array,{getPrototypeOf:d2,prototype:h2,keys:f2}=Object;function Vh(t){if(t.length===1){let e=t[0];if(l2(e))return{args:e,keys:null};if(p2(e)){let n=f2(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function p2(t){return t&&typeof t=="object"&&d2(t)===h2}function Lh(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function eu(...t){let e=cr(t),n=zo(t),{args:r,keys:i}=Vh(t);if(r.length===0)return fe([],e);let s=new ne(g2(r,e,i?o=>Lh(i,o):At));return n?s.pipe(Fh(n)):s}function g2(t,e,n=At){return r=>{Kb(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let c=0;c<i;c++)Kb(e,()=>{let u=fe(t[c],e),l=!1;u.subscribe(Y(r,d=>{s[c]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function Kb(t,e,n){t?rn(n,t,e):e()}function Qb(t,e,n,r,i,s,o,a){let c=[],u=0,l=0,d=!1,h=()=>{d&&!c.length&&!u&&e.complete()},f=g=>u<r?p(g):c.push(g),p=g=>{s&&e.next(g),u++;let m=!1;Ae(n(g,l++)).subscribe(Y(e,w=>{i?.(w),s?f(w):e.next(w)},()=>{m=!0},void 0,()=>{if(m)try{for(u--;c.length&&u<r;){let w=c.shift();o?rn(e,o,()=>p(w)):p(w)}h()}catch(w){e.error(w)}}))};return t.subscribe(Y(e,f,()=>{d=!0,h()})),()=>{a?.()}}function nt(t,e,n=1/0){return Q(e)?nt((r,i)=>O((s,o)=>e(r,s,i,o))(Ae(t(r,i))),n):(typeof e=="number"&&(n=e),X((r,i)=>Qb(r,i,t,n)))}function ur(t=1/0){return nt(At,t)}function Yb(){return ur(1)}function Ko(...t){return Yb()(fe(t,cr(t)))}function jh(t){return new ne(e=>{Ae(t()).subscribe(e)})}function Xy(...t){let e=zo(t),{args:n,keys:r}=Vh(t),i=new ne(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),c=o,u=o;for(let l=0;l<o;l++){let d=!1;Ae(n[l]).subscribe(Y(s,h=>{d||(d=!0,u--),a[l]=h},()=>c--,void 0,()=>{(!c||!d)&&(u||s.next(r?Lh(r,a):a),s.complete())}))}});return e?i.pipe(Fh(e)):i}function Qo(...t){let e=cr(t),n=Ub(t,1/0),r=t;return r.length?r.length===1?Ae(r[0]):ur(n)(fe(r,e)):nn}function dt(t,e){return X((n,r)=>{let i=0;n.subscribe(Y(r,s=>t.call(e,s,i++)&&r.next(s)))})}function gi(t){return X((e,n)=>{let r=null,i=!1,s;r=e.subscribe(Y(n,void 0,void 0,o=>{s=Ae(t(o,gi(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function Zb(t,e,n,r,i){return(s,o)=>{let a=n,c=e,u=0;s.subscribe(Y(o,l=>{let d=u++;c=a?t(c,l,d):(a=!0,l),r&&o.next(c)},i&&(()=>{a&&o.next(c),o.complete()})))}}function $r(t,e){return Q(e)?nt(t,e,1):nt(t,1)}function mi(t){return X((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function $n(t){return t<=0?()=>nn:X((e,n)=>{let r=0;e.subscribe(Y(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Jy(t){return O(()=>t)}function tu(t,e=At){return t=t??m2,X((n,r)=>{let i,s=!0;n.subscribe(Y(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function m2(t,e){return t===e}function Uh(t=y2){return X((e,n)=>{let r=!1;e.subscribe(Y(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function y2(){return new Br}function yi(t){return X((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function En(t,e){let n=arguments.length>=2;return r=>r.pipe(t?dt((i,s)=>t(i,s,r)):At,$n(1),n?mi(e):Uh(()=>new Br))}function Yo(t){return t<=0?()=>nn:X((e,n)=>{let r=[];e.subscribe(Y(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function ev(t,e){let n=arguments.length>=2;return r=>r.pipe(t?dt((i,s)=>t(i,s,r)):At,Yo(1),n?mi(e):Uh(()=>new Br))}function nu(){return X((t,e)=>{let n,r=!1;t.subscribe(Y(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function lr(t,e){return X(Zb(t,e,arguments.length>=2,!0))}function ru(t={}){let{connector:e=()=>new tt,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,c,u=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=c=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return X((g,m)=>{u++,!d&&!l&&h();let w=c=c??e();m.add(()=>{u--,u===0&&!d&&!l&&(a=tv(p,i))}),w.subscribe(m),!o&&u>0&&(o=new Ur({next:P=>w.next(P),error:P=>{d=!0,h(),a=tv(f,n,P),w.error(P)},complete:()=>{l=!0,h(),a=tv(f,r),w.complete()}}),Ae(g).subscribe(o))})(s)}}function tv(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Ur({next:()=>{r.unsubscribe(),t()}});return Ae(e(...n)).subscribe(r)}function Bh(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,ru({connector:()=>new Ih(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function nv(t){return X((e,n)=>{let r=!1,i=0;e.subscribe(Y(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function Ds(...t){let e=cr(t);return X((n,r)=>{(e?Ko(t,n,e):Ko(t,n)).subscribe(r)})}function Re(t,e){return X((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(Y(r,c=>{i?.unsubscribe();let u=0,l=s++;Ae(t(c,l)).subscribe(i=Y(r,d=>r.next(e?e(c,d,l,u++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function $h(t,e){return Q(e)?Re(()=>t,e):Re(()=>t)}function rv(t){return X((e,n)=>{Ae(t).subscribe(Y(n,()=>n.complete(),ws)),!n.closed&&e.subscribe(n)})}function Ke(t,e,n){let r=Q(t)||e||n?{next:t,error:e,complete:n}:t;return r?X((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(Y(s,c=>{var u;(u=r.next)===null||u===void 0||u.call(r,c),s.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),s.complete()},c=>{var u;a=!1,(u=r.error)===null||u===void 0||u.call(r,c),s.error(c)},()=>{var c,u;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(u=r.finalize)===null||u===void 0||u.call(r)}))}):At}function iv(...t){let e=zo(t);return X((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let c=0;c<i;c++)Ae(t[c]).subscribe(Y(r,u=>{s[c]=u,!a&&!o[c]&&(o[c]=!0,(a=o.every(At))&&(o=null))},ws));n.subscribe(Y(r,c=>{if(a){let u=[c,...s];r.next(e?e(...u):u)}}))})}var VA="https://g.co/ng/security#xss",B=class extends Error{constructor(e,n){super(If(e,n)),this.code=e}};function If(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}var wv=class extends tt{constructor(e=!1){super(),this.__isAsync=e}emit(e){let n=Ie(null);try{super.next(e)}finally{Ie(n)}}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let c=e;i=c.next?.bind(c),s=c.error?.bind(c),o=c.complete?.bind(c)}this.__isAsync&&(s=sv(s),i&&(i=sv(i)),o&&(o=sv(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof We&&e.add(a),a}};function sv(t){return e=>{setTimeout(t,void 0,e)}}var Ve=wv;var ce=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ce||{});function $t(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map($t).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function Xb(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var LA=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(LA||{}),fr=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(fr||{});function mu(t){return{toString:t}.toString()}var qt=globalThis;var ra={},Cn=[];function Se(t){for(let e in t)if(t[e]===Se)return e;throw Error("Could not find renamed property on target object.")}function v2(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}var _2=Se({\u0275cmp:Se}),w2=Se({\u0275dir:Se}),E2=Se({\u0275pipe:Se}),I2=Se({\u0275mod:Se}),ef=Se({\u0275fac:Se}),iu=Se({__NG_ELEMENT_ID__:Se}),Jb=Se({__NG_ENV_ID__:Se}),rt=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(rt||{});function jA(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function Ev(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];C2(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function UA(t){return t===3||t===4||t===6}function C2(t){return t.charCodeAt(0)===64}function ou(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?eA(t,n,i,null,e[++r]):eA(t,n,i,null,null))}}return t}function eA(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var BA="ng-template";function D2(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&jA(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function $A(t){return t.type===4&&t.value!==BA}function T2(t,e,n){let r=t.type===4&&!n?BA:t.value;return e===r}function b2(t,e,n){let r=4,i=t.attrs||[],s=x2(i),o=!1;for(let a=0;a<e.length;a++){let c=e[a];if(typeof c=="number"){if(!o&&!qn(r)&&!qn(c))return!1;if(o&&qn(c))continue;o=!1,r=c|r&1;continue}if(!o)if(r&4){if(r=2|r&1,c!==""&&!T2(t,c,n)||c===""&&e.length===1){if(qn(r))return!1;o=!0}}else{let u=r&8?c:e[++a];if(r&8&&t.attrs!==null){if(!D2(t.attrs,u,n)){if(qn(r))return!1;o=!0}continue}let l=r&8?"class":c,d=A2(l,i,$A(t),n);if(d===-1){if(qn(r))return!1;o=!0;continue}if(u!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&jA(f,u,0)!==-1||r&2&&u!==h){if(qn(r))return!1;o=!0}}}}return qn(r)||o}function qn(t){return(t&1)===0}function A2(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return M2(e,t)}function S2(t,e,n=!1){for(let r=0;r<e.length;r++)if(b2(t,e[r],n))return!0;return!1}function x2(t){for(let e=0;e<t.length;e++){let n=t[e];if(UA(n))return e}return t.length}function M2(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function tA(t,e){return t?":not("+e.trim()+")":e}function R2(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!qn(o)&&(e+=tA(s,i),i=""),r=o,s=s||!qn(r);n++}return i!==""&&(e+=tA(s,i)),e}function N2(t){return t.map(R2).join(",")}function P2(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!qn(i))break;i=s}r++}return{attrs:e,classes:n}}function sn(t){return mu(()=>{let e=WA(t),n=ge(x({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===LA.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||fr.Emulated,styles:t.styles||Cn,_:null,schemas:t.schemas||null,tView:null,id:""});KA(n);let r=t.dependencies;return n.directiveDefs=rA(r,!1),n.pipeDefs=rA(r,!0),n.id=F2(n),n})}function k2(t){return wi(t)||qA(t)}function O2(t){return t!==null}function Le(t){return mu(()=>({type:t.type,bootstrap:t.bootstrap||Cn,declarations:t.declarations||Cn,imports:t.imports||Cn,exports:t.exports||Cn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function nA(t,e){if(t==null)return ra;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=rt.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==rt.None?[r,a]:r,e[s]=o):n[s]=r}return n}function it(t){return mu(()=>{let e=WA(t);return KA(e),e})}function wi(t){return t[_2]||null}function qA(t){return t[w2]||null}function HA(t){return t[E2]||null}function GA(t){let e=wi(t)||qA(t)||HA(t);return e!==null?e.standalone:!1}function zA(t,e){let n=t[I2]||null;if(!n&&e===!0)throw new Error(`Type ${$t(t)} does not have '\u0275mod' property.`);return n}function WA(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||ra,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||Cn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:nA(t.inputs,e),outputs:nA(t.outputs),debugInfo:null}}function KA(t){t.features?.forEach(e=>e(t))}function rA(t,e){if(!t)return null;let n=e?HA:k2;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(O2)}function F2(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var Wr=0,ie=1,K=2,xt=3,Hn=4,zn=5,tf=6,au=7,Gn=8,ia=9,qr=10,ht=11,cu=12,iA=13,da=14,pr=15,yu=16,Zo=17,Hr=18,Cf=19,QA=20,_i=21,ov=22,As=23,Ei=25,YA=1;var Ss=7,nf=8,sa=9,cn=10,p_=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(p_||{});function Ts(t){return Array.isArray(t)&&typeof t[YA]=="object"}function Kr(t){return Array.isArray(t)&&t[YA]===!0}function ZA(t){return(t.flags&4)!==0}function Df(t){return t.componentOffset>-1}function g_(t){return(t.flags&1)===1}function Ii(t){return!!t.template}function V2(t){return(t[K]&512)!==0}var L2="svg",j2="math",U2=!1;function B2(){return U2}function gr(t){for(;Array.isArray(t);)t=t[Wr];return t}function XA(t,e){return gr(e[t])}function Dn(t,e){return gr(e[t.index])}function JA(t,e){return t.data[e]}function Di(t,e){let n=e[t];return Ts(n)?n:n[Wr]}function $2(t){return(t[K]&4)===4}function m_(t){return(t[K]&128)===128}function q2(t){return Kr(t[xt])}function rf(t,e){return e==null?null:t[e]}function eS(t){t[Zo]=0}function H2(t){t[K]&1024||(t[K]|=1024,m_(t)&&uu(t))}function G2(t,e){for(;t>0;)e=e[da],t--;return e}function y_(t){return!!(t[K]&9216||t[As]?.dirty)}function Iv(t){y_(t)?uu(t):t[K]&64&&(B2()?(t[K]|=1024,uu(t)):t[qr].changeDetectionScheduler?.notify())}function uu(t){t[qr].changeDetectionScheduler?.notify();let e=lu(t);for(;e!==null&&!(e[K]&8192||(e[K]|=8192,!m_(e)));)e=lu(e)}function tS(t,e){if((t[K]&256)===256)throw new B(911,!1);t[_i]===null&&(t[_i]=[]),t[_i].push(e)}function z2(t,e){if(t[_i]===null)return;let n=t[_i].indexOf(e);n!==-1&&t[_i].splice(n,1)}function lu(t){let e=t[xt];return Kr(e)?e[xt]:e}var he={lFrame:cS(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function W2(){return he.lFrame.elementDepthCount}function K2(){he.lFrame.elementDepthCount++}function Q2(){he.lFrame.elementDepthCount--}function nS(){return he.bindingsEnabled}function Y2(){return he.skipHydrationRootTNode!==null}function Z2(t){return he.skipHydrationRootTNode===t}function X2(){he.skipHydrationRootTNode=null}function be(){return he.lFrame.lView}function Gt(){return he.lFrame.tView}function Tn(t){return he.lFrame.contextLView=t,t[Gn]}function bn(t){return he.lFrame.contextLView=null,t}function zt(){let t=rS();for(;t!==null&&t.type===64;)t=t.parent;return t}function rS(){return he.lFrame.currentTNode}function J2(){let t=he.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function vu(t,e){let n=he.lFrame;n.currentTNode=t,n.isParent=e}function iS(){return he.lFrame.isParent}function ej(){he.lFrame.isParent=!1}function tj(t){return he.lFrame.bindingIndex=t}function Tf(){return he.lFrame.bindingIndex++}function nj(t){let e=he.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function rj(){return he.lFrame.inI18n}function ij(t,e){let n=he.lFrame;n.bindingIndex=n.bindingRootIndex=t,Cv(e)}function sj(){return he.lFrame.currentDirectiveIndex}function Cv(t){he.lFrame.currentDirectiveIndex=t}function oj(t){let e=he.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function sS(){return he.lFrame.currentQueryIndex}function v_(t){he.lFrame.currentQueryIndex=t}function aj(t){let e=t[ie];return e.type===2?e.declTNode:e.type===1?t[zn]:null}function oS(t,e,n){if(n&ce.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ce.Host);)if(i=aj(s),i===null||(s=s[da],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=he.lFrame=aS();return r.currentTNode=e,r.lView=t,!0}function __(t){let e=aS(),n=t[ie];he.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function aS(){let t=he.lFrame,e=t===null?null:t.child;return e===null?cS(t):e}function cS(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function uS(){let t=he.lFrame;return he.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var lS=uS;function w_(){let t=uS();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function cj(t){return(he.lFrame.contextLView=G2(t,he.lFrame.contextLView))[Gn]}function ha(){return he.lFrame.selectedIndex}function xs(t){he.lFrame.selectedIndex=t}function E_(){let t=he.lFrame;return JA(t.tView,t.selectedIndex)}function uj(){return he.lFrame.currentNamespace}var dS=!0;function I_(){return dS}function C_(t){dS=t}function lj(){return fa(zt(),be())}function fa(t,e){return new An(Dn(t,e))}var An=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=lj;let t=e;return t})();function dj(t){return t instanceof An?t.nativeElement:t}function hj(t,e,n){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++){let i=t[r],s=e[r];if(n&&(i=n(i),s=n(s)),s!==i)return!1}return!0}function fj(t){return t.flat(Number.POSITIVE_INFINITY)}function D_(t,e){t.forEach(n=>Array.isArray(n)?D_(n,e):e(n))}function hS(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function sf(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function pj(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function gj(t,e,n){let r=_u(t,e);return r>=0?t[r|1]=n:(r=~r,pj(t,r,e,n)),r}function av(t,e){let n=_u(t,e);if(n>=0)return t[n|1]}function _u(t,e){return mj(t,e,1)}function mj(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}function yj(){return this._results[Symbol.iterator]()}var Dv=class t{get changes(){return this._changes??=new Ve}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let n=t.prototype;n[Symbol.iterator]||(n[Symbol.iterator]=yj)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,n){return this._results.reduce(e,n)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,n){this.dirty=!1;let r=fj(e);(this._changesDetected=!hj(this._results,r,n))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(e){this._onDirty=e}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function fS(t){return(t.flags&128)===128}var Tv;function pS(t){Tv=t}function vj(){if(Tv!==void 0)return Tv;if(typeof document<"u")return document;throw new B(210,!1)}function k(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function je(t){return{providers:t.providers||[],imports:t.imports||[]}}function bf(t){return sA(t,mS)||sA(t,yS)}function gS(t){return bf(t)!==null}function sA(t,e){return t.hasOwnProperty(e)?t[e]:null}function _j(t){let e=t&&(t[mS]||t[yS]);return e||null}function oA(t){return t&&(t.hasOwnProperty(aA)||t.hasOwnProperty(wj))?t[aA]:null}var mS=Se({\u0275prov:Se}),aA=Se({\u0275inj:Se}),yS=Se({ngInjectableDef:Se}),wj=Se({ngInjectorDef:Se}),A=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=k({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}},Af=new A("",{providedIn:"root",factory:()=>Ej}),Ej="ng",T_=new A(""),_t=new A("",{providedIn:"platform",factory:()=>"unknown"});var b_=new A("",{providedIn:"root",factory:()=>vj().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var Ij=Se({__forward_ref__:Se});function Qr(t){return t.__forward_ref__=Qr,t.toString=function(){return $t(this())},t}function Bt(t){return vS(t)?t():t}function vS(t){return typeof t=="function"&&t.hasOwnProperty(Ij)&&t.__forward_ref__===Qr}function _S(t){return t&&!!t.\u0275providers}function Sf(t){return typeof t=="string"?t:t==null?"":String(t)}function Cj(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():Sf(t)}function Dj(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new B(-200,t)}function A_(t,e){throw new B(-201,!1)}var bv;function wS(){return bv}function In(t){let e=bv;return bv=t,e}function ES(t,e,n){let r=bf(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ce.Optional)return null;if(e!==void 0)return e;A_(t,"Injector")}var Tj={},du=Tj,Av="__NG_DI_FLAG__",of="ngTempTokenPath",bj="ngTokenPath",Aj=/\n/gm,Sj="\u0275",cA="__source",ta;function xj(){return ta}function vi(t){let e=ta;return ta=t,e}function Mj(t,e=ce.Default){if(ta===void 0)throw new B(-203,!1);return ta===null?ES(t,void 0,e):ta.get(t,e&ce.Optional?null:void 0,e)}function E(t,e=ce.Default){return(wS()||Mj)(Bt(t),e)}function b(t,e=ce.Default){return E(t,xf(e))}function xf(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Sv(t){let e=[];for(let n=0;n<t.length;n++){let r=Bt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new B(900,!1);let i,s=ce.Default;for(let o=0;o<r.length;o++){let a=r[o],c=Rj(a);typeof c=="number"?c===-1?i=a.token:s|=c:i=a}e.push(E(i,s))}else e.push(E(r))}return e}function IS(t,e){return t[Av]=e,t.prototype[Av]=e,t}function Rj(t){return t[Av]}function Nj(t,e,n,r){let i=t[of];throw e[cA]&&i.unshift(e[cA]),t.message=Pj(`
`+t.message,i,n,r),t[bj]=i,t[of]=null,t}function Pj(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==Sj?t.slice(2):t;let i=$t(e);if(Array.isArray(e))i=e.map($t).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):$t(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(Aj,`
  `)}`}var kj="h",Oj="b";var Fj=()=>null;function S_(t,e,n=!1){return Fj(t,e,n)}var qh="__parameters__";function Vj(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function CS(t,e,n){return mu(()=>{let r=Vj(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(c,u,l){let d=c.hasOwnProperty(qh)?c[qh]:Object.defineProperty(c,qh,{value:[]})[qh];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),c}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}var pa=IS(CS("Optional"),8);var x_=IS(CS("SkipSelf"),4);function oa(t,e){let n=t.hasOwnProperty(ef);return n?t[ef]:null}var aa=new A(""),DS=new A("",-1),TS=new A(""),af=class{get(e,n=du){if(n===du){let r=new Error(`NullInjectorError: No provider for ${$t(e)}!`);throw r.name="NullInjectorError",r}return n}};function Mf(t){return{\u0275providers:t}}function Lj(...t){return{\u0275providers:bS(!0,t),\u0275fromNgModule:!0}}function bS(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return D_(e,o=>{let a=o;xv(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&AS(i,s),n}function AS(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];M_(i,s=>{e(s,r)})}}function xv(t,e,n,r){if(t=Bt(t),!t)return!1;let i=null,s=oA(t),o=!s&&wi(t);if(!s&&!o){let c=t.ngModule;if(s=oA(c),s)i=c;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let c=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let u of c)xv(u,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let u;try{D_(s.imports,l=>{xv(l,e,n,r)&&(u||=[],u.push(l))})}finally{}u!==void 0&&AS(u,e)}if(!a){let u=oa(i)||(()=>new i);e({provide:i,useFactory:u,deps:Cn},i),e({provide:TS,useValue:i,multi:!0},i),e({provide:aa,useValue:()=>E(i),multi:!0},i)}let c=s.providers;if(c!=null&&!a){let u=t;M_(c,l=>{e(l,u)})}}else return!1;return i!==t&&t.providers!==void 0}function M_(t,e){for(let n of t)_S(n)&&(n=n.\u0275providers),Array.isArray(n)?M_(n,e):e(n)}var jj=Se({provide:String,useValue:Se});function SS(t){return t!==null&&typeof t=="object"&&jj in t}function Uj(t){return!!(t&&t.useExisting)}function Bj(t){return!!(t&&t.useFactory)}function ca(t){return typeof t=="function"}function $j(t){return!!t.useClass}var Rf=new A(""),Kh={},qj={},cv;function R_(){return cv===void 0&&(cv=new af),cv}var Ht=class{},hu=class extends Ht{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Rv(e,o=>this.processProvider(o)),this.records.set(DS,Xo(void 0,this)),i.has("environment")&&this.records.set(Ht,Xo(void 0,this));let s=this.records.get(Rf);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(TS,Cn,ce.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let e=Ie(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let n=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of n)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),Ie(e)}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=vi(this),r=In(void 0),i;try{return e()}finally{vi(n),In(r)}}get(e,n=du,r=ce.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(Jb))return e[Jb](this);r=xf(r);let i,s=vi(this),o=In(void 0);try{if(!(r&ce.SkipSelf)){let c=this.records.get(e);if(c===void 0){let u=Kj(e)&&bf(e);u&&this.injectableDefInScope(u)?c=Xo(Mv(e),Kh):c=null,this.records.set(e,c)}if(c!=null)return this.hydrate(e,c)}let a=r&ce.Self?R_():this.parent;return n=r&ce.Optional&&n===du?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[of]=a[of]||[]).unshift($t(e)),s)throw a;return Nj(a,e,"R3InjectorError",this.source)}else throw a}finally{In(o),vi(s)}}resolveInjectorInitializers(){let e=Ie(null),n=vi(this),r=In(void 0),i;try{let s=this.get(aa,Cn,ce.Self);for(let o of s)o()}finally{vi(n),In(r),Ie(e)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push($t(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new B(205,!1)}processProvider(e){e=Bt(e);let n=ca(e)?e:Bt(e&&e.provide),r=Gj(e);if(!ca(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Xo(void 0,Kh,!0),i.factory=()=>Sv(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){let r=Ie(null);try{return n.value===Kh&&(n.value=qj,n.value=n.factory()),typeof n.value=="object"&&n.value&&Wj(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}finally{Ie(r)}}injectableDefInScope(e){if(!e.providedIn)return!1;let n=Bt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function Mv(t){let e=bf(t),n=e!==null?e.factory:oa(t);if(n!==null)return n;if(t instanceof A)throw new B(204,!1);if(t instanceof Function)return Hj(t);throw new B(204,!1)}function Hj(t){if(t.length>0)throw new B(204,!1);let n=_j(t);return n!==null?()=>n.factory(t):()=>new t}function Gj(t){if(SS(t))return Xo(void 0,t.useValue);{let e=xS(t);return Xo(e,Kh)}}function xS(t,e,n){let r;if(ca(t)){let i=Bt(t);return oa(i)||Mv(i)}else if(SS(t))r=()=>Bt(t.useValue);else if(Bj(t))r=()=>t.useFactory(...Sv(t.deps||[]));else if(Uj(t))r=()=>E(Bt(t.useExisting));else{let i=Bt(t&&(t.useClass||t.provide));if(zj(t))r=()=>new i(...Sv(t.deps));else return oa(i)||Mv(i)}return r}function Xo(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function zj(t){return!!t.deps}function Wj(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function Kj(t){return typeof t=="function"||typeof t=="object"&&t instanceof A}function Rv(t,e){for(let n of t)Array.isArray(n)?Rv(n,e):n&&_S(n)?Rv(n.\u0275providers,e):e(n)}function yr(t,e){t instanceof hu&&t.assertNotDestroyed();let n,r=vi(t),i=In(void 0);try{return e()}finally{vi(r),In(i)}}function Qj(t){if(!wS()&&!xj())throw new B(-203,!1)}function Yj(t){let e=qt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function Zj(t){return typeof t=="function"}var Nv=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function MS(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Wn(){return RS}function RS(t){return t.type.prototype.ngOnChanges&&(t.setInput=Jj),Xj}Wn.ngInherit=!0;function Xj(){let t=PS(this),e=t?.current;if(e){let n=t.previous;if(n===ra)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function Jj(t,e,n,r,i){let s=this.declaredInputs[r],o=PS(t)||eU(t,{previous:ra,current:null}),a=o.current||(o.current={}),c=o.previous,u=c[s];a[s]=new Nv(u&&u.currentValue,n,c===ra),MS(t,e,i,n)}var NS="__ngSimpleChanges__";function PS(t){return t[NS]||null}function eU(t,e){return t[NS]=e}var uA=null;var dr=function(t,e,n){uA?.(t,e,n)};function tU(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=RS(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function N_(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:u,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),c&&(t.viewHooks??=[]).push(-n,c),u&&((t.viewHooks??=[]).push(n,u),(t.viewCheckHooks??=[]).push(n,u)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function Qh(t,e,n){kS(t,e,3,n)}function Yh(t,e,n,r){(t[K]&3)===n&&kS(t,e,n,r)}function uv(t,e){let n=t[K];(n&3)===e&&(n&=16383,n+=1,t[K]=n)}function kS(t,e,n,r){let i=r!==void 0?t[Zo]&65535:0,s=r??-1,o=e.length-1,a=0;for(let c=i;c<o;c++)if(typeof e[c+1]=="number"){if(a=e[c],r!=null&&a>=r)break}else e[c]<0&&(t[Zo]+=65536),(a<s||s==-1)&&(nU(t,n,e,c),t[Zo]=(t[Zo]&4294901760)+c+2),c++}function lA(t,e){dr(4,t,e);let n=Ie(null);try{e.call(t)}finally{Ie(n),dr(5,t,e)}}function nU(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[K]>>14<t[Zo]>>16&&(t[K]&3)===e&&(t[K]+=16384,lA(a,s)):lA(a,s)}var na=-1,Ms=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function rU(t){return t instanceof Ms}function iU(t){return(t.flags&8)!==0}function sU(t){return(t.flags&16)!==0}function OS(t){return t!==na}function cf(t){return t&32767}function oU(t){return t>>16}function uf(t,e){let n=oU(t),r=e;for(;n>0;)r=r[da],n--;return r}var Pv=!0;function dA(t){let e=Pv;return Pv=t,e}var aU=256,FS=aU-1,VS=5,cU=0,hr={};function uU(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(iu)&&(r=n[iu]),r==null&&(r=n[iu]=cU++);let i=r&FS,s=1<<i;e.data[t+(i>>VS)]|=s}function lf(t,e){let n=LS(t,e);if(n!==-1)return n;let r=e[ie];r.firstCreatePass&&(t.injectorIndex=e.length,lv(r.data,t),lv(e,null),lv(r.blueprint,null));let i=P_(t,e),s=t.injectorIndex;if(OS(i)){let o=cf(i),a=uf(i,e),c=a[ie].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|c[o+u]}return e[s+8]=i,s}function lv(t,e){t.push(0,0,0,0,0,0,0,0,e)}function LS(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function P_(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=qS(i),r===null)return na;if(n++,i=i[da],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return na}function kv(t,e,n){uU(t,e,n)}function lU(t,e){if(e==="class")return t.classes;if(e==="style")return t.styles;let n=t.attrs;if(n){let r=n.length,i=0;for(;i<r;){let s=n[i];if(UA(s))break;if(s===0)i=i+2;else if(typeof s=="number")for(i++;i<r&&typeof n[i]=="string";)i++;else{if(s===e)return n[i+1];i=i+2}}}return null}function jS(t,e,n){if(n&ce.Optional||t!==void 0)return t;A_(e,"NodeInjector")}function US(t,e,n,r){if(n&ce.Optional&&r===void 0&&(r=null),!(n&(ce.Self|ce.Host))){let i=t[ia],s=In(void 0);try{return i?i.get(e,r,n&ce.Optional):ES(e,r,n&ce.Optional)}finally{In(s)}}return jS(r,e,n)}function BS(t,e,n,r=ce.Default,i){if(t!==null){if(e[K]&2048&&!(r&ce.Self)){let o=pU(t,e,n,r,hr);if(o!==hr)return o}let s=$S(t,e,n,r,hr);if(s!==hr)return s}return US(e,n,r,i)}function $S(t,e,n,r,i){let s=hU(n);if(typeof s=="function"){if(!oS(e,t,r))return r&ce.Host?jS(i,n,r):US(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ce.Optional))A_(n);else return o}finally{lS()}}else if(typeof s=="number"){let o=null,a=LS(t,e),c=na,u=r&ce.Host?e[pr][zn]:null;for((a===-1||r&ce.SkipSelf)&&(c=a===-1?P_(t,e):e[a+8],c===na||!fA(r,!1)?a=-1:(o=e[ie],a=cf(c),e=uf(c,e)));a!==-1;){let l=e[ie];if(hA(s,a,l.data)){let d=dU(a,e,n,o,r,u);if(d!==hr)return d}c=e[a+8],c!==na&&fA(r,e[ie].data[a+8]===u)&&hA(s,a,e)?(o=l,a=cf(c),e=uf(c,e)):a=-1}}return i}function dU(t,e,n,r,i,s){let o=e[ie],a=o.data[t+8],c=r==null?Df(a)&&Pv:r!=o&&(a.type&3)!==0,u=i&ce.Host&&s===a,l=Zh(a,o,n,c,u);return l!==null?Rs(e,o,l,a):hr}function Zh(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,c=t.directiveStart,u=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:u;for(let f=d;f<h;f++){let p=o[f];if(f<c&&n===p||f>=c&&p.type===n)return f}if(i){let f=o[c];if(f&&Ii(f)&&f.type===n)return c}return null}function Rs(t,e,n,r){let i=t[n],s=e.data;if(rU(i)){let o=i;o.resolving&&Dj(Cj(s[n]));let a=dA(o.canSeeViewProviders);o.resolving=!0;let c,u=o.injectImpl?In(o.injectImpl):null,l=oS(t,r,ce.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&tU(n,s[n],e)}finally{u!==null&&In(u),dA(a),o.resolving=!1,lS()}}return i}function hU(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(iu)?t[iu]:void 0;return typeof e=="number"?e>=0?e&FS:fU:e}function hA(t,e,n){let r=1<<t;return!!(n[e+(t>>VS)]&r)}function fA(t,e){return!(t&ce.Self)&&!(t&ce.Host&&e)}var bs=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return BS(this._tNode,this._lView,e,xf(r),n)}};function fU(){return new bs(zt(),be())}function ga(t){return mu(()=>{let e=t.prototype.constructor,n=e[ef]||Ov(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[ef]||Ov(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Ov(t){return vS(t)?()=>{let e=Ov(Bt(t));return e&&e()}:oa(t)}function pU(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[K]&2048&&!(o[K]&512);){let a=$S(s,o,n,r|ce.Self,hr);if(a!==hr)return a;let c=s.parent;if(!c){let u=o[QA];if(u){let l=u.get(n,hr,r);if(l!==hr)return l}c=qS(o),o=o[da]}s=c}return i}function qS(t){let e=t[ie],n=e.type;return n===2?e.declTNode:n===1?t[zn]:null}function k_(t){return lU(zt(),t)}function pA(t,e=null,n=null,r){let i=HS(t,e,n,r);return i.resolveInjectorInitializers(),i}function HS(t,e=null,n=null,r,i=new Set){let s=[n||Cn,Lj(t)];return r=r||(typeof t=="object"?void 0:$t(t)),new hu(s,e||R_(),r||null,i)}var Kn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return pA({name:""},i,r,"");{let s=r.name??"";return pA({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=du,e.NULL=new af,e.\u0275prov=k({token:e,providedIn:"any",factory:()=>E(DS)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})(),gU="ngOriginalError";function dv(t){return t[gU]}var mr=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&dv(e);for(;n&&dv(n);)n=dv(n);return n||null}},GS=new A("",{providedIn:"root",factory:()=>b(mr).handleError.bind(void 0)});var zS=!1,mU=new A("",{providedIn:"root",factory:()=>zS});var Hh;function yU(){if(Hh===void 0&&(Hh=null,qt.trustedTypes))try{Hh=qt.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Hh}function gA(t){return yU()?.createScriptURL(t)||t}var df=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${VA})`}};function wu(t){return t instanceof df?t.changingThisBreaksApplicationSecurity:t}function O_(t,e){let n=vU(t);if(n!=null&&n!==e){if(n==="ResourceURL"&&e==="URL")return!0;throw new Error(`Required a safe ${e}, got a ${n} (see ${VA})`)}return n===e}function vU(t){return t instanceof df&&t.getTypeName()||null}var _U=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function WS(t){return t=String(t),t.match(_U)?t:"unsafe:"+t}var Nf=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Nf||{});function wU(t){let e=QS();return e?e.sanitize(Nf.URL,t)||"":O_(t,"URL")?wu(t):WS(Sf(t))}function EU(t){let e=QS();if(e)return gA(e.sanitize(Nf.RESOURCE_URL,t)||"");if(O_(t,"ResourceURL"))return gA(wu(t));throw new B(904,!1)}function IU(t,e){return e==="src"&&(t==="embed"||t==="frame"||t==="iframe"||t==="media"||t==="script")||e==="href"&&(t==="base"||t==="link")?EU:wU}function KS(t,e,n){return IU(e,n)(t)}function QS(){let t=be();return t&&t[qr].sanitizer}var YS=new Map,CU=0;function DU(){return CU++}function TU(t){YS.set(t[Cf],t)}function bU(t){YS.delete(t[Cf])}var mA="__ngContext__";function Ns(t,e){Ts(e)?(t[mA]=e[Cf],TU(e)):t[mA]=e}function ZS(t){return t instanceof Function?t():t}function AU(t){return(t??b(Kn)).get(_t)==="browser"}var Gr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Gr||{}),SU;function F_(t,e){return SU(t,e)}function Jo(t,e,n,r,i){if(r!=null){let s,o=!1;Kr(r)?s=r:Ts(r)&&(o=!0,r=r[Wr]);let a=gr(r);t===0&&n!==null?i==null?nx(e,n,a):hf(e,n,a,i||null,!0):t===1&&n!==null?hf(e,n,a,i||null,!0):t===2?GU(e,a,o):t===3&&e.destroyNode(a),s!=null&&WU(e,t,s,n,i)}}function xU(t,e){return t.createText(e)}function MU(t,e,n){t.setValue(e,n)}function XS(t,e,n){return t.createElement(e,n)}function RU(t,e){JS(t,e),e[Wr]=null,e[zn]=null}function NU(t,e,n,r,i,s){r[Wr]=i,r[zn]=e,Pf(t,r,n,1,i,s)}function JS(t,e){Pf(t,e,e[ht],2,null,null)}function PU(t){let e=t[cu];if(!e)return hv(t[ie],t);for(;e;){let n=null;if(Ts(e))n=e[cu];else{let r=e[cn];r&&(n=r)}if(!n){for(;e&&!e[Hn]&&e!==t;)Ts(e)&&hv(e[ie],e),e=e[xt];e===null&&(e=t),Ts(e)&&hv(e[ie],e),n=e&&e[Hn]}e=n}}function kU(t,e,n,r){let i=cn+r,s=n.length;r>0&&(n[i-1][Hn]=e),r<s-cn?(e[Hn]=n[i],hS(n,cn+r,e)):(n.push(e),e[Hn]=null),e[xt]=n;let o=e[yu];o!==null&&n!==o&&OU(o,e);let a=e[Hr];a!==null&&a.insertView(t),Iv(e),e[K]|=128}function OU(t,e){let n=t[sa],i=e[xt][xt][pr];e[pr]!==i&&(t[K]|=p_.HasTransplantedViews),n===null?t[sa]=[e]:n.push(e)}function ex(t,e){let n=t[sa],r=n.indexOf(e);n.splice(r,1)}function Fv(t,e){if(t.length<=cn)return;let n=cn+e,r=t[n];if(r){let i=r[yu];i!==null&&i!==t&&ex(i,r),e>0&&(t[n-1][Hn]=r[Hn]);let s=sf(t,cn+e);RU(r[ie],r);let o=s[Hr];o!==null&&o.detachView(s[ie]),r[xt]=null,r[Hn]=null,r[K]&=-129}return r}function tx(t,e){if(!(e[K]&256)){let n=e[ht];n.destroyNode&&Pf(t,e,n,3,null,null),PU(e)}}function hv(t,e){if(e[K]&256)return;let n=Ie(null);try{e[K]&=-129,e[K]|=256,e[As]&&Mb(e[As]),VU(t,e),FU(t,e),e[ie].type===1&&e[ht].destroy();let r=e[yu];if(r!==null&&Kr(e[xt])){r!==e[xt]&&ex(r,e);let i=e[Hr];i!==null&&i.detachView(t)}bU(e)}finally{Ie(n)}}function FU(t,e){let n=t.cleanup,r=e[au];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[au]=null);let i=e[_i];if(i!==null){e[_i]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function VU(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof Ms)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],c=s[o+1];dr(4,a,c);try{c.call(a)}finally{dr(5,a,c)}}else{dr(4,i,s);try{s.call(i)}finally{dr(5,i,s)}}}}}function LU(t,e,n){return jU(t,e.parent,n)}function jU(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Wr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===fr.None||s===fr.Emulated)return null}return Dn(r,n)}}function hf(t,e,n,r,i){t.insertBefore(e,n,r,i)}function nx(t,e,n){t.appendChild(e,n)}function yA(t,e,n,r,i){r!==null?hf(t,e,n,r,i):nx(t,e,n)}function UU(t,e,n,r){t.removeChild(e,n,r)}function V_(t,e){return t.parentNode(e)}function BU(t,e){return t.nextSibling(e)}function $U(t,e,n){return HU(t,e,n)}function qU(t,e,n){return t.type&40?Dn(t,n):null}var HU=qU,vA;function L_(t,e,n,r){let i=LU(t,r,e),s=e[ht],o=r.parent||e[zn],a=$U(o,r,e);if(i!=null)if(Array.isArray(n))for(let c=0;c<n.length;c++)yA(s,i,n[c],a,!1);else yA(s,i,n,a,!1);vA!==void 0&&vA(s,r,e,n,i)}function Xh(t,e){if(e!==null){let n=e.type;if(n&3)return Dn(e,t);if(n&4)return Vv(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return Xh(t,r);{let i=t[e.index];return Kr(i)?Vv(-1,i):gr(i)}}else{if(n&32)return F_(e,t)()||gr(t[e.index]);{let r=rx(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=lu(t[pr]);return Xh(i,r)}else return Xh(t,e.next)}}}return null}function rx(t,e){if(e!==null){let r=t[pr][zn],i=e.projection;return r.projection[i]}return null}function Vv(t,e){let n=cn+t+1;if(n<e.length){let r=e[n],i=r[ie].firstChild;if(i!==null)return Xh(r,i)}return e[Ss]}function GU(t,e,n){let r=V_(t,e);r&&UU(t,r,e,n)}function j_(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],c=n.type;if(o&&e===0&&(a&&Ns(gr(a),r),n.flags|=2),(n.flags&32)!==32)if(c&8)j_(t,e,n.child,r,i,s,!1),Jo(e,t,i,a,s);else if(c&32){let u=F_(n,r),l;for(;l=u();)Jo(e,t,i,l,s);Jo(e,t,i,a,s)}else c&16?zU(t,e,r,n,i,s):Jo(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Pf(t,e,n,r,i,s){j_(n,r,t.firstChild,e,i,s,!1)}function zU(t,e,n,r,i,s){let o=n[pr],c=o[zn].projection[r.projection];if(Array.isArray(c))for(let u=0;u<c.length;u++){let l=c[u];Jo(e,t,i,l,s)}else{let u=c,l=o[xt];fS(r)&&(u.flags|=128),j_(t,e,u,l,i,s,!0)}}function WU(t,e,n,r,i){let s=n[Ss],o=gr(n);s!==o&&Jo(e,t,r,s,i);for(let a=cn;a<n.length;a++){let c=n[a];Pf(c[ie],c,t,e,r,s)}}function KU(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Gr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Gr.Important),t.setStyle(n,r,i,s))}}function QU(t,e,n){t.setAttribute(e,"style",n)}function ix(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function sx(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&Ev(t,e,r),i!==null&&ix(t,e,i),s!==null&&QU(t,e,s)}var ma={};function se(t=1){ox(Gt(),be(),ha()+t,!1)}function ox(t,e,n,r){if(!r)if((e[K]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Qh(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Yh(e,s,0,n)}xs(n)}function L(t,e=ce.Default){let n=be();if(n===null)return E(t,e);let r=zt();return BS(r,n,Bt(t),e)}function ax(){let t="invalid";throw new Error(t)}function cx(t,e,n,r,i,s){let o=Ie(null);try{let a=null;i&rt.SignalBased&&(a=e[r][Fy]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&rt.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):MS(e,a,r,s)}finally{Ie(o)}}function YU(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)xs(~i);else{let s=i,o=n[++r],a=n[++r];ij(o,s);let c=e[s];a(2,c)}}}finally{xs(-1)}}function kf(t,e,n,r,i,s,o,a,c,u,l){let d=e.blueprint.slice();return d[Wr]=i,d[K]=r|4|128|8|64,(u!==null||t&&t[K]&2048)&&(d[K]|=2048),eS(d),d[xt]=d[da]=t,d[Gn]=n,d[qr]=o||t&&t[qr],d[ht]=a||t&&t[ht],d[ia]=c||t&&t[ia]||null,d[zn]=s,d[Cf]=DU(),d[tf]=l,d[QA]=u,d[pr]=e.type==2?t[pr]:d,d}function Of(t,e,n,r,i){let s=t.data[e];if(s===null)s=ZU(t,e,n,r,i),rj()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=J2();s.injectorIndex=o===null?-1:o.injectorIndex}return vu(s,!0),s}function ZU(t,e,n,r,i){let s=rS(),o=iS(),a=o?s:s&&s.parent,c=t.data[e]=rB(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=c),s!==null&&(o?s.child==null&&c.parent!==null&&(s.child=c):s.next===null&&(s.next=c,c.prev=s)),c}function ux(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function lx(t,e,n,r,i){let s=ha(),o=r&2;try{xs(-1),o&&e.length>Ei&&ox(t,e,Ei,!1),dr(o?2:0,i),n(r,i)}finally{xs(s),dr(o?3:1,i)}}function dx(t,e,n){if(ZA(e)){let r=Ie(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];if(a.contentQueries){let c=n[o];a.contentQueries(1,c,o)}}}finally{Ie(r)}}}function hx(t,e,n){nS()&&(uB(t,e,n,Dn(n,e)),(n.flags&64)===64&&vx(t,e,n))}function fx(t,e,n=Dn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function px(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=U_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function U_(t,e,n,r,i,s,o,a,c,u,l){let d=Ei+r,h=d+i,f=XU(d,h),p=typeof u=="function"?u():u;return f[ie]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:c,consts:p,incompleteFirstPass:!1,ssrId:l}}function XU(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:ma);return n}function JU(t,e,n,r){let s=r.get(mU,zS)||n===fr.ShadowDom,o=t.selectRootElement(e,s);return eB(o),o}function eB(t){tB(t)}var tB=()=>null;function nB(t,e,n,r){let i=Ex(e);i.push(n),t.firstCreatePass&&Ix(t).push(r,i.length-1)}function rB(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return Y2()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function _A(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,c=rt.None;Array.isArray(o)?(a=o[0],c=o[1]):a=o;let u=s;if(i!==null){if(!i.hasOwnProperty(s))continue;u=i[s]}t===0?wA(r,n,u,a,c):wA(r,n,u,a)}return r}function wA(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function iB(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],c=null,u=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;c=_A(0,d.inputs,l,c,f),u=_A(1,d.outputs,l,u,p);let g=c!==null&&o!==null&&!$A(e)?wB(c,l,o):null;a.push(g)}c!==null&&(c.hasOwnProperty("class")&&(e.flags|=8),c.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=c,e.outputs=u}function sB(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function gx(t,e,n,r,i,s,o,a){let c=Dn(e,n),u=e.inputs,l;!a&&u!=null&&(l=u[r])?(B_(t,n,l,r,i),Df(e)&&oB(n,e.index)):e.type&3?(r=sB(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(c,r,i)):e.type&12}function oB(t,e){let n=Di(e,t);n[K]&16||(n[K]|=64)}function mx(t,e,n,r){if(nS()){let i=r===null?null:{"":-1},s=dB(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&yx(t,e,n,o,i,a),i&&hB(n,r,i)}n.mergedAttrs=ou(n.mergedAttrs,n.attrs)}function yx(t,e,n,r,i,s){for(let u=0;u<r.length;u++)kv(lf(n,e),t,r[u].type);pB(n,t.data.length,r.length);for(let u=0;u<r.length;u++){let l=r[u];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,c=ux(t,e,r.length,null);for(let u=0;u<r.length;u++){let l=r[u];n.mergedAttrs=ou(n.mergedAttrs,l.hostAttrs),gB(t,n,e,c,l),fB(c,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),c++}iB(t,n,s)}function aB(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;cB(o)!=a&&o.push(a),o.push(n,r,s)}}function cB(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function uB(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;Df(n)&&mB(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||lf(n,e),Ns(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let c=t.data[a],u=Rs(e,t,a,n);if(Ns(u,e),o!==null&&_B(e,a-i,u,c,n,o),Ii(c)){let l=Di(n.index,e);l[Gn]=Rs(e,t,a,n)}}}function vx(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=sj();try{xs(s);for(let a=r;a<i;a++){let c=t.data[a],u=e[a];Cv(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&lB(c,u)}}finally{xs(-1),Cv(o)}}function lB(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function dB(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(S2(e,o.selectors,!1))if(r||(r=[]),Ii(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let c=a.length;Lv(t,e,c)}else r.unshift(o),Lv(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Lv(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function hB(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new B(-301,!1);r.push(e[i],s)}}}function fB(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;Ii(e)&&(n[""]=t)}}function pB(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function gB(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=oa(i.type,!0)),o=new Ms(s,Ii(i),L);t.blueprint[r]=o,n[r]=o,aB(t,e,r,ux(t,n,i.hostVars,ma),i)}function mB(t,e,n){let r=Dn(e,t),i=px(n),s=t[qr].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=Ff(t,kf(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function yB(t,e,n,r,i,s){let o=Dn(t,e);vB(e[ht],o,s,t.value,n,r,i)}function vB(t,e,n,r,i,s,o){if(s==null)t.removeAttribute(e,i,n);else{let a=o==null?Sf(s):o(s,r||"",i);t.setAttribute(e,i,a,n)}}function _B(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let c=o[a++],u=o[a++],l=o[a++],d=o[a++];cx(r,n,c,u,l,d)}}function wB(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function _x(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function wx(t,e){let n=t.contentQueries;if(n!==null){let r=Ie(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];v_(s),a.contentQueries(2,e[o],o)}}}finally{Ie(r)}}}function Ff(t,e){return t[cu]?t[iA][Hn]=e:t[cu]=e,t[iA]=e,e}function jv(t,e,n){v_(0);let r=Ie(null);try{e(t,n)}finally{Ie(r)}}function Ex(t){return t[au]||(t[au]=[])}function Ix(t){return t.cleanup||(t.cleanup=[])}function Cx(t,e){let n=t[ia],r=n?n.get(mr,null):null;r&&r.handleError(e)}function B_(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],c=n[s++],u=e[o],l=t.data[o];cx(l,u,r,a,c,i)}}function EB(t,e,n){let r=XA(e,t);MU(t[ht],r,n)}function IB(t,e){let n=Di(e,t),r=n[ie];CB(r,n);let i=n[Wr];i!==null&&n[tf]===null&&(n[tf]=S_(i,n[ia])),$_(r,n,n[Gn])}function CB(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function $_(t,e,n){__(e);try{let r=t.viewQuery;r!==null&&jv(1,r,n);let i=t.template;i!==null&&lx(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),e[Hr]?.finishViewCreation(t),t.staticContentQueries&&wx(t,e),t.staticViewQueries&&jv(2,t.viewQuery,n);let s=t.components;s!==null&&DB(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[K]&=-5,w_()}}function DB(t,e){for(let n=0;n<e.length;n++)IB(t,e[n])}function TB(t,e,n,r){let i=Ie(null);try{let s=e.tView,a=t[K]&4096?4096:16,c=kf(t,s,n,a,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),u=t[e.index];c[yu]=u;let l=t[Hr];return l!==null&&(c[Hr]=l.createEmbeddedView(s)),$_(s,c,n),c}finally{Ie(i)}}function EA(t,e){return!e||e.firstChild===null||fS(t)}function bB(t,e,n,r=!0){let i=e[ie];if(kU(i,e,t,n),r){let o=Vv(n,t),a=e[ht],c=V_(a,t[Ss]);c!==null&&NU(i,t[zn],a,e,c,o)}let s=e[tf];s!==null&&s.firstChild!==null&&(s.firstChild=null)}function ff(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(gr(s)),Kr(s)&&AB(s,r);let o=n.type;if(o&8)ff(t,e,n.child,r);else if(o&32){let a=F_(n,e),c;for(;c=a();)r.push(c)}else if(o&16){let a=rx(e,n);if(Array.isArray(a))r.push(...a);else{let c=lu(e[pr]);ff(c[ie],c,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function AB(t,e){for(let n=cn;n<t.length;n++){let r=t[n],i=r[ie].firstChild;i!==null&&ff(r[ie],r,i,e)}t[Ss]!==t[Wr]&&e.push(t[Ss])}var Dx=[];function SB(t){return t[As]??xB(t)}function xB(t){let e=Dx.pop()??Object.create(RB);return e.lView=t,e}function MB(t){t.lView[As]!==t&&(t.lView=null,Dx.push(t))}var RB=ge(x({},Ab),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{uu(t.lView)},consumerOnSignalRead(){this.lView[As]=this}});function Tx(t){return Ax(t[cu])}function bx(t){return Ax(t[Hn])}function Ax(t){for(;t!==null&&!Kr(t);)t=t[Hn];return t}var Sx=100;function xx(t,e=!0,n=0){let r=t[qr],i=r.rendererFactory,s=!1;s||i.begin?.();try{NB(t,n)}catch(o){throw e&&Cx(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function NB(t,e){Uv(t,e);let n=0;for(;y_(t);){if(n===Sx)throw new B(103,!1);n++,Uv(t,1)}}function PB(t,e,n,r){let i=e[K];if((i&256)===256)return;let s=!1;!s&&e[qr].inlineEffectRunner?.flush(),__(e);let o=null,a=null;!s&&kB(t)&&(a=SB(e),o=Sb(a));try{eS(e),tj(t.bindingStartIndex),n!==null&&lx(t,e,n,2,r);let c=(i&3)===3;if(!s)if(c){let d=t.preOrderCheckHooks;d!==null&&Qh(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Yh(e,d,0,null),uv(e,0)}if(OB(e),Mx(e,0),t.contentQueries!==null&&wx(t,e),!s)if(c){let d=t.contentCheckHooks;d!==null&&Qh(e,d)}else{let d=t.contentHooks;d!==null&&Yh(e,d,1),uv(e,1)}YU(t,e);let u=t.components;u!==null&&Nx(e,u,0);let l=t.viewQuery;if(l!==null&&jv(2,l,r),!s)if(c){let d=t.viewCheckHooks;d!==null&&Qh(e,d)}else{let d=t.viewHooks;d!==null&&Yh(e,d,2),uv(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[ov]){for(let d of e[ov])d();e[ov]=null}s||(e[K]&=-73)}catch(c){throw uu(e),c}finally{a!==null&&(xb(a,o),MB(a)),w_()}}function kB(t){return t.type!==2}function Mx(t,e){for(let n=Tx(t);n!==null;n=bx(n))for(let r=cn;r<n.length;r++){let i=n[r];Rx(i,e)}}function OB(t){for(let e=Tx(t);e!==null;e=bx(e)){if(!(e[K]&p_.HasTransplantedViews))continue;let n=e[sa];for(let r=0;r<n.length;r++){let i=n[r],s=i[xt];H2(i)}}}function FB(t,e,n){let r=Di(e,t);Rx(r,n)}function Rx(t,e){m_(t)&&Uv(t,e)}function Uv(t,e){let r=t[ie],i=t[K],s=t[As],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Vy(s)),s&&(s.dirty=!1),t[K]&=-9217,o)PB(r,t,r.template,t[Gn]);else if(i&8192){Mx(t,1);let a=r.components;a!==null&&Nx(t,a,1)}}function Nx(t,e,n){for(let r=0;r<e.length;r++)FB(t,e[r],n)}function q_(t){for(t[qr].changeDetectionScheduler?.notify();t;){t[K]|=64;let e=lu(t);if(V2(t)&&!e)return t;t=e}return null}var Ps=class{get rootNodes(){let e=this._lView,n=e[ie];return ff(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Gn]}set context(e){this._lView[Gn]=e}get destroyed(){return(this._lView[K]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[xt];if(Kr(e)){let n=e[nf],r=n?n.indexOf(this):-1;r>-1&&(Fv(e,r),sf(n,r))}this._attachedToViewContainer=!1}tx(this._lView[ie],this._lView)}onDestroy(e){tS(this._lView,e)}markForCheck(){q_(this._cdRefInjectingView||this._lView)}detach(){this._lView[K]&=-129}reattach(){Iv(this._lView),this._lView[K]|=128}detectChanges(){this._lView[K]|=1024,xx(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new B(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,JS(this._lView[ie],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new B(902,!1);this._appRef=e,Iv(this._lView)}},ks=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=jB;let t=e;return t})(),VB=ks,LB=class extends VB{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=TB(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new Ps(i)}};function jB(){return H_(zt(),be())}function H_(t,e){return t.type&4?new LB(e,t,fa(t,e)):null}var Fee=new RegExp(`^(\\d+)*(${Oj}|${kj})*(.*)`);var UB=()=>null;function IA(t,e){return UB(t,e)}var Bv=class{},$v=class{},pf=class{};function BB(t){let e=Error(`No component factory found for ${$t(t)}.`);return e[$B]=t,e}var $B="ngComponent";var qv=class{resolveComponentFactory(e){throw BB(e)}},Vf=(()=>{let e=class e{};e.NULL=new qv;let t=e;return t})(),fu=class{},Ti=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>qB();let t=e;return t})();function qB(){let t=be(),e=zt(),n=Di(e.index,t);return(Ts(n)?n:t)[ht]}var HB=(()=>{let e=class e{};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),fv={},Px=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=GB,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),Hv=class extends Px{constructor(e){super(),this._lView=e}onDestroy(e){return tS(this._lView,e),()=>z2(this._lView,e)}};function GB(){return new Hv(be())}var CA=new Set;function Lf(t){CA.has(t)||(CA.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function DA(...t){}function zB(){let t=typeof qt.requestAnimationFrame=="function",e=qt[t?"requestAnimationFrame":"setTimeout"],n=qt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var de=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ve(!1),this.onMicrotaskEmpty=new Ve(!1),this.onStable=new Ve(!1),this.onError=new Ve(!1),typeof Zone>"u")throw new B(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=zB().nativeRequestAnimationFrame,QB(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new B(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new B(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,WB,DA,DA);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},WB={};function G_(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function KB(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(qt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Gv(t),t.isCheckStableRunning=!0,G_(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Gv(t))}function QB(t){let e=()=>{KB(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(YB(a))return n.invokeTask(i,s,o,a);try{return TA(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),bA(t)}},onInvoke:(n,r,i,s,o,a,c)=>{try{return TA(t),n.invoke(i,s,o,a,c)}finally{t.shouldCoalesceRunChangeDetection&&e(),bA(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,Gv(t),G_(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function Gv(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function TA(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function bA(t){t._nesting--,G_(t)}var zv=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ve,this.onMicrotaskEmpty=new Ve,this.onStable=new Ve,this.onError=new Ve}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function YB(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function ZB(t="zone.js",e){return t==="noop"?new zv:t==="zone.js"?new de(e):t}var ea=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(ea||{}),XB={destroy(){}};function z_(t,e){!e&&Qj(z_);let n=e?.injector??b(Kn);if(!AU(n))return XB;Lf("NgAfterNextRender");let r=n.get(W_),i=r.handler??=new Kv,s=e?.phase??ea.MixedReadWrite,o=()=>{i.unregister(c),a()},a=n.get(Px).onDestroy(o),c=new Wv(n,s,()=>{o(),t()});return i.register(c),{destroy:o}}var Wv=class{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(de),this.errorHandler=e.get(mr,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Kv=class{constructor(){this.executingCallbacks=!1,this.buckets={[ea.EarlyRead]:new Set,[ea.Write]:new Set,[ea.MixedReadWrite]:new Set,[ea.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},W_=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function Qv(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=Xb(i,a);else if(s==2){let c=a,u=e[++o];r=Xb(r,c+": "+u+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var gf=class extends Vf{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=wi(e);return new ua(n,this.ngModule)}};function AA(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function JB(t){let e=t.toLowerCase();return e==="svg"?L2:e==="math"?j2:null}var Yv=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=xf(r);let i=this.injector.get(e,fv,r);return i!==fv||n===fv?i:this.parentInjector.get(e,n,r)}},ua=class extends pf{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=AA(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return AA(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=N2(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){let s=Ie(null);try{i=i||this.ngModule;let o=i instanceof Ht?i:i?.injector;o&&this.componentDef.getStandaloneInjector!==null&&(o=this.componentDef.getStandaloneInjector(o)||o);let a=o?new Yv(e,o):e,c=a.get(fu,null);if(c===null)throw new B(407,!1);let u=a.get(HB,null),l=a.get(W_,null),d=a.get(Bv,null),h={rendererFactory:c,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:l,changeDetectionScheduler:d},f=c.createRenderer(null,this.componentDef),p=this.componentDef.selectors[0][0]||"div",g=r?JU(f,r,this.componentDef.encapsulation,a):XS(f,p,JB(p)),m=512;this.componentDef.signals?m|=4096:this.componentDef.onPush||(m|=16);let w=null;g!==null&&(w=S_(g,a,!0));let P=U_(0,null,null,1,0,null,null,null,null,null,null),T=kf(null,P,null,m,null,null,h,f,a,null,w);__(T);let V,G;try{let W=this.componentDef,Ee,en=null;W.findHostDirectiveDefs?(Ee=[],en=new Map,W.findHostDirectiveDefs(W,Ee,en),Ee.push(W)):Ee=[W];let Ay=e$(T,g),ah=t$(Ay,g,W,Ee,T,h,f);G=JA(P,Ei),g&&i$(f,W,g,r),n!==void 0&&s$(G,this.ngContentSelectors,n),V=r$(ah,W,Ee,en,T,[o$]),$_(P,T,null)}finally{w_()}return new Zv(this.componentType,V,fa(G,T),T,G)}finally{Ie(s)}}},Zv=class extends $v{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new Ps(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;B_(s[ie],s,i,e,n),this.previousInputValues.set(e,n);let o=Di(this._tNode.index,s);q_(o)}}get injector(){return new bs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function e$(t,e){let n=t[ie],r=Ei;return t[r]=e,Of(n,r,2,"#host",null)}function t$(t,e,n,r,i,s,o){let a=i[ie];n$(r,t,e,o);let c=null;e!==null&&(c=S_(e,i[ia]));let u=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=kf(i,px(n),null,l,i[t.index],t,s,u,null,null,c);return a.firstCreatePass&&Lv(a,t,r.length-1),Ff(i,d),i[t.index]=d}function n$(t,e,n,r){for(let i of t)e.mergedAttrs=ou(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Qv(e,e.mergedAttrs,!0),n!==null&&sx(r,n,e))}function r$(t,e,n,r,i,s){let o=zt(),a=i[ie],c=Dn(o,i);yx(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Rs(i,a,d,o);Ns(h,i)}vx(a,i,o),c&&Ns(c,i);let u=Rs(i,a,o.directiveStart+o.componentOffset,o);if(t[Gn]=i[Gn]=u,s!==null)for(let l of s)l(u,e);return dx(a,o,i),u}function i$(t,e,n,r){if(r)Ev(t,n,["ng-version","17.2.4"]);else{let{attrs:i,classes:s}=P2(e.selectors[0]);i&&Ev(t,n,i),s&&s.length>0&&ix(t,n,s.join(" "))}}function s$(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function o$(){let t=zt();N_(be()[ie],t)}var bi=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=a$;let t=e;return t})();function a$(){let t=zt();return Ox(t,be())}var c$=bi,kx=class extends c${constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return fa(this._hostTNode,this._hostLView)}get injector(){return new bs(this._hostTNode,this._hostLView)}get parentInjector(){let e=P_(this._hostTNode,this._hostLView);if(OS(e)){let n=uf(e,this._hostLView),r=cf(e),i=n[ie].data[r+8];return new bs(i,n)}else return new bs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=SA(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-cn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=IA(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,EA(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!Zj(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let c=o?e:new ua(wi(e)),u=r||this.parentInjector;if(!s&&c.ngModule==null){let g=(o?u:this.parentInjector).get(Ht,null);g&&(s=g)}let l=wi(c.componentType??{}),d=IA(this._lContainer,l?.id??null),h=d?.firstChild??null,f=c.create(u,i,h,s);return this.insertImpl(f.hostView,a,EA(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(q2(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let c=i[xt],u=new kx(c,c[zn],c[xt]);u.detach(u.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return bB(o,i,s,r),e.attachToViewContainerRef(),hS(pv(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=SA(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=Fv(this._lContainer,n);r&&(sf(pv(this._lContainer),n),tx(r[ie],r))}detach(e){let n=this._adjustIndex(e,-1),r=Fv(this._lContainer,n);return r&&sf(pv(this._lContainer),n)!=null?new Ps(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function SA(t){return t[nf]}function pv(t){return t[nf]||(t[nf]=[])}function Ox(t,e){let n,r=e[t.index];return Kr(r)?n=r:(n=_x(r,e,null,t),e[t.index]=n,Ff(e,n)),l$(n,e,t,r),new kx(n,t,e)}function u$(t,e){let n=t[ht],r=n.createComment(""),i=Dn(e,t),s=V_(n,i);return hf(n,s,r,BU(n,i),!1),r}var l$=f$,d$=()=>!1;function h$(t,e,n){return d$(t,e,n)}function f$(t,e,n,r){if(t[Ss])return;let i;n.type&8?i=gr(r):i=u$(e,n),t[Ss]=i}var Xv=class t{constructor(e){this.queryList=e,this.matches=null}clone(){return new t(this.queryList)}setDirty(){this.queryList.setDirty()}},Jv=class t{constructor(e=[]){this.queries=e}createEmbeddedView(e){let n=e.queries;if(n!==null){let r=e.contentQueries!==null?e.contentQueries[0]:n.length,i=[];for(let s=0;s<r;s++){let o=n.getByIndex(s),a=this.queries[o.indexInDeclarationView];i.push(a.clone())}return new t(i)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}finishViewCreation(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let n=0;n<this.queries.length;n++)K_(e,n).matches!==null&&this.queries[n].setDirty()}},e_=class{constructor(e,n,r=null){this.flags=n,this.read=r,typeof e=="string"?this.predicate=E$(e):this.predicate=e}},t_=class t{constructor(e=[]){this.queries=e}elementStart(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(e,n)}elementEnd(e){for(let n=0;n<this.queries.length;n++)this.queries[n].elementEnd(e)}embeddedTView(e){let n=null;for(let r=0;r<this.length;r++){let i=n!==null?n.length:0,s=this.getByIndex(r).embeddedTView(e,i);s&&(s.indexInDeclarationView=r,n!==null?n.push(s):n=[s])}return n!==null?new t(n):null}template(e,n){for(let r=0;r<this.queries.length;r++)this.queries[r].template(e,n)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}},n_=class t{constructor(e,n=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}elementStart(e,n){this.isApplyingToNode(n)&&this.matchTNode(e,n)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,n){this.elementStart(e,n)}embeddedTView(e,n){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,n),new t(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let n=this._declarationNodeIndex,r=e.parent;for(;r!==null&&r.type&8&&r.index!==n;)r=r.parent;return n===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(e,n){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let s=r[i];this.matchTNodeWithReadOption(e,n,p$(n,s)),this.matchTNodeWithReadOption(e,n,Zh(n,e,s,!1,!1))}else r===ks?n.type&4&&this.matchTNodeWithReadOption(e,n,-1):this.matchTNodeWithReadOption(e,n,Zh(n,e,r,!1,!1))}matchTNodeWithReadOption(e,n,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===An||i===bi||i===ks&&n.type&4)this.addMatch(n.index,-2);else{let s=Zh(n,e,i,!1,!1);s!==null&&this.addMatch(n.index,s)}else this.addMatch(n.index,r)}}addMatch(e,n){this.matches===null?this.matches=[e,n]:this.matches.push(e,n)}};function p$(t,e){let n=t.localNames;if(n!==null){for(let r=0;r<n.length;r+=2)if(n[r]===e)return n[r+1]}return null}function g$(t,e){return t.type&11?fa(t,e):t.type&4?H_(t,e):null}function m$(t,e,n,r){return n===-1?g$(e,t):n===-2?y$(t,e,r):Rs(t,t[ie],n,e)}function y$(t,e,n){if(n===An)return fa(e,t);if(n===ks)return H_(e,t);if(n===bi)return Ox(e,t)}function Fx(t,e,n,r){let i=e[Hr].queries[r];if(i.matches===null){let s=t.data,o=n.matches,a=[];for(let c=0;o!==null&&c<o.length;c+=2){let u=o[c];if(u<0)a.push(null);else{let l=s[u];a.push(m$(e,l,o[c+1],n.metadata.read))}}i.matches=a}return i.matches}function r_(t,e,n,r){let i=t.queries.getByIndex(n),s=i.matches;if(s!==null){let o=Fx(t,e,i,n);for(let a=0;a<s.length;a+=2){let c=s[a];if(c>0)r.push(o[a/2]);else{let u=s[a+1],l=e[-c];for(let d=cn;d<l.length;d++){let h=l[d];h[yu]===h[xt]&&r_(h[ie],h,u,r)}if(l[sa]!==null){let d=l[sa];for(let h=0;h<d.length;h++){let f=d[h];r_(f[ie],f,u,r)}}}}}return r}function v$(t,e){return t[Hr].queries[e].queryList}function _$(t,e,n){let r=new Dv((n&4)===4);return nB(t,e,r,r.destroy),(e[Hr]??=new Jv).queries.push(new Xv(r))-1}function w$(t,e,n,r){let i=Gt();if(i.firstCreatePass){let s=zt();I$(i,new e_(e,n,r),s.index),C$(i,t),(n&2)===2&&(i.staticContentQueries=!0)}return _$(i,be(),n)}function E$(t){return t.split(",").map(e=>e.trim())}function I$(t,e,n){t.queries===null&&(t.queries=new t_),t.queries.track(new n_(e,n))}function C$(t,e){let n=t.contentQueries||(t.contentQueries=[]),r=n.length?n[n.length-1]:-1;e!==r&&n.push(t.queries.length-1,e)}function K_(t,e){return t.queries.getByIndex(e)}function D$(t,e){let n=t[ie],r=K_(n,e);return r.crossesNgTemplate?r_(n,t,e,[]):Fx(n,t,r,e)}function T$(t){return typeof t=="function"&&t[Fy]!==void 0}function Vx(t){return T$(t)&&typeof t.set=="function"}function b$(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(M$))}return s}return mf.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(u=>{i.template=u}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let u=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[u+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(u=>{a.push(u),i.styleUrl=void 0}));let c=Promise.all(o).then(()=>R$(s));e.push(c)}),S$(),Promise.all(e).then(()=>{})}var mf=new Map,A$=new Set;function S$(){let t=mf;return mf=new Map,t}function x$(){return mf.size===0}function M$(t){return typeof t=="string"?t:t.text()}function R$(t){A$.delete(t)}function N$(t){return Object.getPrototypeOf(t.prototype).constructor}function Qn(t){let e=N$(t.type),n=!0,r=[t];for(;e;){let i;if(Ii(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new B(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Gh(t.inputs),o.inputTransforms=Gh(t.inputTransforms),o.declaredInputs=Gh(t.declaredInputs),o.outputs=Gh(t.outputs);let a=i.hostBindings;a&&V$(t,a);let c=i.viewQuery,u=i.contentQueries;if(c&&O$(t,c),u&&F$(t,u),P$(t,i),v2(t.outputs,i.outputs),Ii(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===Qn&&(n=!1)}}e=Object.getPrototypeOf(e)}k$(r)}function P$(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function k$(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=ou(i.hostAttrs,n=ou(n,i.hostAttrs))}}function Gh(t){return t===ra?{}:t===Cn?[]:t}function O$(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function F$(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function V$(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}function Q_(t){let e=t.inputConfig,n={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r];Array.isArray(i)&&i[3]&&(n[r]=i[3])}t.inputTransforms=n}var Ci=class{},pu=class{};var yf=class extends Ci{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new gf(this);let i=zA(e);this._bootstrapComponents=ZS(i.bootstrap),this._r3Injector=HS(e,n,[{provide:Ci,useValue:this},{provide:Vf,useValue:this.componentFactoryResolver},...r],$t(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},vf=class extends pu{constructor(e){super(),this.moduleType=e}create(e){return new yf(this.moduleType,e,[])}};function L$(t,e,n){return new yf(t,e,n)}var i_=class extends Ci{constructor(e){super(),this.componentFactoryResolver=new gf(this),this.instance=null;let n=new hu([...e.providers,{provide:Ci,useValue:this},{provide:Vf,useValue:this.componentFactoryResolver}],e.parent||R_(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function jf(t,e,n=null){return new i_({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var Fs=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new St(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Lx(t){return U$(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function j$(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function U$(t){return t!==null&&(typeof t=="function"||typeof t=="object")}function Eu(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function B$(t,e,n,r,i,s,o,a,c){let u=e.consts,l=Of(e,t,4,o||null,rf(u,a));mx(e,n,l,rf(u,c)),N_(e,l);let d=l.tView=U_(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function ft(t,e,n,r,i,s,o,a){let c=be(),u=Gt(),l=t+Ei,d=u.firstCreatePass?B$(l,u,c,e,n,r,i,s,o):u.data[l];vu(d,!1);let h=$$(u,c,d,t);I_()&&L_(u,c,h,d),Ns(h,c);let f=_x(h,c,h,d);return c[l]=f,Ff(c,f),h$(f,d,c),g_(d)&&hx(u,c,d),o!=null&&fx(c,d,a),ft}var $$=q$;function q$(t,e,n,r){return C_(!0),e[ht].createComment("")}function Iu(t,e,n,r){let i=be(),s=Tf();if(Eu(i,s,e)){let o=Gt(),a=E_();yB(a,i,t,e,n,r)}return Iu}function H$(t,e,n,r){return Eu(t,Tf(),n)?e+Sf(n)+r:ma}function zh(t,e){return t<<17|e<<2}function Os(t){return t>>17&32767}function G$(t){return(t&2)==2}function z$(t,e){return t&131071|e<<17}function s_(t){return t|2}function la(t){return(t&131068)>>2}function gv(t,e){return t&-131069|e<<2}function W$(t){return(t&1)===1}function o_(t){return t|1}function K$(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=Os(o),c=la(o);t[r]=n;let u=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||_u(d,l)>0)&&(u=!0)}else l=n;if(i)if(c!==0){let h=Os(t[a+1]);t[r+1]=zh(h,a),h!==0&&(t[h+1]=gv(t[h+1],r)),t[a+1]=z$(t[a+1],r)}else t[r+1]=zh(a,0),a!==0&&(t[a+1]=gv(t[a+1],r)),a=r;else t[r+1]=zh(c,0),a===0?a=r:t[c+1]=gv(t[c+1],r),c=r;u&&(t[r+1]=s_(t[r+1])),xA(t,l,r,!0),xA(t,l,r,!1),Q$(e,l,t,r,s),o=zh(a,c),s?e.classBindings=o:e.styleBindings=o}function Q$(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&_u(s,e)>=0&&(n[r+1]=o_(n[r+1]))}function xA(t,e,n,r){let i=t[n+1],s=e===null,o=r?Os(i):la(i),a=!1;for(;o!==0&&(a===!1||s);){let c=t[o],u=t[o+1];Y$(c,e)&&(a=!0,t[o+1]=r?o_(u):s_(u)),o=r?Os(u):la(u)}a&&(t[n+1]=r?s_(i):o_(i))}function Y$(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?_u(t,e)>=0:!1}function Ne(t,e,n){let r=be(),i=Tf();if(Eu(r,i,e)){let s=Gt(),o=E_();gx(s,o,r,t,e,r[ht],n,!1)}return Ne}function MA(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";B_(t,n,s[o],o,r)}function Uf(t,e){return Z$(t,e,null,!0),Uf}function Z$(t,e,n,r){let i=be(),s=Gt(),o=nj(2);if(s.firstUpdatePass&&J$(s,t,o,r),e!==ma&&Eu(i,o,e)){let a=s.data[ha()];i4(s,a,i,i[ht],t,i[o+1]=s4(e,n),r,o)}}function X$(t,e){return e>=t.expandoStartIndex}function J$(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[ha()],o=X$(t,n);o4(s,r)&&e===null&&!o&&(e=!1),e=e4(i,s,e,r),K$(i,s,e,n,o,r)}}function e4(t,e,n,r){let i=oj(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=mv(null,t,e,n,r),n=gu(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=mv(i,t,e,n,r),s===null){let c=t4(t,e,r);c!==void 0&&Array.isArray(c)&&(c=mv(null,t,e,c[1],r),c=gu(c,e.attrs,r),n4(t,e,r,c))}else s=r4(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function t4(t,e,n){let r=n?e.classBindings:e.styleBindings;if(la(r)!==0)return t[Os(r)]}function n4(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[Os(i)]=r}function r4(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=gu(r,o,n)}return gu(r,e.attrs,n)}function mv(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=gu(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function gu(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),gj(t,o,n?!0:e[++s]))}return t===void 0?null:t}function i4(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let c=t.data,u=c[a+1],l=W$(u)?RA(c,e,n,i,la(u),o):void 0;if(!_f(l)){_f(s)||G$(u)&&(s=RA(c,null,n,i,a,o));let d=XA(ha(),n);KU(r,o,d,i,s)}}function RA(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let c=t[i],u=Array.isArray(c),l=u?c[1]:c,d=l===null,h=n[i+1];h===ma&&(h=d?Cn:void 0);let f=d?av(h,r):l===r?h:void 0;if(u&&!_f(f)&&(f=av(c,r)),_f(f)&&(a=f,o))return a;let p=t[i+1];i=o?Os(p):la(p)}if(e!==null){let c=s?e.residualClasses:e.residualStyles;c!=null&&(a=av(c,r))}return a}function _f(t){return t!==void 0}function s4(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=$t(wu(t)))),t}function o4(t,e){return(t.flags&(e?8:16))!==0}function a4(t,e,n,r,i,s){let o=e.consts,a=rf(o,i),c=Of(e,t,2,r,a);return mx(e,n,c,rf(o,s)),c.attrs!==null&&Qv(c,c.attrs,!1),c.mergedAttrs!==null&&Qv(c,c.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,c),c}function j(t,e,n,r){let i=be(),s=Gt(),o=Ei+t,a=i[ht],c=s.firstCreatePass?a4(o,s,i,e,n,r):s.data[o],u=c4(s,i,c,a,e,t);i[o]=u;let l=g_(c);return vu(c,!0),sx(a,u,c),(c.flags&32)!==32&&I_()&&L_(s,i,u,c),W2()===0&&Ns(u,i),K2(),l&&(hx(s,i,c),dx(s,c,i)),r!==null&&fx(i,c),j}function N(){let t=zt();iS()?ej():(t=t.parent,vu(t,!1));let e=t;Z2(e)&&X2(),Q2();let n=Gt();return n.firstCreatePass&&(N_(n,t),ZA(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&iU(e)&&MA(n,e,be(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&sU(e)&&MA(n,e,be(),e.stylesWithoutHost,!1),N}function un(t,e,n,r){return j(t,e,n,r),N(),un}var c4=(t,e,n,r,i,s)=>(C_(!0),XS(r,i,uj()));function ya(){return be()}var wf="en-US";var u4=wf;function l4(t){typeof t=="string"&&(u4=t.toLowerCase().replace(/_/g,"-"))}function pt(t,e,n,r){let i=be(),s=Gt(),o=zt();return jx(s,i,i[ht],o,t,e,r),pt}function d4(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[au],c=i[s+2];return a.length>c?a[c]:null}typeof o=="string"&&(s+=2)}return null}function jx(t,e,n,r,i,s,o){let a=g_(r),u=t.firstCreatePass&&Ix(t),l=e[Gn],d=Ex(e),h=!0;if(r.type&3||o){let g=Dn(r,e),m=o?o(g):g,w=d.length,P=o?V=>o(gr(V[r.index])):r.index,T=null;if(!o&&a&&(T=d4(t,e,i,r.index)),T!==null){let V=T.__ngLastListenerFn__||T;V.__ngNextListenerFn__=s,T.__ngLastListenerFn__=s,h=!1}else{s=PA(r,e,l,s,!1);let V=n.listen(m,i,s);d.push(s,V),u&&u.push(i,P,w,w+1)}}else s=PA(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let m=0;m<g;m+=2){let w=p[m],P=p[m+1],G=e[w][P].subscribe(s),W=d.length;if(d.push(s,G),u){let Ee=typeof G=="function"?W+1:-(W+1);u.push(i,r.index,W,Ee)}}}}function NA(t,e,n,r){let i=Ie(null);try{return dr(6,e,n),n(r)!==!1}catch(s){return Cx(t,s),!1}finally{dr(7,e,n),Ie(i)}}function PA(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?Di(t.index,e):e;q_(a);let c=NA(e,n,r,o),u=s.__ngNextListenerFn__;for(;u;)c=NA(e,n,u,o)&&c,u=u.__ngNextListenerFn__;return i&&c===!1&&o.preventDefault(),c}}function gt(t=1){return cj(t)}function Ux(t,e,n,r){w$(t,e,n,r)}function Bx(t){let e=be(),n=Gt(),r=sS();v_(r+1);let i=K_(n,r);if(t.dirty&&$2(e)===((i.metadata.flags&2)===2)){if(i.matches===null)t.reset([]);else{let s=D$(e,r);t.reset(s,dj),t.notifyOnChanges()}return!0}return!1}function $x(){return v$(be(),sS())}function $(t,e=""){let n=be(),r=Gt(),i=t+Ei,s=r.firstCreatePass?Of(r,i,1,e,null):r.data[i],o=h4(r,n,s,e,t);n[i]=o,I_()&&L_(r,n,o,s),vu(s,!1)}var h4=(t,e,n,r,i)=>(C_(!0),xU(e[ht],r));function Cu(t){return kt("",t,""),Cu}function kt(t,e,n){let r=be(),i=H$(r,t,e,n);return i!==ma&&EB(r,ha(),i),kt}function va(t,e,n){Vx(e)&&(e=e());let r=be(),i=Tf();if(Eu(r,i,e)){let s=Gt(),o=E_();gx(s,o,r,t,e,r[ht],n,!1)}return va}function Du(t,e){let n=Vx(t);return n&&t.set(e),n}function _a(t,e){let n=be(),r=Gt(),i=zt();return jx(r,n,n[ht],i,t,e),_a}function f4(t,e,n){let r=Gt();if(r.firstCreatePass){let i=Ii(t);a_(n,r.data,r.blueprint,i,!0),a_(e,r.data,r.blueprint,i,!1)}}function a_(t,e,n,r,i){if(t=Bt(t),Array.isArray(t))for(let s=0;s<t.length;s++)a_(t[s],e,n,r,i);else{let s=Gt(),o=be(),a=zt(),c=ca(t)?t:Bt(t.provide),u=xS(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(ca(t)||!t.multi){let f=new Ms(u,i,L),p=vv(c,e,i?l:l+h,d);p===-1?(kv(lf(a,o),s,c),yv(s,t,e.length),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=vv(c,e,l+h,d),p=vv(c,e,l,l+h),g=f>=0&&n[f],m=p>=0&&n[p];if(i&&!m||!i&&!g){kv(lf(a,o),s,c);let w=m4(i?g4:p4,n.length,i,r,u);!i&&m&&(n[p].providerFactory=w),yv(s,t,e.length,0),e.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(w),o.push(w)}else{let w=qx(n[i?p:f],u,!i&&r);yv(s,t,f>-1?f:p,w)}!i&&r&&m&&n[p].componentProviders++}}}function yv(t,e,n,r){let i=ca(e),s=$j(e);if(i||s){let c=(s?Bt(e.useClass):e).prototype.ngOnDestroy;if(c){let u=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=u.indexOf(n);l===-1?u.push(n,[r,c]):u[l+1].push(r,c)}else u.push(n,c)}}}function qx(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function vv(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function p4(t,e,n,r){return c_(this.multi,[])}function g4(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Rs(n,n[ie],this.providerFactory.index,r);s=a.slice(0,o),c_(i,s);for(let c=o;c<a.length;c++)s.push(a[c])}else s=[],c_(i,s);return s}function c_(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function m4(t,e,n,r,i){let s=new Ms(t,n,L);return s.multi=[],s.index=e,s.componentProviders=0,qx(s,i,r&&!n),s}function Vs(t,e=[]){return n=>{n.providersResolver=(r,i)=>f4(r,i?i(t):t,e)}}var y4=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=bS(!1,r.type),s=i.length>0?jf([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=k({token:e,providedIn:"environment",factory:()=>new e(E(Ht))});let t=e;return t})();function Hx(t){Lf("NgStandalone"),t.getStandaloneInjector=e=>e.get(y4).getOrCreateStandaloneInjector(t)}var Wh=null;function v4(t){Wh!==null&&(t.defaultEncapsulation!==Wh.defaultEncapsulation||t.preserveWhitespaces!==Wh.preserveWhitespaces)||(Wh=t)}var zr=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},Gx=new zr("17.2.4"),Bf=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();var Y_=new A(""),Tu=new A(""),$f=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,Z_||(_4(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(E(de),E(qf),E(Tu))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),qf=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return Z_?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function _4(t){Z_=t}var Z_;function Ls(t){return!!t&&typeof t.then=="function"}function zx(t){return!!t&&typeof t.subscribe=="function"}var Hf=new A(""),Wx=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=b(Hf,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(Ls(o))r.push(o);else if(zx(o)){let a=new Promise((c,u)=>{o.subscribe({complete:c,error:u})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Gf=new A("");function w4(){Rb(()=>{throw new B(600,!1)})}function E4(t){return t.isBoundToModule}function I4(t,e,n){try{let r=n();return Ls(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function Kx(t,e){return Array.isArray(e)?e.reduce(Kx,t):x(x({},t),e)}var js=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=b(GS),this.afterRenderEffectManager=b(W_),this.componentTypes=[],this.components=[],this.isStable=b(Fs).hasPendingTasks.pipe(O(r=>!r)),this._injector=b(Ht)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof pf;if(!this._injector.get(Wx).done){let f=!s&&GA(r),p=!1;throw new B(405,p)}let a;s?a=r:a=this._injector.get(Vf).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let c=E4(a)?void 0:this._injector.get(Ci),u=i||a.selector,l=a.create(Kn.NULL,[],u,c),d=l.location.nativeElement,h=l.injector.get(Y_,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),Jh(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new B(101,!1);let r=Ie(null);try{this._runningTick=!0,this.detectChangesInAttachedViews()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,Ie(r)}}detectChangesInAttachedViews(){let r=0,i=this.afterRenderEffectManager;for(;;){if(r===Sx)throw new B(103,!1);let s=r===0;for(let{_lView:o,notifyErrorHandler:a}of this._views)!s&&!_v(o)||this.detectChangesInView(o,a,s);if(r++,i.executeInternalCallbacks(),!this._views.some(({_lView:o})=>_v(o))&&(i.execute(),!this._views.some(({_lView:o})=>_v(o))))break}}detectChangesInView(r,i,s){let o;s?(o=0,r[K]|=1024):r[K]&64?o=0:o=1,xx(r,i,o)}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;Jh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(Gf,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>Jh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new B(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Jh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function _v(t){return y_(t)}var u_=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},zf=(()=>{let e=class e{compileModuleSync(r){return new vf(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=zA(r),o=ZS(s.declarations).reduce((a,c)=>{let u=wi(c);return u&&a.push(new ua(u)),a},[]);return new u_(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),C4=new A("");function D4(t,e,n){let r=new vf(n);return Promise.resolve(r)}function kA(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}var T4=(()=>{let e=class e{constructor(){this.zone=b(de),this.applicationRef=b(js)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function b4(t){return[{provide:de,useFactory:t},{provide:aa,multi:!0,useFactory:()=>{let e=b(T4,{optional:!0});return()=>e.initialize()}},{provide:aa,multi:!0,useFactory:()=>{let e=b(x4);return()=>{e.initialize()}}},{provide:GS,useFactory:A4}]}function A4(){let t=b(de),e=b(mr);return n=>t.runOutsideAngular(()=>e.handleError(n))}function S4(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var x4=(()=>{let e=class e{constructor(){this.subscription=new We,this.initialized=!1,this.zone=b(de),this.pendingTasks=b(Fs)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{de.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{de.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function M4(){return typeof $localize<"u"&&$localize.locale||wf}var X_=new A("",{providedIn:"root",factory:()=>b(X_,ce.Optional|ce.SkipSelf)||M4()});var Qx=new A(""),Yx=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=ZB(i?.ngZone,S4({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=L$(r.moduleType,this.injector,b4(()=>s)),a=o.injector.get(mr,null);return s.runOutsideAngular(()=>{let c=s.onError.subscribe({next:u=>{a.handleError(u)}});o.onDestroy(()=>{Jh(this._modules,o),c.unsubscribe()})}),I4(a,s,()=>{let c=o.injector.get(Wx);return c.runInitializers(),c.donePromise.then(()=>{let u=o.injector.get(X_,wf);return l4(u||wf),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=Kx({},i);return D4(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(js);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new B(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new B(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(Qx,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(E(Kn))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),su=null,Zx=new A("");function R4(t){if(su&&!su.get(Zx,!1))throw new B(400,!1);w4(),su=t;let e=t.get(Yx);return k4(t),e}function J_(t,e,n=[]){let r=`Platform: ${e}`,i=new A(r);return(s=[])=>{let o=Xx();if(!o||o.injector.get(Zx,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):R4(N4(a,r))}return P4(i)}}function N4(t=[],e){return Kn.create({name:e,providers:[{provide:Rf,useValue:"platform"},{provide:Qx,useValue:new Set([()=>su=null])},...t]})}function P4(t){let e=Xx();if(!e)throw new B(401,!1);return e}function Xx(){return su?.get(Yx)??null}function k4(t){t.get(T_,null)?.forEach(n=>n())}function ew(){return!1}var Ai=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=O4;let t=e;return t})();function O4(t){return F4(zt(),be(),(t&16)===16)}function F4(t,e,n){if(Df(t)&&!n){let r=Di(t.index,e);return new Ps(r,r)}else if(t.type&47){let r=e[pr];return new Ps(r,e)}return null}var l_=class{constructor(){}supports(e){return Lx(e)}create(e){return new d_(e)}},V4=(t,e)=>e,d_=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||V4}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<OA(r,i,s)?n:r,a=OA(o,i,s),c=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let u=a-i,l=c-i;if(u!=l){for(let h=0;h<u;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<u&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-u}}a!==c&&e(o,a,c)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!Lx(e))throw new B(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,j$(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new h_(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new Ef),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Ef),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},h_=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},f_=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},Ef=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new f_,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function OA(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function FA(){return new tw([new l_])}var tw=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||FA()),deps:[[e,new x_,new pa]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new B(901,!1)}};e.\u0275prov=k({token:e,providedIn:"root",factory:FA});let t=e;return t})();var Jx=J_(null,"core",[]),eM=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(E(js))},e.\u0275mod=Le({type:e}),e.\u0275inj=je({});let t=e;return t})();function Si(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function tM(t){let e=wi(t);if(!e)return null;let n=new ua(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var oM=null;function vr(){return oM}function aM(t){oM??=t}var Wf=class{};var Ot=new A(""),ow=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>b(L4),providedIn:"platform"});let t=e;return t})(),cM=new A(""),L4=(()=>{let e=class e extends ow{constructor(){super(),this._doc=b(Ot),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return vr().getBaseHref(this._doc)}onPopState(r){let i=vr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=vr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function aw(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function nM(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Yr(t){return t&&t[0]!=="?"?"?"+t:t}var Zr=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>b(cw),providedIn:"root"});let t=e;return t})(),uM=new A(""),cw=(()=>{let e=class e extends Zr{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??b(Ot).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return aw(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Yr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(ow),E(uM,8))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),lM=(()=>{let e=class e extends Zr{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=aw(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Yr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(E(ow),E(uM,8))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Ea=(()=>{let e=class e{constructor(r){this._subject=new Ve,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=B4(nM(rM(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Yr(i))}normalize(r){return e.stripTrailingSlash(U4(this._basePath,rM(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Yr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Yr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Yr,e.joinWithSlash=aw,e.stripTrailingSlash=nM,e.\u0275fac=function(i){return new(i||e)(E(Zr))},e.\u0275prov=k({token:e,factory:()=>j4(),providedIn:"root"});let t=e;return t})();function j4(){return new Ea(E(Zr))}function U4(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function rM(t){return t.replace(/\/index.html$/,"")}function B4(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function Kf(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var nw=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},dM=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new nw(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,a),iM(c,s)}});for(let s=0,o=i.length;s<o;s++){let c=i.get(s).context;c.index=s,c.count=o,c.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);iM(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(L(bi),L(ks),L(tw))},e.\u0275dir=it({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function iM(t,e){t.context.$implicit=e.item}var _r=(()=>{let e=class e{constructor(r,i){this._viewContainer=r,this._context=new rw,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(r){this._context.$implicit=this._context.ngIf=r,this._updateView()}set ngIfThen(r){sM("ngIfThen",r),this._thenTemplateRef=r,this._thenViewRef=null,this._updateView()}set ngIfElse(r){sM("ngIfElse",r),this._elseTemplateRef=r,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(L(bi),L(ks))},e.\u0275dir=it({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0});let t=e;return t})(),rw=class{constructor(){this.$implicit=null,this.ngIf=null}};function sM(t,e){if(!!!(!e||e.createEmbeddedView))throw new Error(`${t} must be a TemplateRef, but received '${$t(e)}'.`)}var hM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Le({type:e}),e.\u0275inj=je({});let t=e;return t})(),uw="browser",$4="server";function q4(t){return t===uw}function Us(t){return t===$4}var fM=(()=>{let e=class e{};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>q4(b(_t))?new iw(b(Ot),window):new sw});let t=e;return t})(),iw=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=H4(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function H4(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var sw=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},wa=class{};var Au=class{},Yf=class{},$s=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(n=>{let r=n.indexOf(":");if(r>0){let i=n.slice(0,r),s=i.toLowerCase(),o=n.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((n,r)=>{this.setHeaderEntries(r,n)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([n,r])=>{this.setHeaderEntries(n,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let n=this.headers.get(e.toLowerCase());return n&&n.length>0?n[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,n){return this.clone({name:e,value:n,op:"a"})}set(e,n){return this.clone({name:e,value:n,op:"s"})}delete(e,n){return this.clone({name:e,value:n,op:"d"})}maybeSetNormalizedName(e,n){this.normalizedNames.has(n)||this.normalizedNames.set(n,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(n=>{this.headers.set(n,e.headers.get(n)),this.normalizedNames.set(n,e.normalizedNames.get(n))})}clone(e){let n=new t;return n.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,n.lazyUpdate=(this.lazyUpdate||[]).concat([e]),n}applyUpdate(e){let n=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,n);let i=(e.op==="a"?this.headers.get(n):void 0)||[];i.push(...r),this.headers.set(n,i);break;case"d":let s=e.value;if(!s)this.headers.delete(n),this.normalizedNames.delete(n);else{let o=this.headers.get(n);if(!o)return;o=o.filter(a=>s.indexOf(a)===-1),o.length===0?(this.headers.delete(n),this.normalizedNames.delete(n)):this.headers.set(n,o)}break}}setHeaderEntries(e,n){let r=(Array.isArray(n)?n:[n]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(n=>e(this.normalizedNames.get(n),this.headers.get(n)))}};var dw=class{encodeKey(e){return pM(e)}encodeValue(e){return pM(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function W4(t,e){let n=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[o,a]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=n.get(o)||[];c.push(a),n.set(o,c)}),n}var K4=/%(\d[a-f0-9])/gi,Q4={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function pM(t){return encodeURIComponent(t).replace(K4,(e,n)=>Q4[n]??e)}function Qf(t){return`${t}`}var xi=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new dw,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=W4(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(n=>{let r=e.fromObject[n],i=Array.isArray(r)?r.map(Qf):[Qf(r)];this.map.set(n,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let n=this.map.get(e);return n?n[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,n){return this.clone({param:e,value:n,op:"a"})}appendAll(e){let n=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{n.push({param:r,value:s,op:"a"})}):n.push({param:r,value:i,op:"a"})}),this.clone(n)}set(e,n){return this.clone({param:e,value:n,op:"s"})}delete(e,n){return this.clone({param:e,value:n,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let n=this.encoder.encodeKey(e);return this.map.get(e).map(r=>n+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let n=new t({encoder:this.encoder});return n.cloneFrom=this.cloneFrom||this,n.updates=(this.updates||[]).concat(e),n}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let n=(e.op==="a"?this.map.get(e.param):void 0)||[];n.push(Qf(e.value)),this.map.set(e.param,n);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(Qf(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var hw=class{constructor(){this.map=new Map}set(e,n){return this.map.set(e,n),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function Y4(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function gM(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function mM(t){return typeof Blob<"u"&&t instanceof Blob}function yM(t){return typeof FormData<"u"&&t instanceof FormData}function Z4(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var bu=class t{constructor(e,n,r,i){this.url=n,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(Y4(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new $s,this.context??=new hw,!this.params)this.params=new xi,this.urlWithParams=n;else{let o=this.params.toString();if(o.length===0)this.urlWithParams=n;else{let a=n.indexOf("?"),c=a===-1?"?":a<n.length-1?"&":"";this.urlWithParams=n+c+o}}}serializeBody(){return this.body===null?null:gM(this.body)||mM(this.body)||yM(this.body)||Z4(this.body)||typeof this.body=="string"?this.body:this.body instanceof xi?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||yM(this.body)?null:mM(this.body)?this.body.type||null:gM(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof xi?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let n=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.body!==void 0?e.body:this.body,o=e.withCredentials!==void 0?e.withCredentials:this.withCredentials,a=e.reportProgress!==void 0?e.reportProgress:this.reportProgress,c=e.headers||this.headers,u=e.params||this.params,l=e.context??this.context;return e.setHeaders!==void 0&&(c=Object.keys(e.setHeaders).reduce((d,h)=>d.set(h,e.setHeaders[h]),c)),e.setParams&&(u=Object.keys(e.setParams).reduce((d,h)=>d.set(h,e.setParams[h]),u)),new t(n,r,s,{params:u,headers:c,context:l,reportProgress:a,responseType:i,withCredentials:o})}},Ia=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(Ia||{}),Su=class{constructor(e,n=Jf.Ok,r="OK"){this.headers=e.headers||new $s,this.status=e.status!==void 0?e.status:n,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},fw=class t extends Su{constructor(e={}){super(e),this.type=Ia.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Zf=class t extends Su{constructor(e={}){super(e),this.type=Ia.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Xf=class extends Su{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Jf=function(t){return t[t.Continue=100]="Continue",t[t.SwitchingProtocols=101]="SwitchingProtocols",t[t.Processing=102]="Processing",t[t.EarlyHints=103]="EarlyHints",t[t.Ok=200]="Ok",t[t.Created=201]="Created",t[t.Accepted=202]="Accepted",t[t.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",t[t.NoContent=204]="NoContent",t[t.ResetContent=205]="ResetContent",t[t.PartialContent=206]="PartialContent",t[t.MultiStatus=207]="MultiStatus",t[t.AlreadyReported=208]="AlreadyReported",t[t.ImUsed=226]="ImUsed",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.Found=302]="Found",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.Unused=306]="Unused",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.LengthRequired=411]="LengthRequired",t[t.PreconditionFailed=412]="PreconditionFailed",t[t.PayloadTooLarge=413]="PayloadTooLarge",t[t.UriTooLong=414]="UriTooLong",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.ExpectationFailed=417]="ExpectationFailed",t[t.ImATeapot=418]="ImATeapot",t[t.MisdirectedRequest=421]="MisdirectedRequest",t[t.UnprocessableEntity=422]="UnprocessableEntity",t[t.Locked=423]="Locked",t[t.FailedDependency=424]="FailedDependency",t[t.TooEarly=425]="TooEarly",t[t.UpgradeRequired=426]="UpgradeRequired",t[t.PreconditionRequired=428]="PreconditionRequired",t[t.TooManyRequests=429]="TooManyRequests",t[t.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",t[t.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t[t.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.LoopDetected=508]="LoopDetected",t[t.NotExtended=510]="NotExtended",t[t.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",t}(Jf||{});function lw(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var X4=(()=>{let e=class e{constructor(r){this.handler=r}request(r,i,s={}){let o;if(r instanceof bu)o=r;else{let u;s.headers instanceof $s?u=s.headers:u=new $s(s.headers);let l;s.params&&(s.params instanceof xi?l=s.params:l=new xi({fromObject:s.params})),o=new bu(r,i,s.body!==void 0?s.body:null,{headers:u,context:s.context,params:l,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let a=U(o).pipe($r(u=>this.handler.handle(u)));if(r instanceof bu||s.observe==="events")return a;let c=a.pipe(dt(u=>u instanceof Zf));switch(s.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(O(u=>{if(u.body!==null&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(O(u=>{if(u.body!==null&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(O(u=>{if(u.body!==null&&typeof u.body!="string")throw new Error("Response is not a string.");return u.body}));case"json":default:return c.pipe(O(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(r,i={}){return this.request("DELETE",r,i)}get(r,i={}){return this.request("GET",r,i)}head(r,i={}){return this.request("HEAD",r,i)}jsonp(r,i){return this.request("JSONP",r,{params:new xi().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(r,i={}){return this.request("OPTIONS",r,i)}patch(r,i,s={}){return this.request("PATCH",r,lw(s,i))}post(r,i,s={}){return this.request("POST",r,lw(s,i))}put(r,i,s={}){return this.request("PUT",r,lw(s,i))}};e.\u0275fac=function(i){return new(i||e)(E(Au))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function EM(t,e){return e(t)}function J4(t,e){return(n,r)=>e.intercept(n,{handle:i=>t(i,r)})}function eq(t,e,n){return(r,i)=>yr(n,()=>e(r,s=>t(s,i)))}var tq=new A(""),pw=new A(""),nq=new A(""),rq=new A("");function iq(){let t=null;return(e,n)=>{t===null&&(t=(b(tq,{optional:!0})??[]).reduceRight(J4,EM));let r=b(Fs),i=r.add();return t(e,n).pipe(yi(()=>r.remove(i)))}}var vM=(()=>{let e=class e extends Au{constructor(r,i){super(),this.backend=r,this.injector=i,this.chain=null,this.pendingTasks=b(Fs);let s=b(rq,{optional:!0});this.backend=s??r}handle(r){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(pw),...this.injector.get(nq,[])]));this.chain=s.reduceRight((o,a)=>eq(o,a,this.injector),EM)}let i=this.pendingTasks.add();return this.chain(r,s=>this.backend.handle(s)).pipe(yi(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(E(Yf),E(Ht))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();var sq=/^\)\]\}',?\n/;function oq(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var _M=(()=>{let e=class e{constructor(r){this.xhrFactory=r}handle(r){if(r.method==="JSONP")throw new B(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?fe(i.\u0275loadImpl()):U(null)).pipe(Re(()=>new ne(o=>{let a=i.build();if(a.open(r.method,r.urlWithParams),r.withCredentials&&(a.withCredentials=!0),r.headers.forEach((m,w)=>a.setRequestHeader(m,w.join(","))),r.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!r.headers.has("Content-Type")){let m=r.detectContentTypeHeader();m!==null&&a.setRequestHeader("Content-Type",m)}if(r.responseType){let m=r.responseType.toLowerCase();a.responseType=m!=="json"?m:"text"}let c=r.serializeBody(),u=null,l=()=>{if(u!==null)return u;let m=a.statusText||"OK",w=new $s(a.getAllResponseHeaders()),P=oq(a)||r.url;return u=new fw({headers:w,status:a.status,statusText:m,url:P}),u},d=()=>{let{headers:m,status:w,statusText:P,url:T}=l(),V=null;w!==Jf.NoContent&&(V=typeof a.response>"u"?a.responseText:a.response),w===0&&(w=V?Jf.Ok:0);let G=w>=200&&w<300;if(r.responseType==="json"&&typeof V=="string"){let W=V;V=V.replace(sq,"");try{V=V!==""?JSON.parse(V):null}catch(Ee){V=W,G&&(G=!1,V={error:Ee,text:V})}}G?(o.next(new Zf({body:V,headers:m,status:w,statusText:P,url:T||void 0})),o.complete()):o.error(new Xf({error:V,headers:m,status:w,statusText:P,url:T||void 0}))},h=m=>{let{url:w}=l(),P=new Xf({error:m,status:a.status||0,statusText:a.statusText||"Unknown Error",url:w||void 0});o.error(P)},f=!1,p=m=>{f||(o.next(l()),f=!0);let w={type:Ia.DownloadProgress,loaded:m.loaded};m.lengthComputable&&(w.total=m.total),r.responseType==="text"&&a.responseText&&(w.partialText=a.responseText),o.next(w)},g=m=>{let w={type:Ia.UploadProgress,loaded:m.loaded};m.lengthComputable&&(w.total=m.total),o.next(w)};return a.addEventListener("load",d),a.addEventListener("error",h),a.addEventListener("timeout",h),a.addEventListener("abort",h),r.reportProgress&&(a.addEventListener("progress",p),c!==null&&a.upload&&a.upload.addEventListener("progress",g)),a.send(c),o.next({type:Ia.Sent}),()=>{a.removeEventListener("error",h),a.removeEventListener("abort",h),a.removeEventListener("load",d),a.removeEventListener("timeout",h),r.reportProgress&&(a.removeEventListener("progress",p),c!==null&&a.upload&&a.upload.removeEventListener("progress",g)),a.readyState!==a.DONE&&a.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(E(wa))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),IM=new A(""),aq="XSRF-TOKEN",cq=new A("",{providedIn:"root",factory:()=>aq}),uq="X-XSRF-TOKEN",lq=new A("",{providedIn:"root",factory:()=>uq}),ep=class{},dq=(()=>{let e=class e{constructor(r,i,s){this.doc=r,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let r=this.doc.cookie||"";return r!==this.lastCookieString&&(this.parseCount++,this.lastToken=Kf(r,this.cookieName),this.lastCookieString=r),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(E(Ot),E(_t),E(cq))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function hq(t,e){let n=t.url.toLowerCase();if(!b(IM)||t.method==="GET"||t.method==="HEAD"||n.startsWith("http://")||n.startsWith("https://"))return e(t);let r=b(ep).getToken(),i=b(lq);return r!=null&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,r)})),e(t)}var CM=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(CM||{});function fq(t,e){return{\u0275kind:t,\u0275providers:e}}function pq(...t){let e=[X4,_M,vM,{provide:Au,useExisting:vM},{provide:Yf,useExisting:_M},{provide:pw,useValue:hq,multi:!0},{provide:IM,useValue:!0},{provide:ep,useClass:dq}];for(let n of t)e.push(...n.\u0275providers);return Mf(e)}var wM=new A("");function gq(){return fq(CM.LegacyInterceptors,[{provide:wM,useFactory:iq},{provide:pw,useExisting:wM,multi:!0}])}var DM=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Le({type:e}),e.\u0275inj=je({providers:[pq(gq())]});let t=e;return t})();var yw=class extends Wf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},vw=class t extends yw{static makeCurrent(){aM(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=mq();return n==null?null:yq(n)}resetBaseElement(){xu=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Kf(document.cookie,e)}},xu=null;function mq(){return xu=xu||document.querySelector("base"),xu?xu.getAttribute("href"):null}function yq(t){return new URL(t,document.baseURI).pathname}var _w=class{addToWindow(e){qt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new B(5103,!1);return s},qt.getAllAngularTestabilities=()=>e.getAllTestabilities(),qt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=qt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};qt.frameworkStabilizers||(qt.frameworkStabilizers=[]),qt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?vr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},vq=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),ww=new A(""),SM=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new B(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(E(ww),E(de))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),tp=class{constructor(e){this._doc=e}},gw="ng-app-id",xM=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Us(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${gw}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute(gw),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(gw,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(E(Ot),E(Af),E(b_,8),E(_t))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),mw={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Iw=/%COMP%/g,MM="%COMP%",_q=`_nghost-${MM}`,wq=`_ngcontent-${MM}`,Eq=!0,Iq=new A("",{providedIn:"root",factory:()=>Eq});function Cq(t){return wq.replace(Iw,t)}function Dq(t){return _q.replace(Iw,t)}function RM(t,e){return e.map(n=>n.replace(Iw,t))}var TM=(()=>{let e=class e{constructor(r,i,s,o,a,c,u,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=Us(c),this.defaultRenderer=new Mu(r,a,u,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===fr.ShadowDom&&(i=ge(x({},i),{encapsulation:fr.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof np?s.applyToHost(r):s instanceof Ru&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,c=this.ngZone,u=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case fr.Emulated:o=new np(u,l,i,this.appId,d,a,c,h);break;case fr.ShadowDom:return new Ew(u,l,r,i,a,c,this.nonce,h);default:o=new Ru(u,l,i,d,a,c,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(E(SM),E(xM),E(Af),E(Iq),E(Ot),E(_t),E(de),E(b_))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Mu=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(mw[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(bM(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(bM(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new B(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=mw[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=mw[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Gr.DashCase|Gr.Important)?e.style.setProperty(n,r,i&Gr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Gr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=vr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function bM(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var Ew=class extends Mu{constructor(e,n,r,i,s,o,a,c){super(e,s,o,c),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let u=RM(i.id,i.styles);for(let l of u){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ru=class extends Mu{constructor(e,n,r,i,s,o,a,c){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=c?RM(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},np=class extends Ru{constructor(e,n,r,i,s,o,a,c){let u=i+"-"+r.id;super(e,n,r,s,o,a,c,u),this.contentAttr=Cq(u),this.hostAttr=Dq(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},Tq=(()=>{let e=class e extends tp{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(E(Ot))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),AM=["alt","control","meta","shift"],bq={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Aq={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},Sq=(()=>{let e=class e extends tp{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>vr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),AM.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let u={};return u.domEventName=s,u.fullKey=a,u}static matchEventFullKeyCode(r,i){let s=bq[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),AM.forEach(a=>{if(a!==s){let c=Aq[a];c(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(E(Ot))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function xq(){vw.makeCurrent()}function Mq(){return new mr}function Rq(){return pS(document),document}var Nq=[{provide:_t,useValue:uw},{provide:T_,useValue:xq,multi:!0},{provide:Ot,useFactory:Rq,deps:[]}],NM=J_(Jx,"browser",Nq),Pq=new A(""),kq=[{provide:Tu,useClass:_w,deps:[]},{provide:Y_,useClass:$f,deps:[de,qf,Tu]},{provide:$f,useClass:$f,deps:[de,qf,Tu]}],Oq=[{provide:Rf,useValue:"root"},{provide:mr,useFactory:Mq,deps:[]},{provide:ww,useClass:Tq,multi:!0,deps:[Ot,de,_t]},{provide:ww,useClass:Sq,multi:!0,deps:[Ot]},TM,xM,SM,{provide:fu,useExisting:TM},{provide:wa,useClass:vq,deps:[]},[]],PM=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Af,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(E(Pq,12))},e.\u0275mod=Le({type:e}),e.\u0275inj=je({providers:[...Oq,...kq],imports:[hM,eM]});let t=e;return t})();var kM=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(E(Ot))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var re="primary",zu=Symbol("RouteTitle"),Aw=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Aa(t){return new Aw(t)}function Fq(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function Vq(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!wr(t[n],e[n]))return!1;return!0}function wr(t,e){let n=t?Sw(t):void 0,r=e?Sw(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!HM(t[i],e[i]))return!1;return!0}function Sw(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function HM(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function GM(t){return t.length>0?t[t.length-1]:null}function Pi(t){return Zy(t)?t:Ls(t)?fe(Promise.resolve(t)):U(t)}var Lq={exact:WM,subset:KM},zM={exact:jq,subset:Uq,ignored:()=>!0};function FM(t,e,n){return Lq[n.paths](t.root,e.root,n.matrixParams)&&zM[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function jq(t,e){return wr(t,e)}function WM(t,e,n){if(!Hs(t.segments,e.segments)||!sp(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!WM(t.children[r],e.children[r],n))return!1;return!0}function Uq(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>HM(t[n],e[n]))}function KM(t,e,n){return QM(t,e,e.segments,n)}function QM(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!Hs(i,n)||e.hasChildren()||!sp(i,n,r))}else if(t.segments.length===n.length){if(!Hs(t.segments,n)||!sp(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!KM(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!Hs(t.segments,i)||!sp(t.segments,i,r)||!t.children[re]?!1:QM(t.children[re],e,s,r)}}function sp(t,e,n){return e.every((r,i)=>zM[n](t[i].parameters,r.parameters))}var Mi=class{constructor(e=new Ce([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Aa(this.queryParams),this._queryParamMap}toString(){return qq.serialize(this)}},Ce=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return op(this)}},qs=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Aa(this.parameters),this._parameterMap}toString(){return ZM(this)}};function Bq(t,e){return Hs(t,e)&&t.every((n,r)=>wr(n.parameters,e[r].parameters))}function Hs(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function $q(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===re&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==re&&(n=n.concat(e(i,r)))}),n}var Wu=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>new Lu,providedIn:"root"});let t=e;return t})(),Lu=class{parse(e){let n=new Mw(e);return new Mi(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Nu(e.root,!0)}`,r=zq(e.queryParams),i=typeof e.fragment=="string"?`#${Hq(e.fragment)}`:"";return`${n}${r}${i}`}},qq=new Lu;function op(t){return t.segments.map(e=>ZM(e)).join("/")}function Nu(t,e){if(!t.hasChildren())return op(t);if(e){let n=t.children[re]?Nu(t.children[re],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==re&&r.push(`${i}:${Nu(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=$q(t,(r,i)=>i===re?[Nu(t.children[re],!1)]:[`${i}:${Nu(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[re]!=null?`${op(t)}/${n[0]}`:`${op(t)}/(${n.join("//")})`}}function YM(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function rp(t){return YM(t).replace(/%3B/gi,";")}function Hq(t){return encodeURI(t)}function xw(t){return YM(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ap(t){return decodeURIComponent(t)}function VM(t){return ap(t.replace(/\+/g,"%20"))}function ZM(t){return`${xw(t.path)}${Gq(t.parameters)}`}function Gq(t){return Object.entries(t).map(([e,n])=>`;${xw(e)}=${xw(n)}`).join("")}function zq(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${rp(n)}=${rp(i)}`).join("&"):`${rp(n)}=${rp(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var Wq=/^[^\/()?;#]+/;function Cw(t){let e=t.match(Wq);return e?e[0]:""}var Kq=/^[^\/()?;=#]+/;function Qq(t){let e=t.match(Kq);return e?e[0]:""}var Yq=/^[^=?&#]+/;function Zq(t){let e=t.match(Yq);return e?e[0]:""}var Xq=/^[^&#]+/;function Jq(t){let e=t.match(Xq);return e?e[0]:""}var Mw=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ce([],{}):new Ce([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[re]=new Ce(e,n)),r}parseSegment(){let e=Cw(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new B(4009,!1);return this.capture(e),new qs(ap(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=Qq(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Cw(this.remaining);i&&(r=i,this.capture(r))}e[ap(n)]=ap(r)}parseQueryParam(e){let n=Zq(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=Jq(this.remaining);o&&(r=o,this.capture(r))}let i=VM(n),s=VM(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Cw(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new B(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=re);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[re]:new Ce([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new B(4011,!1)}};function XM(t){return t.segments.length>0?new Ce([],{[re]:t}):t}function JM(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=JM(i);if(r===re&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new Ce(t.segments,e);return eH(n)}function eH(t){if(t.numberOfChildren===1&&t.children[re]){let e=t.children[re];return new Ce(t.segments.concat(e.segments),e.children)}return t}function Sa(t){return t instanceof Mi}function tH(t,e,n=null,r=null){let i=eR(t);return tR(i,e,n,r)}function eR(t){let e;function n(s){let o={};for(let c of s.children){let u=n(c);o[c.outlet]=u}let a=new Ce(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=XM(r);return e??i}function tR(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Dw(i,i,i,n,r);let s=nH(e);if(s.toRoot())return Dw(i,i,new Ce([],{}),n,r);let o=rH(s,i,t),a=o.processChildren?Ou(o.segmentGroup,o.index,s.commands):rR(o.segmentGroup,o.index,s.commands);return Dw(i,o.segmentGroup,a,n,r)}function cp(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function ju(t){return typeof t=="object"&&t!=null&&t.outlets}function Dw(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([c,u])=>{s[c]=Array.isArray(u)?u.map(l=>`${l}`):`${u}`});let o;t===e?o=n:o=nR(t,e,n);let a=XM(JM(o));return new Mi(a,s,i)}function nR(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=nR(s,e,n)}),new Ce(t.segments,r)}var up=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&cp(r[0]))throw new B(4003,!1);let i=r.find(ju);if(i&&i!==GM(r))throw new B(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function nH(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new up(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([c,u])=>{a[c]=typeof u=="string"?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new up(n,e,r)}var Ta=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function rH(t,e,n){if(t.isAbsolute)return new Ta(e,!0,0);if(!n)return new Ta(e,!1,NaN);if(n.parent===null)return new Ta(n,!0,0);let r=cp(t.commands[0])?0:1,i=n.segments.length-1+r;return iH(n,i,t.numberOfDoubleDots)}function iH(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new B(4005,!1);i=r.segments.length}return new Ta(r,!1,i-s)}function sH(t){return ju(t[0])?t[0].outlets:{[re]:t}}function rR(t,e,n){if(t??=new Ce([],{}),t.segments.length===0&&t.hasChildren())return Ou(t,e,n);let r=oH(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new Ce(t.segments.slice(0,r.pathIndex),{});return s.children[re]=new Ce(t.segments.slice(r.pathIndex),t.children),Ou(s,0,i)}else return r.match&&i.length===0?new Ce(t.segments,{}):r.match&&!t.hasChildren()?Rw(t,e,n):r.match?Ou(t,0,i):Rw(t,e,n)}function Ou(t,e,n){if(n.length===0)return new Ce(t.segments,{});{let r=sH(n),i={};if(Object.keys(r).some(s=>s!==re)&&t.children[re]&&t.numberOfChildren===1&&t.children[re].segments.length===0){let s=Ou(t.children[re],e,n);return new Ce(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=rR(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new Ce(t.segments,i)}}function oH(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(ju(a))break;let c=`${a}`,u=r<n.length-1?n[r+1]:null;if(i>0&&c===void 0)break;if(c&&u&&typeof u=="object"&&u.outlets===void 0){if(!jM(c,u,o))return s;r+=2}else{if(!jM(c,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Rw(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(ju(s)){let c=aH(s.outlets);return new Ce(r,c)}if(i===0&&cp(n[0])){let c=t.segments[e];r.push(new qs(c.path,LM(n[0]))),i++;continue}let o=ju(s)?s.outlets[re]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&cp(a)?(r.push(new qs(o,LM(a))),i+=2):(r.push(new qs(o,{})),i++)}return new Ce(r,{})}function aH(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=Rw(new Ce([],{}),0,r))}),e}function LM(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function jM(t,e,n){return t==n.path&&wr(e,n.parameters)}var Fu="imperative",wt=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(wt||{}),xn=class{constructor(e,n){this.id=e,this.url=n}},xa=class extends xn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=wt.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Yn=class extends xn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=wt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Sn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(Sn||{}),lp=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(lp||{}),Ri=class extends xn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=wt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ni=class extends xn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=wt.NavigationSkipped}},Uu=class extends xn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=wt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},dp=class extends xn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=wt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nw=class extends xn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=wt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Pw=class extends xn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=wt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},kw=class extends xn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=wt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ow=class extends xn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=wt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fw=class{constructor(e){this.route=e,this.type=wt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Vw=class{constructor(e){this.route=e,this.type=wt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Lw=class{constructor(e){this.snapshot=e,this.type=wt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},jw=class{constructor(e){this.snapshot=e,this.type=wt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Uw=class{constructor(e){this.snapshot=e,this.type=wt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bw=class{constructor(e){this.snapshot=e,this.type=wt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},hp=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=wt.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},Bu=class{},$u=class{constructor(e){this.url=e}};var $w=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Ku,this.attachRef=null}},Ku=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new $w,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),fp=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=qw(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=qw(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=Hw(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Hw(e,this._root).map(n=>n.value)}};function qw(t,e){if(t===e.value)return e;for(let n of e.children){let r=qw(t,n);if(r)return r}return null}function Hw(t,e){if(t===e.value)return[e];for(let n of e.children){let r=Hw(t,n);if(r.length)return r.unshift(e),r}return[]}var ln=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Da(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var pp=class extends fp{constructor(e,n){super(e),this.snapshot=n,eE(this,e)}toString(){return this.snapshot.toString()}};function iR(t){let e=cH(t),n=new St([new qs("",{})]),r=new St({}),i=new St({}),s=new St({}),o=new St(""),a=new Zn(n,r,s,o,i,re,t,e.root);return a.snapshot=e.root,new pp(new ln(a,[]),e)}function cH(t){let e={},n={},r={},i="",s=new qu([],e,r,i,n,re,t,null,{});return new gp("",new ln(s,[]))}var Zn=class{constructor(e,n,r,i,s,o,a,c){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(O(u=>u[zu]))??U(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(O(e=>Aa(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(O(e=>Aa(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Jw(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:x(x({},e.params),t.params),data:x(x({},e.data),t.data),resolve:x(x(x(x({},t.data),e.data),i?.data),t._resolvedData)}:r={params:x({},t.params),data:x({},t.data),resolve:x(x({},t.data),t._resolvedData??{})},i&&oR(i)&&(r.resolve[zu]=i.title),r}var qu=class{get title(){return this.data?.[zu]}constructor(e,n,r,i,s,o,a,c,u){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=c,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Aa(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Aa(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},gp=class extends fp{constructor(e,n){super(n),this.url=e,eE(this,n)}toString(){return sR(this._root)}};function eE(t,e){e.value._routerState=t,e.children.forEach(n=>eE(t,n))}function sR(t){let e=t.children.length>0?` { ${t.children.map(sR).join(", ")} } `:"";return`${t.value}${e}`}function Tw(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,wr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),wr(e.params,n.params)||t.paramsSubject.next(n.params),Vq(e.url,n.url)||t.urlSubject.next(n.url),wr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function Gw(t,e){let n=wr(t.params,e.params)&&Bq(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||Gw(t.parent,e.parent))}function oR(t){return typeof t.title=="string"||t.title===null}var tE=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=re,this.activateEvents=new Ve,this.deactivateEvents=new Ve,this.attachEvents=new Ve,this.detachEvents=new Ve,this.parentContexts=b(Ku),this.location=b(bi),this.changeDetector=b(Ai),this.environmentInjector=b(Ht),this.inputBinder=b(wp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new B(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new B(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new B(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new B(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new zw(r,c,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:u,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=it({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Wn]});let t=e;return t})(),zw=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Zn?this.route:e===Ku?this.childContexts:this.parent.get(e,n)}},wp=new A(""),UM=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=eu([i.queryParams,i.params,i.data]).pipe(Re(([o,a,c],u)=>(c=x(x(x({},o),a),c),u===0?U(c):Promise.resolve(c)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=tM(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:c}of a.inputs)r.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function uH(t,e,n){let r=Hu(t,e._root,n?n._root:void 0);return new pp(r,e)}function Hu(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=lH(t,e,n);return new ln(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>Hu(t,a)),o}}let r=dH(e.value),i=e.children.map(s=>Hu(t,s));return new ln(r,i)}}function lH(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return Hu(t,r,i);return Hu(t,r)})}function dH(t){return new Zn(new St(t.url),new St(t.params),new St(t.queryParams),new St(t.fragment),new St(t.data),t.outlet,t.component,t)}var aR="ngNavigationCancelingError";function cR(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=Sa(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=uR(!1,Sn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function uR(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[aR]=!0,n.cancellationCode=e,n}function hH(t){return lR(t)&&Sa(t.url)}function lR(t){return!!t&&t[aR]}var fH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=sn({type:e,selectors:[["ng-component"]],standalone:!0,features:[Hx],decls:1,vars:0,template:function(i,s){i&1&&un(0,"router-outlet")},dependencies:[tE],encapsulation:2});let t=e;return t})();function pH(t,e){return t.providers&&!t._injector&&(t._injector=jf(t.providers,e,`Route: ${t.path}`)),t._injector??e}function nE(t){let e=t.children&&t.children.map(nE),n=e?ge(x({},t),{children:e}):x({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==re&&(n.component=fH),n}function Er(t){return t.outlet||re}function gH(t,e){let n=t.filter(r=>Er(r)===e);return n.push(...t.filter(r=>Er(r)!==e)),n}function Qu(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var mH=(t,e,n,r)=>O(i=>(new Ww(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),Ww=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),Tw(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Da(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Da(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Da(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Da(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Bw(s.value.snapshot))}),e.children.length&&this.forwardEvent(new jw(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(Tw(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),Tw(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=Qu(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},mp=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},ba=class{constructor(e,n){this.component=e,this.route=n}};function yH(t,e,n){let r=t._root,i=e?e._root:null;return Pu(r,i,n,[r.value])}function vH(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Na(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!gS(t)?t:e.get(t):r}function Pu(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Da(e);return t.children.forEach(o=>{_H(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Vu(a,n.getContext(o),i)),i}function _H(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let c=wH(o,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new mp(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?Pu(t,e,a?a.children:null,r,i):Pu(t,e,n,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new ba(a.outlet.component,o))}else o&&Vu(e,a,i),i.canActivateChecks.push(new mp(r)),s.component?Pu(t,null,a?a.children:null,r,i):Pu(t,null,n,r,i);return i}function wH(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!Hs(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Hs(t.url,e.url)||!wr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Gw(t,e)||!wr(t.queryParams,e.queryParams);case"paramsChange":default:return!Gw(t,e)}}function Vu(t,e,n){let r=Da(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Vu(o,e.children.getContext(s),n):Vu(o,null,n):Vu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new ba(e.outlet.component,i)):n.canDeactivateChecks.push(new ba(null,i)):n.canDeactivateChecks.push(new ba(null,i))}function Yu(t){return typeof t=="function"}function EH(t){return typeof t=="boolean"}function IH(t){return t&&Yu(t.canLoad)}function CH(t){return t&&Yu(t.canActivate)}function DH(t){return t&&Yu(t.canActivateChild)}function TH(t){return t&&Yu(t.canDeactivate)}function bH(t){return t&&Yu(t.canMatch)}function dR(t){return t instanceof Br||t?.name==="EmptyError"}var ip=Symbol("INITIAL_VALUE");function Ma(){return Re(t=>eu(t.map(e=>e.pipe($n(1),Ds(ip)))).pipe(O(e=>{for(let n of e)if(n!==!0){if(n===ip)return ip;if(n===!1||n instanceof Mi)return n}return!0}),dt(e=>e!==ip),$n(1)))}function AH(t,e){return nt(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?U(ge(x({},n),{guardsResult:!0})):SH(o,r,i,t).pipe(nt(a=>a&&EH(a)?xH(r,s,t,e):U(a)),O(a=>ge(x({},n),{guardsResult:a})))})}function SH(t,e,n,r){return fe(t).pipe(nt(i=>kH(i.component,i.route,n,e,r)),En(i=>i!==!0,!0))}function xH(t,e,n,r){return fe(e).pipe($r(i=>Ko(RH(i.route.parent,r),MH(i.route,r),PH(t,i.path,n),NH(t,i.route,n))),En(i=>i!==!0,!0))}function MH(t,e){return t!==null&&e&&e(new Uw(t)),U(!0)}function RH(t,e){return t!==null&&e&&e(new Lw(t)),U(!0)}function NH(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return U(!0);let i=r.map(s=>jh(()=>{let o=Qu(e)??n,a=Na(s,o),c=CH(a)?a.canActivate(e,t):yr(o,()=>a(e,t));return Pi(c).pipe(En())}));return U(i).pipe(Ma())}function PH(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>vH(o)).filter(o=>o!==null).map(o=>jh(()=>{let a=o.guards.map(c=>{let u=Qu(o.node)??n,l=Na(c,u),d=DH(l)?l.canActivateChild(r,t):yr(u,()=>l(r,t));return Pi(d).pipe(En())});return U(a).pipe(Ma())}));return U(s).pipe(Ma())}function kH(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return U(!0);let o=s.map(a=>{let c=Qu(e)??i,u=Na(a,c),l=TH(u)?u.canDeactivate(t,e,n,r):yr(c,()=>u(t,e,n,r));return Pi(l).pipe(En())});return U(o).pipe(Ma())}function OH(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return U(!0);let s=i.map(o=>{let a=Na(o,t),c=IH(a)?a.canLoad(e,n):yr(t,()=>a(e,n));return Pi(c)});return U(s).pipe(Ma(),hR(r))}function hR(t){return Gy(Ke(e=>{if(Sa(e))throw cR(t,e)}),O(e=>e===!0))}function FH(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return U(!0);let s=i.map(o=>{let a=Na(o,t),c=bH(a)?a.canMatch(e,n):yr(t,()=>a(e,n));return Pi(c)});return U(s).pipe(Ma(),hR(r))}var Gu=class{constructor(e){this.segmentGroup=e||null}},yp=class extends Error{constructor(e){super(),this.urlTree=e}};function Ca(t){return Wo(new Gu(t))}function VH(t){return Wo(new B(4e3,!1))}function LH(t){return Wo(uR(!1,Sn.GuardRejected))}var Kw=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return U(r);if(i.numberOfChildren>1||!i.children[re])return VH(e.redirectTo);i=i.children[re]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new yp(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new Mi(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,c])=>{o[a]=this.createSegmentGroup(e,c,r,i)}),new Ce(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new B(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},Qw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function jH(t,e,n,r,i){let s=rE(t,e,n);return s.matched?(r=pH(e,r),FH(r,e,n,i).pipe(O(o=>o===!0?s:x({},Qw)))):U(s)}function rE(t,e,n){if(e.path==="**")return UH(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?x({},Qw):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Fq)(n,t,e);if(!i)return x({},Qw);let s={};Object.entries(i.posParams??{}).forEach(([a,c])=>{s[a]=c.path});let o=i.consumed.length>0?x(x({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function UH(t){return{matched:!0,parameters:t.length>0?GM(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function BM(t,e,n,r){return n.length>0&&qH(t,n,r)?{segmentGroup:new Ce(e,$H(r,new Ce(n,t.children))),slicedSegments:[]}:n.length===0&&HH(t,n,r)?{segmentGroup:new Ce(t.segments,BH(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new Ce(t.segments,t.children),slicedSegments:n}}function BH(t,e,n,r){let i={};for(let s of n)if(Ep(t,e,s)&&!r[Er(s)]){let o=new Ce([],{});i[Er(s)]=o}return x(x({},r),i)}function $H(t,e){let n={};n[re]=e;for(let r of t)if(r.path===""&&Er(r)!==re){let i=new Ce([],{});n[Er(r)]=i}return n}function qH(t,e,n){return n.some(r=>Ep(t,e,r)&&Er(r)!==re)}function HH(t,e,n){return n.some(r=>Ep(t,e,r))}function Ep(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function GH(t,e,n,r){return Er(t)!==r&&(r===re||!Ep(e,n,t))?!1:rE(e,t,n).matched}function zH(t,e,n){return e.length===0&&!t.children[n]}var Yw=class{};function WH(t,e,n,r,i,s,o="emptyOnly"){return new Zw(t,e,n,r,i,o,s).recognize()}var KH=31,Zw=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Kw(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new B(4002,`'${e.segmentGroup}'`)}recognize(){let e=BM(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(O(n=>{let r=new qu([],Object.freeze({}),Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,{},re,this.rootComponentType,null,{}),i=new ln(r,n),s=new gp("",i),o=tH(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,re).pipe(gi(r=>{if(r instanceof yp)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Gu?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=Jw(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(O(s=>s instanceof ln?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return fe(i).pipe($r(s=>{let o=r.children[s],a=gH(n,s);return this.processSegmentGroup(e,a,o,s)}),lr((s,o)=>(s.push(...o),s)),mi(null),ev(),nt(s=>{if(s===null)return Ca(r);let o=fR(s);return QH(o),U(o)}))}processSegment(e,n,r,i,s,o){return fe(n).pipe($r(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(gi(c=>{if(c instanceof Gu)return U(null);throw c}))),En(a=>!!a),gi(a=>{if(dR(a))return zH(r,i,s)?U(new Yw):Ca(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return GH(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):Ca(i):Ca(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:c,positionalParamSegments:u,remainingSegments:l}=rE(n,i,s);if(!a)return Ca(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>KH&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,u);return this.applyRedirects.lineralizeSegments(i,d).pipe(nt(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=jH(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Re(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Re(({routes:c})=>{let u=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new qu(l,h,Object.freeze(x({},this.urlTree.queryParams)),this.urlTree.fragment,ZH(r),Er(r),r.component??r._loadedComponent??null,r,XH(r)),{segmentGroup:p,slicedSegments:g}=BM(n,l,d,c);if(g.length===0&&p.hasChildren())return this.processChildren(u,c,p).pipe(O(w=>w===null?null:new ln(f,w)));if(c.length===0&&g.length===0)return U(new ln(f,[]));let m=Er(r)===s;return this.processSegment(u,c,p,g,m?re:s,!0).pipe(O(w=>new ln(f,w instanceof ln?[w]:[])))}))):Ca(n)))}getChildConfig(e,n,r){return n.children?U({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?U({routes:n._loadedRoutes,injector:n._loadedInjector}):OH(e,n,r,this.urlSerializer).pipe(nt(i=>i?this.configLoader.loadChildren(e,n).pipe(Ke(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):LH(n))):U({routes:[],injector:e})}};function QH(t){t.sort((e,n)=>e.value.outlet===re?-1:n.value.outlet===re?1:e.value.outlet.localeCompare(n.value.outlet))}function YH(t){let e=t.value.routeConfig;return e&&e.path===""}function fR(t){let e=[],n=new Set;for(let r of t){if(!YH(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=fR(r.children);e.push(new ln(r.value,i))}return e.filter(r=>!n.has(r))}function ZH(t){return t.data||{}}function XH(t){return t.resolve||{}}function JH(t,e,n,r,i,s){return nt(o=>WH(t,e,n,r,o.extractedUrl,i,s).pipe(O(({state:a,tree:c})=>ge(x({},o),{targetSnapshot:a,urlAfterRedirects:c}))))}function eG(t,e){return nt(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return U(n);let s=new Set(i.map(c=>c.route)),o=new Set;for(let c of s)if(!o.has(c))for(let u of pR(c))o.add(u);let a=0;return fe(o).pipe($r(c=>s.has(c)?tG(c,r,t,e):(c.data=Jw(c,c.parent,t).resolve,U(void 0))),Ke(()=>a++),Yo(1),nt(c=>a===o.size?U(n):nn))})}function pR(t){let e=t.children.map(n=>pR(n)).flat();return[t,...e]}function tG(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!oR(i)&&(s[zu]=i.title),nG(s,t,e,r).pipe(O(o=>(t._resolvedData=o,t.data=Jw(t,t.parent,n).resolve,null)))}function nG(t,e,n,r){let i=Sw(t);if(i.length===0)return U({});let s={};return fe(i).pipe(nt(o=>rG(t[o],e,n,r).pipe(En(),Ke(a=>{s[o]=a}))),Yo(1),Jy(s),gi(o=>dR(o)?nn:Wo(o)))}function rG(t,e,n,r){let i=Qu(e)??r,s=Na(t,i),o=s.resolve?s.resolve(e,n):yr(i,()=>s(e,n));return Pi(o)}function bw(t){return Re(e=>{let n=t(e);return n?fe(n).pipe(O(()=>e)):U(e)})}var gR=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===re);return i}getResolvedTitleForRoute(r){return r.data[zu]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>b(iG),providedIn:"root"});let t=e;return t})(),iG=(()=>{let e=class e extends gR{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(E(kM))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Zu=new A("",{providedIn:"root",factory:()=>({})}),vp=new A(""),iE=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=b(zf)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return U(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=Pi(r.loadComponent()).pipe(O(mR),Ke(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),yi(()=>{this.componentLoaders.delete(r)})),s=new $o(i,()=>new tt).pipe(Bo());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return U({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=sG(i,this.compiler,r,this.onLoadEndListener).pipe(yi(()=>{this.childrenLoaders.delete(i)})),a=new $o(o,()=>new tt).pipe(Bo());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function sG(t,e,n,r){return Pi(t.loadChildren()).pipe(O(mR),nt(i=>i instanceof pu||Array.isArray(i)?U(i):fe(e.compileModuleAsync(i))),O(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(vp,[],{optional:!0,self:!0}).flat()),{routes:o.map(nE),injector:s}}))}function oG(t){return t&&typeof t=="object"&&"default"in t}function mR(t){return oG(t)?t.default:t}var sE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>b(aG),providedIn:"root"});let t=e;return t})(),aG=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),yR=new A(""),vR=new A("");function cG(t,e,n){let r=t.get(vR),i=t.get(Ot);return t.get(de).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(u=>{s=u}),a=i.startViewTransition(()=>(s(),uG(t))),{onViewTransitionCreated:c}=r;return c&&yr(t,()=>c({transition:a,from:e,to:n})),o})}function uG(t){return new Promise(e=>{z_(e,{injector:t})})}var oE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new tt,this.transitionAbortSubject=new tt,this.configLoader=b(iE),this.environmentInjector=b(Ht),this.urlSerializer=b(Wu),this.rootContexts=b(Ku),this.location=b(Ea),this.inputBindingEnabled=b(wp,{optional:!0})!==null,this.titleStrategy=b(gR),this.options=b(Zu,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=b(sE),this.createViewTransition=b(yR,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>U(void 0),this.rootComponentType=null;let r=s=>this.events.next(new Fw(s)),i=s=>this.events.next(new Vw(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ge(x(x({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new St({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Fu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(dt(o=>o.id!==0),O(o=>ge(x({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Re(o=>{this.currentTransition=o;let a=!1,c=!1;return U(o).pipe(Ke(u=>{this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?ge(x({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Re(u=>{let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=u.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new Ni(u.id,this.urlSerializer.serialize(u.rawUrl),h,lp.IgnoredSameUrlNavigation)),u.resolve(null),nn}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return U(u).pipe(Re(h=>{let f=this.transitions?.getValue();return this.events.next(new xa(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?nn:Promise.resolve(h)}),JH(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Ke(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ge(x({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new dp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:m}=u,w=new xa(h,this.urlSerializer.serialize(f),p,g);this.events.next(w);let P=iR(this.rootComponentType).snapshot;return this.currentTransition=o=ge(x({},u),{targetSnapshot:P,urlAfterRedirects:f,extras:ge(x({},m),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,U(o)}else{let h="";return this.events.next(new Ni(u.id,this.urlSerializer.serialize(u.extractedUrl),h,lp.IgnoredByUrlHandlingStrategy)),u.resolve(null),nn}}),Ke(u=>{let l=new Nw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(l)}),O(u=>(this.currentTransition=o=ge(x({},u),{guards:yH(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),o)),AH(this.environmentInjector,u=>this.events.next(u)),Ke(u=>{if(o.guardsResult=u.guardsResult,Sa(u.guardsResult))throw cR(this.urlSerializer,u.guardsResult);let l=new Pw(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(l)}),dt(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",Sn.GuardRejected),!1)),bw(u=>{if(u.guards.canActivateChecks.length)return U(u).pipe(Ke(l=>{let d=new kw(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Re(l=>{let d=!1;return U(l).pipe(eG(this.paramsInheritanceStrategy,this.environmentInjector),Ke({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",Sn.NoDataFromResolver)}}))}),Ke(l=>{let d=new Ow(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),bw(u=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Ke(f=>{d.component=f}),O(()=>{})));for(let f of d.children)h.push(...l(f));return h};return eu(l(u.targetSnapshot.root)).pipe(mi(null),$n(1))}),bw(()=>this.afterPreactivation()),Re(()=>{let{currentSnapshot:u,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,u.root,l.root);return d?fe(d).pipe(O(()=>o)):U(o)}),O(u=>{let l=uH(r.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=o=ge(x({},u),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),Ke(()=>{this.events.next(new Bu)}),mH(this.rootContexts,r.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),$n(1),Ke({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Yn(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),rv(this.transitionAbortSubject.pipe(Ke(u=>{throw u}))),yi(()=>{!a&&!c&&this.cancelNavigationTransition(o,"",Sn.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),gi(u=>{if(c=!0,lR(u))this.events.next(new Ri(o.id,this.urlSerializer.serialize(o.extractedUrl),u.message,u.cancellationCode)),hH(u)?this.events.next(new $u(u.url)):o.resolve(!1);else{this.events.next(new Uu(o.id,this.urlSerializer.serialize(o.extractedUrl),u,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(u))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return nn}))}))}cancelNavigationTransition(r,i,s){let o=new Ri(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function lG(t){return t!==Fu}var dG=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>b(hG),providedIn:"root"});let t=e;return t})(),Xw=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},hG=(()=>{let e=class e extends Xw{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ga(e)))(s||e)}})(),e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),_R=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>b(fG),providedIn:"root"});let t=e;return t})(),fG=(()=>{let e=class e extends _R{constructor(){super(...arguments),this.location=b(Ea),this.urlSerializer=b(Wu),this.options=b(Zu,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=b(sE),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Mi,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=iR(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof xa)this.stateMemento=this.createStateMemento();else if(r instanceof Ni)this.rawUrlTree=i.initialUrl;else if(r instanceof dp){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof Bu?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof Ri&&(r.code===Sn.GuardRejected||r.code===Sn.NoDataFromResolver)?this.restoreHistory(i):r instanceof Uu?this.restoreHistory(i,!0):r instanceof Yn&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=x(x({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=x(x({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ga(e)))(s||e)}})(),e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ku=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(ku||{});function wR(t,e){t.events.pipe(dt(n=>n instanceof Yn||n instanceof Ri||n instanceof Uu||n instanceof Ni),O(n=>n instanceof Yn||n instanceof Ni?ku.COMPLETE:(n instanceof Ri?n.code===Sn.Redirect||n.code===Sn.SupersededByNewNavigation:!1)?ku.REDIRECTING:ku.FAILED),dt(n=>n!==ku.REDIRECTING),$n(1)).subscribe(()=>{e()})}function pG(t){throw t}var gG={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},mG={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Mt=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=b(Bf),this.stateManager=b(_R),this.options=b(Zu,{optional:!0})||{},this.pendingTasks=b(Fs),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=b(oE),this.urlSerializer=b(Wu),this.location=b(Ea),this.urlHandlingStrategy=b(sE),this._events=new tt,this.errorHandler=this.options.errorHandler||pG,this.navigated=!1,this.routeReuseStrategy=b(dG),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=b(vp,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!b(wp,{optional:!0}),this.eventsSubscription=new We,this.isNgZoneEnabled=b(de)instanceof de&&de.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof Ri&&i.code!==Sn.Redirect&&i.code!==Sn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Yn)this.navigated=!0;else if(i instanceof $u){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||lG(s.source)};this.scheduleNavigation(a,Fu,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}vG(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Fu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let u=x({},s);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(o.state=u)}let c=this.parseUrl(r);this.scheduleNavigation(c,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(nE),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:c,preserveFragment:u}=i,l=u?this.currentUrlTree.fragment:a,d=null;switch(c){case"merge":d=x(x({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=eR(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return tR(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Sa(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Fu,null,i)}navigate(r,i={skipLocationChange:!1}){return yG(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=x({},gG):i===!1?s=x({},mG):s=i,Sa(r))return FM(this.currentUrlTree,r,s);let o=this.parseUrl(r);return FM(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let c,u,l;a?(c=a.resolve,u=a.reject,l=a.promise):l=new Promise((h,f)=>{c=h,u=f});let d=this.pendingTasks.add();return wR(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:c,reject:u,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function yG(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new B(4008,!1)}function vG(t){return!(t instanceof Bu)&&!(t instanceof $u)}var Ra=(()=>{let e=class e{constructor(r,i,s,o,a,c){this.router=r,this.route=i,this.tabIndexAttribute=s,this.renderer=o,this.el=a,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new tt,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let u=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=u==="a"||u==="area",this.isAnchorElement?this.subscription=r.events.subscribe(l=>{l instanceof Yn&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(r){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",r)}ngOnChanges(r){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(r){r!=null?(this.commands=Array.isArray(r)?r:[r],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(r,i,s,o,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(r!==0||i||s||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let u={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,u),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let r=this.urlTree;this.href=r!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(r)):null;let i=this.href===null?null:KS(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(r,i){let s=this.renderer,o=this.el.nativeElement;i!==null?s.setAttribute(o,r,i):s.removeAttribute(o,r)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(L(Mt),L(Zn),k_("tabindex"),L(Ti),L(An),L(Zr))},e.\u0275dir=it({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&pt("click",function(a){return s.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Iu("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[rt.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Si],skipLocationChange:[rt.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Si],replaceUrl:[rt.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Si],routerLink:"routerLink"},standalone:!0,features:[Q_,Wn]});let t=e;return t})(),Ip=(()=>{let e=class e{get isActive(){return this._isActive}constructor(r,i,s,o,a){this.router=r,this.element=i,this.renderer=s,this.cdr=o,this.link=a,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Ve,this.routerEventsSubscription=r.events.subscribe(c=>{c instanceof Yn&&this.update()})}ngAfterContentInit(){U(this.links.changes,U(null)).pipe(ur()).subscribe(r=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let r=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=fe(r).pipe(ur()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(r){let i=Array.isArray(r)?r:r.split(" ");this.classes=i.filter(s=>!!s)}ngOnChanges(r){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let r=this.hasActiveLinks();this._isActive!==r&&(this._isActive=r,this.cdr.markForCheck(),this.classes.forEach(i=>{r?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),r&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this.isActiveChange.emit(r))})}isLinkActive(r){let i=_G(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return s=>{let o=s.urlTree;return o?r.isActive(o,i):!1}}hasActiveLinks(){let r=this.isLinkActive(this.router);return this.link&&r(this.link)||this.links.some(r)}};e.\u0275fac=function(i){return new(i||e)(L(Mt),L(An),L(Ti),L(Ai),L(Ra,8))},e.\u0275dir=it({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(i,s,o){if(i&1&&Ux(o,Ra,5),i&2){let a;Bx(a=$x())&&(s.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[Wn]});let t=e;return t})();function _G(t){return!!t.paths}var _p=class{};var wG=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(dt(r=>r instanceof Yn),$r(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=jf(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,c=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(c,o.children??o._loadedRoutes))}return fe(s).pipe(ur())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=U(null);let o=s.pipe(nt(a=>a===null?U(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return fe([o,a]).pipe(ur())}else return o})}};e.\u0275fac=function(i){return new(i||e)(E(Mt),E(zf),E(Ht),E(_p),E(iE))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ER=new A(""),EG=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof xa?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Yn?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof Ni&&r.code===lp.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof hp&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new hp(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){ax()},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function IG(t){return t.routerState.root}function Xu(t,e){return{\u0275kind:t,\u0275providers:e}}function CG(){let t=b(Kn);return e=>{let n=t.get(js);if(e!==n.components[0])return;let r=t.get(Mt),i=t.get(IR);t.get(aE)===1&&r.initialNavigation(),t.get(CR,null,ce.Optional)?.setUpPreloading(),t.get(ER,null,ce.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var IR=new A("",{factory:()=>new tt}),aE=new A("",{providedIn:"root",factory:()=>1});function DG(){return Xu(2,[{provide:aE,useValue:0},{provide:Hf,multi:!0,deps:[Kn],useFactory:e=>{let n=e.get(cM,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(Mt),s=e.get(IR);wR(i,()=>{r(!0)}),e.get(oE).afterPreactivation=()=>(r(!0),s.closed?U(void 0):s),i.initialNavigation()}))}}])}function TG(){return Xu(3,[{provide:Hf,multi:!0,useFactory:()=>{let e=b(Mt);return()=>{e.setUpLocationChangeListener()}}},{provide:aE,useValue:2}])}var CR=new A("");function bG(t){return Xu(0,[{provide:CR,useExisting:wG},{provide:_p,useExisting:t}])}function AG(){return Xu(8,[UM,{provide:wp,useExisting:UM}])}function SG(t){let e=[{provide:yR,useValue:cG},{provide:vR,useValue:x({skipNextTransition:!!t?.skipInitialTransition},t)}];return Xu(9,e)}var $M=new A("ROUTER_FORROOT_GUARD"),xG=[Ea,{provide:Wu,useClass:Lu},Mt,Ku,{provide:Zn,useFactory:IG,deps:[Mt]},iE,[]],cE=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[xG,[],{provide:vp,multi:!0,useValue:r},{provide:$M,useFactory:PG,deps:[[Mt,new pa,new x_]]},{provide:Zu,useValue:i||{}},i?.useHash?RG():NG(),MG(),i?.preloadingStrategy?bG(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?kG(i):[],i?.bindToComponentInputs?AG().\u0275providers:[],i?.enableViewTransitions?SG().\u0275providers:[],OG()]}}static forChild(r){return{ngModule:e,providers:[{provide:vp,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(E($M,8))},e.\u0275mod=Le({type:e}),e.\u0275inj=je({});let t=e;return t})();function MG(){return{provide:ER,useFactory:()=>{let t=b(fM),e=b(de),n=b(Zu),r=b(oE),i=b(Wu);return n.scrollOffset&&t.setOffset(n.scrollOffset),new EG(i,r,t,e,n)}}}function RG(){return{provide:Zr,useClass:lM}}function NG(){return{provide:Zr,useClass:cw}}function PG(t){return"guarded"}function kG(t){return[t.initialNavigation==="disabled"?TG().\u0275providers:[],t.initialNavigation==="enabledBlocking"?DG().\u0275providers:[]]}var qM=new A("");function OG(){return[{provide:qM,useFactory:CG},{provide:Gf,multi:!0,useExisting:qM}]}var NR=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(L(Ti),L(An))},e.\u0275dir=it({type:e});let t=e;return t})(),FG=(()=>{let e=class e extends NR{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ga(e)))(s||e)}})(),e.\u0275dir=it({type:e,features:[Qn]});let t=e;return t})(),hE=new A("");var VG={provide:hE,useExisting:Qr(()=>Oi),multi:!0};function LG(){let t=vr()?vr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var jG=new A(""),Oi=(()=>{let e=class e extends NR{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!LG())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(L(Ti),L(An),L(jG,8))},e.\u0275dir=it({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&pt("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Vs([VG]),Qn]});let t=e;return t})();function ki(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function PR(t){return t!=null&&typeof t.length=="number"}var rl=new A(""),Rp=new A(""),UG=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Mn=class{static min(e){return BG(e)}static max(e){return $G(e)}static required(e){return kR(e)}static requiredTrue(e){return qG(e)}static email(e){return HG(e)}static minLength(e){return GG(e)}static maxLength(e){return zG(e)}static pattern(e){return WG(e)}static nullValidator(e){return Dp(e)}static compose(e){return UR(e)}static composeAsync(e){return BR(e)}};function BG(t){return e=>{if(ki(e.value)||ki(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n<t?{min:{min:t,actual:e.value}}:null}}function $G(t){return e=>{if(ki(e.value)||ki(t))return null;let n=parseFloat(e.value);return!isNaN(n)&&n>t?{max:{max:t,actual:e.value}}:null}}function kR(t){return ki(t.value)?{required:!0}:null}function qG(t){return t.value===!0?null:{required:!0}}function HG(t){return ki(t.value)||UG.test(t.value)?null:{email:!0}}function GG(t){return e=>ki(e.value)||!PR(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function zG(t){return e=>PR(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function WG(t){if(!t)return Dp;let e,n;return typeof t=="string"?(n="",t.charAt(0)!=="^"&&(n+="^"),n+=t,t.charAt(t.length-1)!=="$"&&(n+="$"),e=new RegExp(n)):(n=t.toString(),e=t),r=>{if(ki(r.value))return null;let i=r.value;return e.test(i)?null:{pattern:{requiredPattern:n,actualValue:i}}}}function Dp(t){return null}function OR(t){return t!=null}function FR(t){return Ls(t)?fe(t):t}function VR(t){let e={};return t.forEach(n=>{e=n!=null?x(x({},e),n):e}),Object.keys(e).length===0?null:e}function LR(t,e){return e.map(n=>n(t))}function KG(t){return!t.validate}function jR(t){return t.map(e=>KG(e)?e:n=>e.validate(n))}function UR(t){if(!t)return null;let e=t.filter(OR);return e.length==0?null:function(n){return VR(LR(n,e))}}function fE(t){return t!=null?UR(jR(t)):null}function BR(t){if(!t)return null;let e=t.filter(OR);return e.length==0?null:function(n){let r=LR(n,e).map(FR);return Xy(r).pipe(O(VR))}}function pE(t){return t!=null?BR(jR(t)):null}function DR(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function $R(t){return t._rawValidators}function qR(t){return t._rawAsyncValidators}function uE(t){return t?Array.isArray(t)?t:[t]:[]}function Tp(t,e){return Array.isArray(t)?t.includes(e):t===e}function TR(t,e){let n=uE(e);return uE(t).forEach(i=>{Tp(n,i)||n.push(i)}),n}function bR(t,e){return uE(e).filter(n=>!Tp(t,n))}var bp=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=fE(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=pE(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},Xr=class extends bp{get formDirective(){return null}get path(){return null}},zs=class extends bp{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},Ap=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},QG={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},vne=ge(x({},QG),{"[class.ng-submitted]":"isSubmitted"}),Fa=(()=>{let e=class e extends Ap{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(L(zs,2))},e.\u0275dir=it({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Uf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Qn]});let t=e;return t})(),Va=(()=>{let e=class e extends Ap{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(L(Xr,10))},e.\u0275dir=it({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Uf("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Qn]});let t=e;return t})();var Ju="VALID",Cp="INVALID",Pa="PENDING",el="DISABLED";function gE(t){return(Np(t)?t.validators:t)||null}function YG(t){return Array.isArray(t)?fE(t):t||null}function mE(t,e){return(Np(e)?e.asyncValidators:t)||null}function ZG(t){return Array.isArray(t)?pE(t):t||null}function Np(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function HR(t,e,n){let r=t.controls;if(!(e?Object.keys(r):r).length)throw new B(1e3,"");if(!r[n])throw new B(1001,"")}function GR(t,e,n){t._forEachChild((r,i)=>{if(n[i]===void 0)throw new B(1002,"")})}var ka=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Ju}get invalid(){return this.status===Cp}get pending(){return this.status==Pa}get disabled(){return this.status===el}get enabled(){return this.status!==el}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(TR(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(TR(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(bR(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(bR(e,this._rawAsyncValidators))}hasValidator(e){return Tp(this._rawValidators,e)}hasAsyncValidator(e){return Tp(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Pa,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=el,this.errors=null,this._forEachChild(r=>{r.disable(ge(x({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ge(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Ju,this._forEachChild(r=>{r.enable(ge(x({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ge(x({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Ju||this.status===Pa)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?el:Ju}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Pa,this._hasOwnPendingAsyncValidator=!0;let n=FR(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Ve,this.statusChanges=new Ve}_calculateStatus(){return this._allControlsDisabled()?el:this.errors?Cp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Pa)?Pa:this._anyControlsHaveStatus(Cp)?Cp:Ju}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Np(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=YG(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=ZG(this._rawAsyncValidators)}},Oa=class extends ka{constructor(e,n,r){super(gE(n),mE(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,n){return this.controls[e]?this.controls[e]:(this.controls[e]=n,n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange),n)}addControl(e,n,r={}){this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}setControl(e,n,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],n&&this.registerControl(e,n),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,n={}){GR(this,!0,e),Object.keys(e).forEach(r=>{HR(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(Object.keys(e).forEach(r=>{let i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e={},n={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this._reduceChildren({},(e,n,r)=>(e[r]=n.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(n,r)=>r._syncPendingControls()?!0:n);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(n=>{let r=this.controls[n];r&&e(r,n)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[n,r]of Object.entries(this.controls))if(this.contains(n)&&e(r))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(n,r,i)=>((r.enabled||this.disabled)&&(n[i]=r.value),n))}_reduceChildren(e,n){let r=e;return this._forEachChild((i,s)=>{r=n(r,i,s)}),r}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var lE=class extends Oa{};var il=new A("CallSetDisabledState",{providedIn:"root",factory:()=>Pp}),Pp="always";function zR(t,e){return[...e.path,t]}function Sp(t,e,n=Pp){yE(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),JG(t,e),tz(t,e),ez(t,e),XG(t,e)}function AR(t,e,n=!0){let r=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(r),e.valueAccessor.registerOnTouched(r)),Mp(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function xp(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function XG(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function yE(t,e){let n=$R(t);e.validator!==null?t.setValidators(DR(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=qR(t);e.asyncValidator!==null?t.setAsyncValidators(DR(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();xp(e._rawValidators,i),xp(e._rawAsyncValidators,i)}function Mp(t,e){let n=!1;if(t!==null){if(e.validator!==null){let i=$R(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.validator);s.length!==i.length&&(n=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let i=qR(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(o=>o!==e.asyncValidator);s.length!==i.length&&(n=!0,t.setAsyncValidators(s))}}}let r=()=>{};return xp(e._rawValidators,r),xp(e._rawAsyncValidators,r),n}function JG(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&WR(t,e)})}function ez(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&WR(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function WR(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function tz(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function KR(t,e){t==null,yE(t,e)}function nz(t,e){return Mp(t,e)}function QR(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function rz(t){return Object.getPrototypeOf(t.constructor)===FG}function YR(t,e){t._syncPendingControls(),e.forEach(n=>{let r=n.control;r.updateOn==="submit"&&r._pendingChange&&(n.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function ZR(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===Oi?n=s:rz(s)?r=s:i=s}),i||r||n||null}function iz(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}var sz={provide:Xr,useExisting:Qr(()=>vE)},tl=Promise.resolve(),vE=(()=>{let e=class e extends Xr{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Ve,this.form=new Oa({},fE(r),pE(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(r){tl.then(()=>{let i=this._findContainer(r.path);r.control=i.registerControl(r.name,r.control),Sp(r.control,r,this.callSetDisabledState),r.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(r)})}getControl(r){return this.form.get(r.path)}removeControl(r){tl.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name),this._directives.delete(r)})}addFormGroup(r){tl.then(()=>{let i=this._findContainer(r.path),s=new Oa({});KR(s,r),i.registerControl(r.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(r){tl.then(()=>{let i=this._findContainer(r.path);i&&i.removeControl(r.name)})}getFormGroup(r){return this.form.get(r.path)}updateModel(r,i){tl.then(()=>{this.form.get(r.path).setValue(i)})}setValue(r){this.control.setValue(r)}onSubmit(r){return this.submitted=!0,YR(this.form,this._directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(r){return r.pop(),r.length?this.form.get(r):this.form}};e.\u0275fac=function(i){return new(i||e)(L(rl,10),L(Rp,10),L(il,8))},e.\u0275dir=it({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&pt("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{options:[rt.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Vs([sz]),Qn]});let t=e;return t})();function SR(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function xR(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var nl=class extends ka{constructor(e=null,n,r){super(gE(n),mE(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Np(n)&&(n.nonNullable||n.initialValueIsDefault)&&(xR(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){SR(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){SR(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){xR(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var oz=t=>t instanceof nl;var az={provide:zs,useExisting:Qr(()=>_E)},MR=Promise.resolve(),_E=(()=>{let e=class e extends zs{constructor(r,i,s,o,a,c){super(),this._changeDetectorRef=a,this.callSetDisabledState=c,this.control=new nl,this._registered=!1,this.name="",this.update=new Ve,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=ZR(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),QR(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Sp(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){MR.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&Si(i);MR.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?zR(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(L(Xr,9),L(rl,10),L(Rp,10),L(hE,10),L(Ai,8),L(il,8))},e.\u0275dir=it({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[rt.None,"disabled","isDisabled"],model:[rt.None,"ngModel","model"],options:[rt.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Vs([az]),Qn,Wn]});let t=e;return t})(),La=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=it({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})();var XR=new A("");var cz={provide:Xr,useExisting:Qr(()=>sl)},sl=(()=>{let e=class e extends Xr{constructor(r,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Ve,this._setValidators(r),this._setAsyncValidators(i)}ngOnChanges(r){this._checkFormPresent(),r.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Mp(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(r){let i=this.form.get(r.path);return Sp(i,r,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(r),i}getControl(r){return this.form.get(r.path)}removeControl(r){AR(r.control||null,r,!1),iz(this.directives,r)}addFormGroup(r){this._setUpFormContainer(r)}removeFormGroup(r){this._cleanUpFormContainer(r)}getFormGroup(r){return this.form.get(r.path)}addFormArray(r){this._setUpFormContainer(r)}removeFormArray(r){this._cleanUpFormContainer(r)}getFormArray(r){return this.form.get(r.path)}updateModel(r,i){this.form.get(r.path).setValue(i)}onSubmit(r){return this.submitted=!0,YR(this.form,this.directives),this.ngSubmit.emit(r),r?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(r=void 0){this.form.reset(r),this.submitted=!1}_updateDomValue(){this.directives.forEach(r=>{let i=r.control,s=this.form.get(r.path);i!==s&&(AR(i||null,r),oz(s)&&(Sp(s,r,this.callSetDisabledState),r.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(r){let i=this.form.get(r.path);KR(i,r),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(r){if(this.form){let i=this.form.get(r.path);i&&nz(i,r)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){yE(this.form,this),this._oldForm&&Mp(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(L(rl,10),L(Rp,10),L(il,8))},e.\u0275dir=it({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&pt("submit",function(a){return s.onSubmit(a)})("reset",function(){return s.onReset()})},inputs:{form:[rt.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Vs([cz]),Qn,Wn]});let t=e;return t})();var uz={provide:zs,useExisting:Qr(()=>ol)},ol=(()=>{let e=class e extends zs{set isDisabled(r){}constructor(r,i,s,o,a){super(),this._ngModelWarningConfig=a,this._added=!1,this.name=null,this.update=new Ve,this._ngModelWarningSent=!1,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=ZR(this,o)}ngOnChanges(r){this._added||this._setUpControl(),QR(r,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}get path(){return zR(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(L(Xr,13),L(rl,10),L(Rp,10),L(hE,10),L(XR,8))},e.\u0275dir=it({type:e,selectors:[["","formControlName",""]],inputs:{name:[rt.None,"formControlName","name"],isDisabled:[rt.None,"disabled","isDisabled"],model:[rt.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Vs([uz]),Qn,Wn]});let t=e;return t})();var lz=(()=>{let e=class e{constructor(){this._validator=Dp}ngOnChanges(r){if(this.inputName in r){let i=this.normalizeInput(r[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Dp,this._onChange&&this._onChange()}}validate(r){return this._validator(r)}registerOnValidatorChange(r){this._onChange=r}enabled(r){return r!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=it({type:e,features:[Wn]});let t=e;return t})();var dz={provide:rl,useExisting:Qr(()=>al),multi:!0};var al=(()=>{let e=class e extends lz{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Si,this.createValidator=r=>kR}enabled(r){return r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=ga(e)))(s||e)}})(),e.\u0275dir=it({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&Iu("required",s._enabled?"":null)},inputs:{required:"required"},features:[Vs([dz]),Qn]});let t=e;return t})();var JR=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Le({type:e}),e.\u0275inj=je({});let t=e;return t})(),dE=class extends ka{constructor(e,n,r){super(gE(n),mE(r,n)),this.controls=e,this._initObservables(),this._setUpdateStrategy(n),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,n={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}insert(e,n,r={}){this.controls.splice(e,0,n),this._registerControl(n),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(e,n={}){let r=this._adjustIndex(e);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:n.emitEvent})}setControl(e,n,r={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),n&&(this.controls.splice(i,0,n),this._registerControl(n)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,n={}){GR(this,!1,e),e.forEach((r,i)=>{HR(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}patchValue(e,n={}){e!=null&&(e.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}reset(e=[],n={}){this._forEachChild((r,i)=>{r.reset(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this._updatePristine(n),this._updateTouched(n),this.updateValueAndValidity(n)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(n=>n._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((n,r)=>r._syncPendingControls()?!0:n,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((n,r)=>{e(n,r)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(n=>n.enabled&&e(n))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function RR(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var kp=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let r=new e;return r.useNonNullable=!0,r}group(r,i=null){let s=this._reduceControls(r),o={};return RR(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new Oa(s,o)}record(r,i=null){let s=this._reduceControls(r);return new lE(s,i)}control(r,i,s){let o={};return this.useNonNullable?(RR(i)?o=i:(o.validators=i,o.asyncValidators=s),new nl(r,ge(x({},o),{nonNullable:!0}))):new nl(r,i,s)}array(r,i,s){let o=r.map(a=>this._createControl(a));return new dE(o,i,s)}_reduceControls(r){let i={};return Object.keys(r).forEach(s=>{i[s]=this._createControl(r[s])}),i}_createControl(r){if(r instanceof nl)return r;if(r instanceof ka)return r;if(Array.isArray(r)){let i=r[0],s=r.length>1?r[1]:null,o=r.length>2?r[2]:null;return this.control(i,s,o)}else return this.control(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var eN=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:il,useValue:r.callSetDisabledState??Pp}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Le({type:e}),e.\u0275inj=je({imports:[JR]});let t=e;return t})(),tN=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:XR,useValue:r.warnOnNgModelWithFormControl??"always"},{provide:il,useValue:r.callSetDisabledState??Pp}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Le({type:e}),e.\u0275inj=je({imports:[JR]});let t=e;return t})();var hz="firebase",fz="10.8.1";jn(hz,fz,"app");var Fi=new zr("ANGULARFIRE2_VERSION");var pz=(t,e)=>{let n=e?[e]:Tb(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Jr=class{constructor(){return pz(gz)}},gz="app-check";function EE(){}var Op=class{zone;delegate;constructor(e,n=Qy){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},IE=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",EE,{},EE,EE)),n.pipe(Ke({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ja=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new Op(Zone.current)),this.insideAngular=n.run(()=>new Op(Zone.current,Cs)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(E(de))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function mz(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function Ye(t){return yz(mz())(t)}function yz(t){return function(n){return n=n.lift(new IE(t.ngZone)),n.pipe(Bn(t.outsideAngular),wn(t.insideAngular))}}var vz=new Map,_z={activated:!1,tokenObservers:[]},wz={initialized:!1,enabled:!1};function Xn(t){return vz.get(t)||Object.assign({},_z)}function cN(){return wz}var Ez="https://content-firebaseappcheck.googleapis.com/v1";var Iz="exchangeDebugToken",nN={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},Vne=24*60*60*1e3;var TE=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return _(this,null,function*(){this.stop();try{this.pending=new yt,this.pending.promise.catch(n=>{}),yield Cz(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new yt,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function Cz(t){return new Promise(e=>{setTimeout(e,t)})}var Dz={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Vi=new _b("appCheck","AppCheck",Dz);function uN(t){if(!Xn(t).activated)throw Vi.create("use-before-activation",{appName:t.name})}function lN(r,i){return _(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},c;try{c=yield fetch(t,a)}catch(f){throw Vi.create("fetch-network-error",{originalErrorMessage:f?.message})}if(c.status!==200)throw Vi.create("fetch-status-error",{httpStatus:c.status});let u;try{u=yield c.json()}catch(f){throw Vi.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=u.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw Vi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${u.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:u.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function dN(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${Ez}/projects/${n}/apps/${r}:${Iz}?key=${i}`,body:{debug_token:e}}}var Tz="firebase-app-check-database",bz=1,bE="firebase-app-check-store";var Fp=null;function Az(){return Fp||(Fp=new Promise((t,e)=>{try{let n=indexedDB.open(Tz,bz);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(Vi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(bE,{keyPath:"compositeKey"})}}}catch(n){e(Vi.create("storage-open",{originalErrorMessage:n?.message}))}}),Fp)}function Sz(t,e){return xz(Mz(t),e)}function xz(t,e){return _(this,null,function*(){let r=(yield Az()).transaction(bE,"readwrite"),s=r.objectStore(bE).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=c=>{o()},r.onerror=c=>{var u;a(Vi.create("storage-set",{originalErrorMessage:(u=c.target.error)===null||u===void 0?void 0:u.message}))}})})}function Mz(t){return`${t.options.appId}-${t.name}`}var AE=new pi("@firebase/app-check");function DE(t,e){return dh()?Sz(t,e).catch(n=>{AE.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function hN(){return cN().enabled}function fN(){return _(this,null,function*(){let t=cN();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var Rz={error:"UNKNOWN_ERROR"};function Nz(t){return uh.encodeString(JSON.stringify(t),!1)}function SE(t,e=!1){return _(this,null,function*(){let n=t.app;uN(n);let r=Xn(n),i=r.token,s;if(i&&!cl(i)&&(r.token=void 0,i=void 0),!i){let c=yield r.cachedTokenPromise;c&&(cl(c)?i=c:yield DE(n,void 0))}if(!e&&i&&cl(i))return{token:i.token};let o=!1;if(hN()){r.exchangeTokenPromise||(r.exchangeTokenPromise=lN(dN(n,yield fN()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let c=yield r.exchangeTokenPromise;return yield DE(n,c),r.token=c,{token:c.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield Xn(n).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?AE.warn(c.message):AE.error(c),s=c}let a;return i?s?cl(i)?a={token:i.token,internalError:s}:a=iN(s):(a={token:i.token},r.token=i,yield DE(n,i)):a=iN(s),o&&Fz(n,a),a})}function Pz(t){return _(this,null,function*(){let e=t.app;uN(e);let{provider:n}=Xn(e);if(hN()){let r=yield fN(),{token:i}=yield lN(dN(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function kz(t,e,n,r){let{app:i}=t,s=Xn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&cl(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),rN(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>rN(t))}function pN(t,e){let n=Xn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function rN(t){let{app:e}=t,n=Xn(e),r=n.tokenRefresher;r||(r=Oz(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function Oz(t){let{app:e}=t;return new TE(()=>_(this,null,function*(){let n=Xn(e),r;if(n.token?r=yield SE(t,!0):r=yield SE(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=Xn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},nN.RETRIAL_MIN_WAIT,nN.RETRIAL_MAX_WAIT)}function Fz(t,e){let n=Xn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function cl(t){return t.expireTimeMillis-Date.now()>0}function iN(t){return{token:Nz(Rz),error:t}}var xE=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=Xn(this.app);for(let n of e)pN(this.app,n.next);return Promise.resolve()}};function Vz(t,e){return new xE(t,e)}function Lz(t){return{getToken:e=>SE(t,e),getLimitedUseToken:()=>Pz(t),addTokenListener:e=>kz(t,"INTERNAL",e),removeTokenListener:e=>pN(t.app,e)}}var jz="@firebase/app-check",Uz="0.8.2";var Bz="app-check",sN="app-check-internal";function $z(){vs(new an(Bz,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return Vz(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(sN).initialize()})),vs(new an(sN,t=>{let e=t.getProvider("app-check").getImmediate();return Lz(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),jn(jz,Uz)}$z();var qz=["localhost","0.0.0.0","127.0.0.1"],Qne=typeof window<"u"&&qz.includes(window.location.hostname);var Hz="firebase",Gz="10.8.1";vt.registerVersion(Hz,Gz,"app-compat");var zz=["ngOnDestroy"],mN=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(zz.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(u=>n.run(()=>u)):n.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,u)=>o.then(l=>{let d=l?.(...u);return r?.spy?.apply&&r.spy.apply(s,u,d),d})})})});var Vp=class{constructor(e){return e}},Li=new A("angularfire2.app.options"),ji=new A("angularfire2.app.name");function Ws(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=vt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>vt.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;Wz("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Vp(o)}var Wz=(t,...e)=>{ew()&&typeof console<"u"&&console[t](...e)},Kz={provide:Vp,useFactory:Ws,deps:[Li,de,[new pa,ji]]},yN=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:Li,useValue:n},{provide:ji,useValue:r}]}}constructor(n){vt.registerVersion("angularfire",Fi.full,"core"),vt.registerVersion("angularfire",Fi.full,"app-compat"),vt.registerVersion("angular",Gx.full,n.toString())}static \u0275fac=function(r){return new(r||t)(E(_t))};static \u0275mod=Le({type:t});static \u0275inj=je({providers:[Kz]})}return t})();function Ua(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return Qz(i,o)||(gN("error",`${e} was already initialized on the ${n} Firebase App with different settings.${Yz?" You may need to reload as Firebase is not HMR aware.":""}`),gN("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function Qz(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var Yz=typeof module<"u"&&!!module.hot,gN=(t,...e)=>{ew()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var ul=new A("angularfire2.auth.use-emulator"),ll=new A("angularfire2.auth.settings"),dl=new A("angularfire2.auth.tenant-id"),hl=new A("angularfire2.auth.langugage-code"),fl=new A("angularfire2.auth.use-device-language"),pl=new A("angularfire.auth.persistence"),gl=(t,e,n,r,i,s,o,a)=>Ua(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let c=e.runOutsideAngular(()=>t.auth());if(n&&c.useEmulator(...n),r&&(c.tenantId=r),c.languageCode=i,s&&c.useDeviceLanguage(),o)for(let[u,l]of Object.entries(o))c.settings[u]=l;return a&&c.setPersistence(a),c},[n,r,i,s,o,a]),Ks=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,c,u,l,d,h,f){let p=new tt,g=U(void 0).pipe(wn(o.outsideAngular),Re(()=>s.runOutsideAngular(()=>import("./chunk-IIGAWYEE.js"))),O(()=>Ws(n,s,r)),O(m=>gl(m,s,a,u,l,d,c,h)),Bh({bufferSize:1,refCount:!1}));if(Us(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=U(null);else{g.pipe(En()).subscribe();let m=g.pipe(Re(T=>T.getRedirectResult().then(V=>V,()=>null)),Ye,Bh({bufferSize:1,refCount:!1})),w=g.pipe(Re(T=>new ne(V=>({unsubscribe:s.runOutsideAngular(()=>T.onAuthStateChanged(G=>V.next(G),G=>V.error(G),()=>V.complete()))})))),P=g.pipe(Re(T=>new ne(V=>({unsubscribe:s.runOutsideAngular(()=>T.onIdTokenChanged(G=>V.next(G),G=>V.error(G),()=>V.complete()))}))));this.authState=m.pipe($h(w),Bn(o.outsideAngular),wn(o.insideAngular)),this.user=m.pipe($h(P),Bn(o.outsideAngular),wn(o.insideAngular)),this.idToken=this.user.pipe(Re(T=>T?fe(T.getIdToken()):U(null))),this.idTokenResult=this.user.pipe(Re(T=>T?fe(T.getIdTokenResult()):U(null))),this.credential=Qo(m,p,this.authState.pipe(dt(T=>!T))).pipe(O(T=>T?.user?T:null),Bn(o.outsideAngular),wn(o.insideAngular))}return mN(this,g,s,{spy:{apply:(m,w,P)=>{(m.startsWith("signIn")||m.startsWith("createUser"))&&P.then(T=>p.next(T))}}})}static \u0275fac=function(r){return new(r||t)(E(Li),E(ji,8),E(_t),E(de),E(ja),E(ul,8),E(ll,8),E(dl,8),E(hl,8),E(fl,8),E(pl,8),E(Jr,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),vN=(()=>{class t{constructor(){vt.registerVersion("angularfire",Fi.full,"auth-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Le({type:t});static \u0275inj=je({providers:[Ks]})}return t})();var Zz=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},er={},M,JE=JE||{},Z=Zz||self;function Zp(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function xl(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Xz(t){return Object.prototype.hasOwnProperty.call(t,NE)&&t[NE]||(t[NE]=++Jz)}var NE="closure_uid_"+(1e9*Math.random()>>>0),Jz=0;function e3(t,e,n){return t.call.apply(t.bind,arguments)}function t3(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Ft(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ft=e3:Ft=t3,Ft.apply(null,arguments)}function Lp(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function It(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function Ui(){this.s=this.s,this.o=this.o}var n3=0;Ui.prototype.s=!1;Ui.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),n3!=0)&&Xz(this)};Ui.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var RN=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function eI(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function _N(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Zp(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Vt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Vt.prototype.h=function(){this.defaultPrevented=!0};var r3=function(){if(!Z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};Z.addEventListener("test",n,e),Z.removeEventListener("test",n,e)}catch{}return t}();function El(t){return/^[\s\xa0]*$/.test(t)}function Xp(){var t=Z.navigator;return t&&(t=t.userAgent)?t:""}function Ir(t){return Xp().indexOf(t)!=-1}function tI(t){return tI[" "](t),t}tI[" "]=function(){};function i3(t,e){var n=z3;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var s3=Ir("Opera"),Ha=Ir("Trident")||Ir("MSIE"),NN=Ir("Edge"),VE=NN||Ha,PN=Ir("Gecko")&&!(Xp().toLowerCase().indexOf("webkit")!=-1&&!Ir("Edge"))&&!(Ir("Trident")||Ir("MSIE"))&&!Ir("Edge"),o3=Xp().toLowerCase().indexOf("webkit")!=-1&&!Ir("Edge");function kN(){var t=Z.document;return t?t.documentMode:void 0}var LE;e:{if(jp="",Up=function(){var t=Xp();if(PN)return/rv:([^\);]+)(\)|;)/.exec(t);if(NN)return/Edge\/([\d\.]+)/.exec(t);if(Ha)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(o3)return/WebKit\/(\S+)/.exec(t);if(s3)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),Up&&(jp=Up?Up[1]:""),Ha&&(Bp=kN(),Bp!=null&&Bp>parseFloat(jp))){LE=String(Bp);break e}LE=jp}var jp,Up,Bp,jE;Z.document&&Ha?(PE=kN(),jE=PE||parseInt(LE,10)||void 0):jE=void 0;var PE,a3=jE;function Il(t,e){if(Vt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(PN){e:{try{tI(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:c3[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Il.$.h.call(this)}}It(Il,Vt);var c3={2:"touch",3:"pen",4:"mouse"};Il.prototype.h=function(){Il.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Ml="closure_listenable_"+(1e6*Math.random()|0),u3=0;function l3(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++u3,this.fa=this.ia=!1}function Jp(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function nI(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function d3(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function ON(t){let e={};for(let n in t)e[n]=t[n];return e}var wN="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function FN(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<wN.length;s++)n=wN[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function eg(t){this.src=t,this.g={},this.h=0}eg.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=BE(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new l3(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function UE(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=RN(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Jp(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function BE(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var rI="closure_lm_"+(1e6*Math.random()|0),kE={};function VN(t,e,n,r,i){if(r&&r.once)return jN(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)VN(t,e[s],n,r,i);return null}return n=oI(n),t&&t[Ml]?t.O(e,n,xl(r)?!!r.capture:!!r,i):LN(t,e,n,!1,r,i)}function LN(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=xl(i)?!!i.capture:!!i,a=sI(t);if(a||(t[rI]=a=new eg(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=h3(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)r3||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(BN(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function h3(){function t(n){return e.call(t.src,t.listener,n)}let e=f3;return t}function jN(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)jN(t,e[s],n,r,i);return null}return n=oI(n),t&&t[Ml]?t.P(e,n,xl(r)?!!r.capture:!!r,i):LN(t,e,n,!0,r,i)}function UN(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)UN(t,e[s],n,r,i);else r=xl(r)?!!r.capture:!!r,n=oI(n),t&&t[Ml]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=BE(s,n,r,i),-1<n&&(Jp(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=sI(t))&&(e=t.g[e.toString()],t=-1,e&&(t=BE(e,n,r,i)),(n=-1<t?e[t]:null)&&iI(n))}function iI(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[Ml])UE(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(BN(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=sI(e))?(UE(n,t),n.h==0&&(n.src=null,e[rI]=null)):Jp(t)}}}function BN(t){return t in kE?kE[t]:kE[t]="on"+t}function f3(t,e){if(t.fa)t=!0;else{e=new Il(e,this);var n=t.listener,r=t.la||t.src;t.ia&&iI(t),t=n.call(r,e)}return t}function sI(t){return t=t[rI],t instanceof eg?t:null}var OE="__closure_events_fn_"+(1e9*Math.random()>>>0);function oI(t){return typeof t=="function"?t:(t[OE]||(t[OE]=function(e){return t.handleEvent(e)}),t[OE])}function Et(){Ui.call(this),this.i=new eg(this),this.S=this,this.J=null}It(Et,Ui);Et.prototype[Ml]=!0;Et.prototype.removeEventListener=function(t,e,n,r){UN(this,t,e,n,r)};function Nt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Vt(e,t);else if(e instanceof Vt)e.target=e.target||t;else{var i=e;e=new Vt(r,t),FN(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=$p(o,r,!0,e)&&i}if(o=e.g=t,i=$p(o,r,!0,e)&&i,i=$p(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=$p(o,r,!1,e)&&i}Et.prototype.N=function(){if(Et.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Jp(n[r]);delete t.g[e],t.h--}}this.J=null};Et.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};Et.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function $p(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,c=o.la||o.src;o.ia&&UE(t.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var aI=Z.JSON.stringify,$E=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function p3(){var t=cI;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var qE=class{constructor(){this.h=this.g=null}add(e,n){let r=$N.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},$N=new $E(()=>new HE,t=>t.reset()),HE=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function g3(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function m3(t){Z.setTimeout(()=>{throw t},0)}var Cl,Dl=!1,cI=new qE,qN=()=>{let t=Z.Promise.resolve(void 0);Cl=()=>{t.then(y3)}},y3=()=>{for(var t;t=p3();){try{t.h.call(t.g)}catch(n){m3(n)}var e=$N;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Dl=!1};function tg(t,e){Et.call(this),this.h=t||1,this.g=e||Z,this.j=Ft(this.qb,this),this.l=Date.now()}It(tg,Et);M=tg.prototype;M.ga=!1;M.T=null;M.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),Nt(this,"tick"),this.ga&&(uI(this),this.start()))}};M.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function uI(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}M.N=function(){tg.$.N.call(this),uI(this),delete this.g};function lI(t,e,n){if(typeof t=="function")n&&(t=Ft(t,n));else if(t&&typeof t.handleEvent=="function")t=Ft(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:Z.setTimeout(t,e||0)}function HN(t){t.g=lI(()=>{t.g=null,t.i&&(t.i=!1,HN(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var GE=class extends Ui{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:HN(this)}N(){super.N(),this.g&&(Z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Tl(t){Ui.call(this),this.h=t,this.g={}}It(Tl,Ui);var EN=[];function GN(t,e,n,r){Array.isArray(n)||(n&&(EN[0]=n.toString()),n=EN);for(var i=0;i<n.length;i++){var s=VN(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function zN(t){nI(t.g,function(e,n){this.g.hasOwnProperty(n)&&iI(e)},t),t.g={}}Tl.prototype.N=function(){Tl.$.N.call(this),zN(this)};Tl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ng(){this.g=!0}ng.prototype.Ea=function(){this.g=!1};function v3(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function _3(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function $a(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+E3(t,n)+(r?" "+r:"")})}function w3(t,e){t.info(function(){return"TIMEOUT: "+e})}ng.prototype.info=function(){};function E3(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return aI(n)}catch{return e}}var Xs={},IN=null;function rg(){return IN=IN||new Et}Xs.Ta="serverreachability";function WN(t){Vt.call(this,Xs.Ta,t)}It(WN,Vt);function bl(t){let e=rg();Nt(e,new WN(e))}Xs.STAT_EVENT="statevent";function KN(t,e){Vt.call(this,Xs.STAT_EVENT,t),this.stat=e}It(KN,Vt);function Wt(t){let e=rg();Nt(e,new KN(e,t))}Xs.Ua="timingevent";function QN(t,e){Vt.call(this,Xs.Ua,t),this.size=e}It(QN,Vt);function Rl(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return Z.setTimeout(function(){t()},e)}var ig={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},YN={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function dI(){}dI.prototype.h=null;function CN(t){return t.h||(t.h=t.i())}function ZN(){}var Nl={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function hI(){Vt.call(this,"d")}It(hI,Vt);function fI(){Vt.call(this,"c")}It(fI,Vt);var zE;function sg(){}It(sg,dI);sg.prototype.g=function(){return new XMLHttpRequest};sg.prototype.i=function(){return{}};zE=new sg;function Pl(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new Tl(this),this.P=I3,t=VE?125:void 0,this.V=new tg(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new XN}function XN(){this.i=null,this.g="",this.h=!1}var I3=45e3,JN={},WE={};M=Pl.prototype;M.setTimeout=function(t){this.P=t};function KE(t,e,n){t.L=1,t.A=ag(ti(e)),t.u=n,t.S=!0,eP(t,null)}function eP(t,e){t.G=Date.now(),kl(t),t.B=ti(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),cP(n.i,"t",r),t.o=0,n=t.l.J,t.h=new XN,t.g=xP(t.l,n?e:null,!t.u),0<t.O&&(t.M=new GE(Ft(t.Pa,t,t.g),t.O)),GN(t.U,t.g,"readystatechange",t.nb),e=t.I?ON(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),bl(),v3(t.j,t.v,t.B,t.m,t.W,t.u)}M.nb=function(t){t=t.target;let e=this.M;e&&Cr(t)==3?e.l():this.Pa(t)};M.Pa=function(t){try{if(t==this.g)e:{let l=Cr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||VE||this.g&&(this.h.h||this.g.ja()||AN(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?bl(3):bl(2)),og(this);var n=this.g.da();this.ca=n;t:if(tP(this)){var r=AN(this.g);t="";var i=r.length,s=Cr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qs(this),wl(this);var o="";break t}this.h.i=new Z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,_3(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!El(a)){var u=a;break t}}u=null}if(n=u)$a(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,QE(this,n);else{this.i=!1,this.s=3,Wt(12),Qs(this),wl(this);break e}}this.S?(nP(this,l,o),VE&&this.i&&l==3&&(GN(this.U,this.V,"tick",this.mb),this.V.start())):($a(this.j,this.m,o,null),QE(this,o)),l==4&&Qs(this),this.i&&!this.J&&(l==4?TP(this.l,this):(this.i=!1,kl(this)))}else q3(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Wt(12)):(this.s=0,Wt(13)),Qs(this),wl(this)}}}catch{}finally{}};function tP(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function nP(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=C3(t,n),i==WE){e==4&&(t.s=4,Wt(14),r=!1),$a(t.j,t.m,null,"[Incomplete Response]");break}else if(i==JN){t.s=4,Wt(15),$a(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else $a(t.j,t.m,i,null),QE(t,i);tP(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Wt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),_I(e),e.M=!0,Wt(11))):($a(t.j,t.m,n,"[Invalid Chunked Response]"),Qs(t),wl(t))}M.mb=function(){if(this.g){var t=Cr(this.g),e=this.g.ja();this.o<e.length&&(og(this),nP(this,t,e),this.i&&t!=4&&kl(this))}};function C3(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?WE:(n=Number(e.substring(n,r)),isNaN(n)?JN:(r+=1,r+n>e.length?WE:(e=e.slice(r,r+n),t.o=r+n,e)))}M.cancel=function(){this.J=!0,Qs(this)};function kl(t){t.Y=Date.now()+t.P,rP(t,t.P)}function rP(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Rl(Ft(t.lb,t),e)}function og(t){t.C&&(Z.clearTimeout(t.C),t.C=null)}M.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(w3(this.j,this.B),this.L!=2&&(bl(),Wt(17)),Qs(this),this.s=2,wl(this)):rP(this,this.Y-t)};function wl(t){t.l.H==0||t.J||TP(t.l,t)}function Qs(t){og(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,uI(t.V),zN(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function QE(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||YE(n.i,t))){if(!t.K&&YE(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)Wp(n),lg(n);else break e;vI(n),Wt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Rl(Ft(n.ib,n),6e3));if(1>=dP(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Ys(n,11)}else if((t.K||n.g==t)&&Wp(n),!El(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(n.V=u[0],u=u[1],n.H==2)if(u[0]=="c"){n.K=u[1],n.pa=u[2];let l=u[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=u[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=u[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(pI(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Oe(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=SP(r,r.J?r.pa:null,r.Y),o.K){hP(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.C&&(og(a),kl(a)),r.g=o}else CP(r);0<n.j.length&&dg(n)}else u[0]!="stop"&&u[0]!="close"||Ys(n,7);else n.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?Ys(n,7):yI(n):u[0]!="noop"&&n.h&&n.h.Aa(u),n.A=0)}}bl(4)}catch{}}function D3(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Zp(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function T3(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Zp(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function iP(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Zp(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=T3(t),r=D3(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var sP=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function b3(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Zs(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Zs){this.h=t.h,Gp(this,t.j),this.s=t.s,this.g=t.g,zp(this,t.m),this.l=t.l;var e=t.i,n=new Al;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),DN(this,n),this.o=t.o}else t&&(e=String(t).match(sP))?(this.h=!1,Gp(this,e[1]||"",!0),this.s=vl(e[2]||""),this.g=vl(e[3]||"",!0),zp(this,e[4]),this.l=vl(e[5]||"",!0),DN(this,e[6]||"",!0),this.o=vl(e[7]||"")):(this.h=!1,this.i=new Al(null,this.h))}Zs.prototype.toString=function(){var t=[],e=this.j;e&&t.push(_l(e,TN,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(_l(e,TN,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(_l(n,n.charAt(0)=="/"?x3:S3,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",_l(n,R3)),t.join("")};function ti(t){return new Zs(t)}function Gp(t,e,n){t.j=n?vl(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function zp(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function DN(t,e,n){e instanceof Al?(t.i=e,N3(t.i,t.h)):(n||(e=_l(e,M3)),t.i=new Al(e,t.h))}function Oe(t,e,n){t.i.set(e,n)}function ag(t){return Oe(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function vl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function _l(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,A3),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function A3(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var TN=/[#\/\?@]/g,S3=/[#\?:]/g,x3=/[#\?]/g,M3=/[#\?@]/g,R3=/#/g;function Al(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Bi(t){t.g||(t.g=new Map,t.h=0,t.i&&b3(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}M=Al.prototype;M.add=function(t,e){Bi(this),this.i=null,t=Ga(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function oP(t,e){Bi(t),e=Ga(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function aP(t,e){return Bi(t),e=Ga(t,e),t.g.has(e)}M.forEach=function(t,e){Bi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};M.ta=function(){Bi(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};M.Z=function(t){Bi(this);let e=[];if(typeof t=="string")aP(this,t)&&(e=e.concat(this.g.get(Ga(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};M.set=function(t,e){return Bi(this),this.i=null,t=Ga(this,t),aP(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};M.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function cP(t,e,n){oP(t,e),0<n.length&&(t.i=null,t.g.set(Ga(t,e),eI(n)),t.h+=n.length)}M.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function Ga(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function N3(t,e){e&&!t.j&&(Bi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(oP(this,r),cP(this,i,n))},t)),t.j=e}var P3=class{constructor(t,e){this.g=t,this.map=e}};function uP(t){this.l=t||k3,Z.PerformanceNavigationTiming?(t=Z.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(Z.g&&Z.g.Ka&&Z.g.Ka()&&Z.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var k3=10;function lP(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function dP(t){return t.h?1:t.g?t.g.size:0}function YE(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function pI(t,e){t.g?t.g.add(e):t.h=e}function hP(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}uP.prototype.cancel=function(){if(this.i=fP(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function fP(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return eI(t.i)}var O3=class{stringify(t){return Z.JSON.stringify(t,void 0)}parse(t){return Z.JSON.parse(t,void 0)}};function F3(){this.g=new O3}function V3(t,e,n){let r=n||"";try{iP(t,function(i,s){let o=i;xl(i)&&(o=aI(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function L3(t,e){let n=new ng;if(Z.Image){let r=new Image;r.onload=Lp(qp,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Lp(qp,n,r,"TestLoadImage: error",!1,e),r.onabort=Lp(qp,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Lp(qp,n,r,"TestLoadImage: timeout",!1,e),Z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function qp(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function Ol(t){this.l=t.ec||null,this.j=t.ob||!1}It(Ol,dI);Ol.prototype.g=function(){return new cg(this.l,this.j)};Ol.prototype.i=function(t){return function(){return t}}({});function cg(t,e){Et.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=gI,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}It(cg,Et);var gI=0;M=cg.prototype;M.open=function(t,e){if(this.readyState!=gI)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Sl(this)};M.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||Z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};M.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Fl(this)),this.readyState=gI};M.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Sl(this)),this.g&&(this.readyState=3,Sl(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof Z.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;pP(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function pP(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}M.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Fl(this):Sl(this),this.readyState==3&&pP(this)}};M.Za=function(t){this.g&&(this.response=this.responseText=t,Fl(this))};M.Ya=function(t){this.g&&(this.response=t,Fl(this))};M.ka=function(){this.g&&Fl(this)};function Fl(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Sl(t)}M.setRequestHeader=function(t,e){this.v.append(t,e)};M.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};M.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Sl(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(cg.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var j3=Z.JSON.parse;function He(t){Et.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=gP,this.L=this.M=!1}It(He,Et);var gP="",U3=/^https?$/i,B3=["POST","PUT"];M=He.prototype;M.Oa=function(t){this.M=t};M.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():zE.g(),this.C=this.u?CN(this.u):CN(zE),this.g.onreadystatechange=Ft(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){bN(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=Z.FormData&&t instanceof Z.FormData,!(0<=RN(B3,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{vP(this),0<this.B&&((this.L=$3(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ft(this.ua,this)):this.A=lI(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){bN(this,s)}};function $3(t){return Ha&&typeof t.timeout=="number"&&t.ontimeout!==void 0}M.ua=function(){typeof JE<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Nt(this,"timeout"),this.abort(8))};function bN(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,mP(t),ug(t)}function mP(t){t.F||(t.F=!0,Nt(t,"complete"),Nt(t,"error"))}M.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Nt(this,"complete"),Nt(this,"abort"),ug(this))};M.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ug(this,!0)),He.$.N.call(this)};M.La=function(){this.s||(this.G||this.v||this.l?yP(this):this.kb())};M.kb=function(){yP(this)};function yP(t){if(t.h&&typeof JE<"u"&&(!t.C[1]||Cr(t)!=4||t.da()!=2)){if(t.v&&Cr(t)==4)lI(t.La,0,t);else if(Nt(t,"readystatechange"),Cr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(sP)[1]||null;!i&&Z.self&&Z.self.location&&(i=Z.self.location.protocol.slice(0,-1)),r=!U3.test(i?i.toLowerCase():"")}n=r}if(n)Nt(t,"complete"),Nt(t,"success");else{t.m=6;try{var s=2<Cr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",mP(t)}}finally{ug(t)}}}}function ug(t,e){if(t.g){vP(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||Nt(t,"ready");try{n.onreadystatechange=r}catch{}}}function vP(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(Z.clearTimeout(t.A),t.A=null)}M.isActive=function(){return!!this.g};function Cr(t){return t.g?t.g.readyState:0}M.da=function(){try{return 2<Cr(this)?this.g.status:-1}catch{return-1}};M.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};M.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),j3(e)}};function AN(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case gP:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function q3(t){let e={};t=(t.g&&2<=Cr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(El(t[r]))continue;var n=g3(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}d3(e,function(r){return r.join(", ")})}M.Ia=function(){return this.m};M.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function _P(t){let e="";return nI(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function mI(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=_P(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Oe(t,e,n))}function ml(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function wP(t){this.Ga=0,this.j=[],this.l=new ng,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=ml("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=ml("baseRetryDelayMs",5e3,t),this.hb=ml("retryDelaySeedMs",1e4,t),this.eb=ml("forwardChannelMaxRetries",2,t),this.xa=ml("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new uP(t&&t.concurrentRequestLimit),this.Ja=new F3,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}M=wP.prototype;M.ra=8;M.H=1;function yI(t){if(EP(t),t.H==3){var e=t.W++,n=ti(t.I);if(Oe(n,"SID",t.K),Oe(n,"RID",e),Oe(n,"TYPE","terminate"),Vl(t,n),e=new Pl(t,t.l,e),e.L=2,e.A=ag(ti(n)),n=!1,Z.navigator&&Z.navigator.sendBeacon)try{n=Z.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&Z.Image&&(new Image().src=e.A,n=!0),n||(e.g=xP(e.l,null),e.g.ha(e.A)),e.G=Date.now(),kl(e)}AP(t)}function lg(t){t.g&&(_I(t),t.g.cancel(),t.g=null)}function EP(t){lg(t),t.u&&(Z.clearTimeout(t.u),t.u=null),Wp(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&Z.clearTimeout(t.m),t.m=null)}function dg(t){if(!lP(t.i)&&!t.m){t.m=!0;var e=t.Na;Cl||qN(),Dl||(Cl(),Dl=!0),cI.add(e,t),t.C=0}}function H3(t,e){return dP(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Rl(Ft(t.Na,t,e),bP(t,t.C)),t.C++,!0)}M.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Pl(this,this.l,t),s=this.s;if(this.U&&(s?(s=ON(s),FN(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=IP(this,i,e),n=ti(this.I),Oe(n,"RID",t),Oe(n,"CVER",22),this.F&&Oe(n,"X-HTTP-Session-Id",this.F),Vl(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(_P(s)))+"&"+e:this.o&&mI(n,this.o,s)),pI(this.i,i),this.bb&&Oe(n,"TYPE","init"),this.P?(Oe(n,"$req",e),Oe(n,"SID","null"),i.aa=!0,KE(i,n,null)):KE(i,n,e),this.H=2}}else this.H==3&&(t?SN(this,t):this.j.length==0||lP(this.i)||SN(this))};function SN(t,e){var n;e?n=e.m:n=t.W++;let r=ti(t.I);Oe(r,"SID",t.K),Oe(r,"RID",n),Oe(r,"AID",t.V),Vl(t,r),t.o&&t.s&&mI(r,t.o,t.s),n=new Pl(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=IP(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),pI(t.i,n),KE(n,r,e)}function Vl(t,e){t.na&&nI(t.na,function(n,r){Oe(e,r,n)}),t.h&&iP({},function(n,r){Oe(e,r,n)})}function IP(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Ft(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<n;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{V3(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function CP(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Cl||qN(),Dl||(Cl(),Dl=!0),cI.add(e,t),t.A=0}}function vI(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Rl(Ft(t.Ma,t),bP(t,t.A)),t.A++,!0)}M.Ma=function(){if(this.u=null,DP(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Rl(Ft(this.jb,this),t)}};M.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Wt(10),lg(this),DP(this))};function _I(t){t.B!=null&&(Z.clearTimeout(t.B),t.B=null)}function DP(t){t.g=new Pl(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=ti(t.wa);Oe(e,"RID","rpc"),Oe(e,"SID",t.K),Oe(e,"AID",t.V),Oe(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Oe(e,"TO",t.qa),Oe(e,"TYPE","xmlhttp"),Vl(t,e),t.o&&t.s&&mI(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=ag(ti(e)),n.u=null,n.S=!0,eP(n,t)}M.ib=function(){this.v!=null&&(this.v=null,lg(this),vI(this),Wt(19))};function Wp(t){t.v!=null&&(Z.clearTimeout(t.v),t.v=null)}function TP(t,e){var n=null;if(t.g==e){Wp(t),_I(t),t.g=null;var r=2}else if(YE(t.i,e))n=e.F,hP(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=rg(),Nt(r,new QN(r,n)),dg(t)}else CP(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&H3(t,e)||r==2&&vI(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Ys(t,5);break;case 4:Ys(t,10);break;case 3:Ys(t,6);break;default:Ys(t,2)}}}function bP(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Ys(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Ft(t.pb,t);n||(n=new Zs("//www.google.com/images/cleardot.gif"),Z.location&&Z.location.protocol=="http"||Gp(n,"https"),ag(n)),L3(n.toString(),r)}else Wt(2);t.H=0,t.h&&t.h.za(e),AP(t),EP(t)}M.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Wt(2)):(this.l.info("Failed to ping google.com"),Wt(1))};function AP(t){if(t.H=0,t.ma=[],t.h){let e=fP(t.i);(e.length!=0||t.j.length!=0)&&(_N(t.ma,e),_N(t.ma,t.j),t.i.i.length=0,eI(t.j),t.j.length=0),t.h.ya()}}function SP(t,e,n){var r=n instanceof Zs?ti(n):new Zs(n);if(r.g!="")e&&(r.g=e+"."+r.g),zp(r,r.m);else{var i=Z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Zs(null);r&&Gp(s,r),e&&(s.g=e),i&&zp(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Oe(r,n,e),Oe(r,"VER",t.ra),Vl(t,r),r}function xP(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new He(new Ol({ob:n})):new He(t.va),e.Oa(t.J),e}M.isActive=function(){return!!this.h&&this.h.isActive(this)};function MP(){}M=MP.prototype;M.Ba=function(){};M.Aa=function(){};M.za=function(){};M.ya=function(){};M.isActive=function(){return!0};M.Va=function(){};function Kp(){if(Ha&&!(10<=Number(a3)))throw Error("Environmental error: no available transport.")}Kp.prototype.g=function(t,e){return new dn(t,e)};function dn(t,e){Et.call(this),this.g=new wP(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!El(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!El(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new za(this)}It(dn,Et);dn.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Wt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=SP(t,null,t.Y),dg(t)};dn.prototype.close=function(){yI(this.g)};dn.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=aI(t),t=n);e.j.push(new P3(e.fb++,t)),e.H==3&&dg(e)};dn.prototype.N=function(){this.g.h=null,delete this.j,yI(this.g),delete this.g,dn.$.N.call(this)};function RP(t){hI.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}It(RP,hI);function NP(){fI.call(this),this.status=1}It(NP,fI);function za(t){this.g=t}It(za,MP);za.prototype.Ba=function(){Nt(this.g,"a")};za.prototype.Aa=function(t){Nt(this.g,new RP(t))};za.prototype.za=function(t){Nt(this.g,new NP)};za.prototype.ya=function(){Nt(this.g,"b")};function G3(){this.blockSize=-1}function Jn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}It(Jn,G3);Jn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function FE(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}Jn.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)FE(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){FE(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){FE(this,r),i=0;break}}this.h=i,this.i+=e};Jn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function De(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var z3={};function wI(t){return-128<=t&&128>t?i3(t,function(e){return new De([e|0],0>e?-1:0)}):new De([t|0],0>t?-1:0)}function Dr(t){if(isNaN(t)||!isFinite(t))return qa;if(0>t)return Rt(Dr(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=ZE;return new De(e,0)}function PP(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return Rt(PP(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=Dr(Math.pow(e,8)),r=qa,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=Dr(Math.pow(e,s)),r=r.R(s).add(Dr(o))):(r=r.R(n),r=r.add(Dr(o)))}return r}var ZE=4294967296,qa=wI(0),XE=wI(1),xN=wI(16777216);M=De.prototype;M.ea=function(){if(Rn(this))return-Rt(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:ZE+r)*e,e*=ZE}return t};M.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(ei(this))return"0";if(Rn(this))return"-"+Rt(this).toString(t);for(var e=Dr(Math.pow(t,6)),n=this,r="";;){var i=Yp(n,e).g;n=Qp(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,ei(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};M.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function ei(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function Rn(t){return t.h==-1}M.X=function(t){return t=Qp(this,t),Rn(t)?-1:ei(t)?0:1};function Rt(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new De(n,~t.h).add(XE)}M.abs=function(){return Rn(this)?Rt(this):this};M.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new De(n,n[n.length-1]&-2147483648?-1:0)};function Qp(t,e){return t.add(Rt(e))}M.R=function(t){if(ei(this)||ei(t))return qa;if(Rn(this))return Rn(t)?Rt(this).R(Rt(t)):Rt(Rt(this).R(t));if(Rn(t))return Rt(this.R(Rt(t)));if(0>this.X(xN)&&0>t.X(xN))return Dr(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,c=t.D(i)&65535;n[2*r+2*i]+=o*c,Hp(n,2*r+2*i),n[2*r+2*i+1]+=s*c,Hp(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,Hp(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,Hp(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new De(n,0)};function Hp(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function yl(t,e){this.g=t,this.h=e}function Yp(t,e){if(ei(e))throw Error("division by zero");if(ei(t))return new yl(qa,qa);if(Rn(t))return e=Yp(Rt(t),e),new yl(Rt(e.g),Rt(e.h));if(Rn(e))return e=Yp(t,Rt(e)),new yl(Rt(e.g),e.h);if(30<t.g.length){if(Rn(t)||Rn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=XE,r=e;0>=r.X(t);)n=MN(n),r=MN(r);var i=Ba(n,1),s=Ba(r,1);for(r=Ba(r,2),n=Ba(n,2);!ei(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=Ba(r,1),n=Ba(n,1)}return e=Qp(t,i.R(e)),new yl(i,e)}for(i=qa;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=Dr(n),o=s.R(e);Rn(o)||0<o.X(t);)n-=r,s=Dr(n),o=s.R(e);ei(s)&&(s=XE),i=i.add(s),t=Qp(t,o)}return new yl(i,t)}M.gb=function(t){return Yp(this,t).h};M.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new De(n,this.h&t.h)};M.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new De(n,this.h|t.h)};M.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new De(n,this.h^t.h)};function MN(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new De(n,t.h)}function Ba(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new De(i,t.h)}Kp.prototype.createWebChannel=Kp.prototype.g;dn.prototype.send=dn.prototype.u;dn.prototype.open=dn.prototype.m;dn.prototype.close=dn.prototype.close;ig.NO_ERROR=0;ig.TIMEOUT=8;ig.HTTP_ERROR=6;YN.COMPLETE="complete";ZN.EventType=Nl;Nl.OPEN="a";Nl.CLOSE="b";Nl.ERROR="c";Nl.MESSAGE="d";Et.prototype.listen=Et.prototype.O;He.prototype.listenOnce=He.prototype.P;He.prototype.getLastError=He.prototype.Sa;He.prototype.getLastErrorCode=He.prototype.Ia;He.prototype.getStatus=He.prototype.da;He.prototype.getResponseJson=He.prototype.Wa;He.prototype.getResponseText=He.prototype.ja;He.prototype.send=He.prototype.ha;He.prototype.setWithCredentials=He.prototype.Oa;Jn.prototype.digest=Jn.prototype.l;Jn.prototype.reset=Jn.prototype.reset;Jn.prototype.update=Jn.prototype.j;De.prototype.add=De.prototype.add;De.prototype.multiply=De.prototype.R;De.prototype.modulo=De.prototype.gb;De.prototype.compare=De.prototype.X;De.prototype.toNumber=De.prototype.ea;De.prototype.toString=De.prototype.toString;De.prototype.getBits=De.prototype.D;De.fromNumber=Dr;De.fromString=PP;var kP=er.createWebChannelTransport=function(){return new Kp},OP=er.getStatEventTarget=function(){return rg()},hg=er.ErrorCode=ig,FP=er.EventType=YN,VP=er.Event=Xs,EI=er.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},wre=er.FetchXmlHttpFactory=Ol,Ll=er.WebChannel=ZN,LP=er.XhrIo=He,jP=er.Md5=Jn,Js=er.Integer=De;var UP="@firebase/firestore";var at=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};at.UNAUTHENTICATED=new at(null),at.GOOGLE_CREDENTIALS=new at("google-credentials-uid"),at.FIRST_PARTY=new at("first-party-uid"),at.MOCK_USER=new at("mock-user");var Ic="10.8.1";var Ki=new pi("@firebase/firestore");function Za(){return Ki.logLevel}function jk(t){Ki.setLogLevel(t)}function C(t,...e){if(Ki.logLevel<=_n.DEBUG){let n=e.map(C0);Ki.debug(`Firestore (${Ic}): ${t}`,...n)}}function Ze(t,...e){if(Ki.logLevel<=_n.ERROR){let n=e.map(C0);Ki.error(`Firestore (${Ic}): ${t}`,...n)}}function Pn(t,...e){if(Ki.logLevel<=_n.WARN){let n=e.map(C0);Ki.warn(`Firestore (${Ic}): ${t}`,...n)}}function C0(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function F(t="Unexpected state"){let e=`FIRESTORE (${Ic}) INTERNAL ASSERTION FAILED: `+t;throw Ze(e),new Error(e)}function q(t,e){t||F()}function Uk(t,e){t||F()}function R(t,e){return t}var v={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},I=class extends vb{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ct=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var Cg=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},bI=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(at.UNAUTHENTICATED))}shutdown(){}},AI=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},SI=class{constructor(e){this.t=e,this.currentUser=at.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve(),s=new ct;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ct,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(()=>_(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},a=c=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ct)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(q(typeof r.accessToken=="string"),new Cg(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return q(e===null||typeof e=="string"),new at(e)}},xI=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=at.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},MI=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new xI(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(at.FIRST_PARTY))}shutdown(){}invalidateToken(){}},RI=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},NI=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,C("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(q(typeof n.token=="string"),this.R=n.token,new RI(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function K3(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var Dg=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=K3(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function J(t,e){return t<e?-1:t>e?1:0}function oc(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function Bk(t){return t+"\0"}var $e=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new I(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new I(v.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new I(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new I(v.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?J(this.nanoseconds,e.nanoseconds):J(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var H=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new $e(0,0))}static max(){return new t(new $e(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Tg=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&F(),r===void 0?r=e.length-n:r>e.length-n&&F(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},ye=class t extends Tg{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new I(v.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},Q3=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xe=class t extends Tg{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return Q3.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new I(v.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new I(v.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new I(v.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new I(v.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var S=class t{constructor(e){this.path=e}static fromPath(e){return new t(ye.fromString(e))}static fromName(e){return new t(ye.fromString(e).popFirst(5))}static empty(){return new t(ye.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ye.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return ye.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new ye(e.slice()))}};var ac=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function PI(t){return t.fields.find(e=>e.kind===2)}function to(t){return t.fields.filter(e=>e.kind!==2)}ac.UNKNOWN_ID=-1;var rc=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var Yl=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,kn.min())}};function $k(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=H.fromTimestamp(r===1e9?new $e(n+1,0):new $e(n,r));return new kn(i,S.empty(),e)}function qk(t){return new kn(t.readTime,t.key,-1)}var kn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(H.min(),S.empty(),-1)}static max(){return new t(H.max(),S.empty(),-1)}};function D0(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=S.comparator(t.documentKey,e.documentKey),n!==0?n:J(t.largestBatchId,e.largestBatchId))}var Hk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",bg=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function is(t){return _(this,null,function*(){if(t.code!==v.FAILED_PRECONDITION||t.message!==Hk)throw t;C("LocalStore","Unexpectedly lost primary lease")})}var y=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&F(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},c=>r(c))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;n(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var Ag=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new ct,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new ao(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=T0(r.target.error);this.V.reject(new ao(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new ao(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(C("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new OI(n)}},ii=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(Qc())===12.2&&Ze("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return C("SimpleDb","Removing database:",e),no(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!dh())return!1;if(t.C())return!0;let e=Qc(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return _(this,null,function*(){return this.db||(C("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new ao(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new I(v.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new I(v.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new ao(e,o))},i.onupgradeneeded=s=>{C("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{C("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return _(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=Ag.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.g(),u)).catch(u=>(a.abort(u),y.reject(u))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(C("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}},kI=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return no(this.k.delete())}},ao=class extends I{constructor(e,n){super(v.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function ss(t){return t.name==="IndexedDbTransactionError"}var OI=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(C("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(C("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),no(r)}add(e){return C("SimpleDb","ADD",this.store.name,e,e),no(this.store.add(e))}get(e){return no(this.store.get(e)).next(n=>(n===void 0&&(n=null),C("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return C("SimpleDb","DELETE",this.store.name,e),no(this.store.delete(e))}count(){return C("SimpleDb","COUNT",this.store.name),no(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new y((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,c)=>{o.push(c)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new y((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){C("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new y((r,i)=>{n.onerror=s=>{let o=T0(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new y((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new kI(a),u=n(a.primaryKey,a.value,c);if(u instanceof y){let l=u.catch(d=>(c.done(),y.reject(d)));r.push(l)}c.isDone?i():c.$===null?a.continue():a.continue(c.$)}}).next(()=>y.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function no(t){return new y((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=T0(r.target.error);n(i)}})}var BP=!1;function T0(t){let e=ii.S(Qc());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new I("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return BP||(BP=!0,setTimeout(()=>{throw r},0)),r}}return t}var FI=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){C("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>_(this,null,function*(){this.task=null;try{C("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){ss(n)?C("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield is(n)}yield this.ee(6e4)}))}},VI=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return _(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return y.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return C("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(C("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=qk(s);D0(o,r)>0&&(r=o)}),new kn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var hn=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function _d(t){return t==null}function Zl(t){return t===0&&1/t==-1/0}function Gk(t){return typeof t=="number"&&Number.isInteger(t)&&!Zl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Kt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=$P(e)),e=Y3(t.get(n),e);return $P(e)}function Y3(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function $P(t){return t+""}function Tr(t){let e=t.length;if(q(e>=2),e===2)return q(t.charAt(0)===""&&t.charAt(1)===""),ye.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&F(),t.charAt(o+1)){case"":let a=t.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:F()}s=o+2}return new ye(r)}var qP=["userId","batchId"];function yg(t,e){return[t,Kt(e)]}function zk(t,e,n){return[t,Kt(e),n]}var Z3={},X3=["prefixPath","collectionGroup","readTime","documentId"],J3=["prefixPath","collectionGroup","documentId"],eW=["collectionGroup","readTime","prefixPath","documentId"],tW=["canonicalId","targetId"],nW=["targetId","path"],rW=["path","targetId"],iW=["collectionId","parent"],sW=["indexId","uid"],oW=["uid","sequenceNumber"],aW=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],cW=["indexId","uid","orderedDocumentKey"],uW=["userId","collectionPath","documentId"],lW=["userId","collectionPath","largestBatchId"],dW=["userId","collectionGroup","largestBatchId"],Wk=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],hW=[...Wk,"documentOverlays"],Kk=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Qk=Kk,fW=[...Qk,"indexConfiguration","indexState","indexEntries"];var Xl=class extends bg{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function Dt(t,e){let n=R(t);return ii.M(n.ae,e)}function HP(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function wo(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Yk(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Fe=class t{constructor(e,n){this.comparator=e,this.root=n||Ar.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ar.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ar.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new nc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new nc(this.root,e,this.comparator,!1)}getReverseIterator(){return new nc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new nc(this.root,e,this.comparator,!0)}},nc=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ar=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw F();let e=this.left.check();if(e!==this.right.check())throw F();return e+(this.isRed()?0:1)}};Ar.EMPTY=null,Ar.RED=!0,Ar.BLACK=!1;Ar.EMPTY=new class{constructor(){this.size=0}get key(){throw F()}get value(){throw F()}get color(){throw F()}get left(){throw F()}get right(){throw F()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Ar(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var xe=class t{constructor(e){this.comparator=e,this.data=new Fe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Sg(this.data.getIterator())}getIteratorFrom(e){return new Sg(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},Sg=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Wa(t){return t.hasNext()?t.getNext():void 0}var fn=class t{constructor(e){this.fields=e,e.sort(Xe.comparator)}static empty(){return new t([])}unionWith(e){let n=new xe(Xe.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return oc(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var xg=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Zk(){return typeof atob<"u"}var Ct=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new xg("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return J(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Ct.EMPTY_BYTE_STRING=new Ct("");var pW=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qi(t){if(q(!!t),typeof t=="string"){let e=0,n=pW.exec(t);if(q(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Ge(t.seconds),nanos:Ge(t.nanos)}}function Ge(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Yi(t){return typeof t=="string"?Ct.fromBase64String(t):Ct.fromUint8Array(t)}function _m(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function b0(t){let e=t.mapValue.fields.__previous_value__;return _m(e)?b0(e):e}function Jl(t){let e=Qi(t.mapValue.fields.__local_write_time__.timestampValue);return new $e(e.seconds,e.nanos)}var LI=class{constructor(e,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},Zi=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var zi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},vg={nullValue:"NULL_VALUE"};function co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_m(t)?4:Xk(t)?9007199254740991:10:F()}function Mr(t,e){if(t===e)return!0;let n=co(t);if(n!==co(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jl(t).isEqual(Jl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Qi(i.timestampValue),a=Qi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Yi(i.bytesValue).isEqual(Yi(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Ge(i.geoPointValue.latitude)===Ge(s.geoPointValue.latitude)&&Ge(i.geoPointValue.longitude)===Ge(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Ge(i.integerValue)===Ge(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Ge(i.doubleValue),a=Ge(s.doubleValue);return o===a?Zl(o)===Zl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return oc(t.arrayValue.values||[],e.arrayValue.values||[],Mr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(HP(o)!==HP(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Mr(o[c],a[c])))return!1;return!0}(t,e);default:return F()}}function ed(t,e){return(t.values||[]).find(n=>Mr(n,e))!==void 0}function Xi(t,e){if(t===e)return 0;let n=co(t),r=co(e);if(n!==r)return J(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return J(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Ge(s.integerValue||s.doubleValue),c=Ge(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(t,e);case 3:return GP(t.timestampValue,e.timestampValue);case 4:return GP(Jl(t),Jl(e));case 5:return J(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Yi(s),c=Yi(o);return a.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let u=0;u<a.length&&u<c.length;u++){let l=J(a[u],c[u]);if(l!==0)return l}return J(a.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=J(Ge(s.latitude),Ge(o.latitude));return a!==0?a:J(Ge(s.longitude),Ge(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],c=o.values||[];for(let u=0;u<a.length&&u<c.length;++u){let l=Xi(a[u],c[u]);if(l)return l}return J(a.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===zi.mapValue&&o===zi.mapValue)return 0;if(s===zi.mapValue)return 1;if(o===zi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),u=o.fields||{},l=Object.keys(u);c.sort(),l.sort();for(let d=0;d<c.length&&d<l.length;++d){let h=J(c[d],l[d]);if(h!==0)return h;let f=Xi(a[c[d]],u[l[d]]);if(f!==0)return f}return J(c.length,l.length)}(t.mapValue,e.mapValue);default:throw F()}}function GP(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return J(t,e);let n=Qi(t),r=Qi(e),i=J(n.seconds,r.seconds);return i!==0?i:J(n.nanos,r.nanos)}function cc(t){return jI(t)}function jI(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Qi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Yi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return S.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=jI(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${jI(n.fields[o])}`;return i+"}"}(t.mapValue):F()}function uo(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function UI(t){return!!t&&"integerValue"in t}function td(t){return!!t&&"arrayValue"in t}function zP(t){return!!t&&"nullValue"in t}function WP(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function _g(t){return!!t&&"mapValue"in t}function Gl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return wo(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Gl(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Gl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function Xk(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function gW(t){return"nullValue"in t?vg:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?uo(Zi.empty(),S.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:F()}function mW(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?uo(Zi.empty(),S.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?zi:F()}function KP(t,e){let n=Xi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function QP(t,e){let n=Xi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var jt=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!_g(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gl(n)}setAll(e){let n=Xe.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let c=this.getFieldsMap(n);this.applyChanges(c,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Gl(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());_g(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Mr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];_g(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){wo(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Gl(this.value))}};function Jk(t){let e=[];return wo(t.fields,(n,r)=>{let i=new Xe([n]);if(_g(r)){let s=Jk(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new fn(e)}var ut=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,H.min(),H.min(),H.min(),jt.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,H.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,H.min(),H.min(),jt.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,H.min(),H.min(),jt.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(H.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=jt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=jt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=H.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Rr=class{constructor(e,n){this.position=e,this.inclusive=n}};function YP(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=S.comparator(S.fromName(o.referenceValue),n.key):r=Xi(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function ZP(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Mr(t.position[n],e.position[n]))return!1;return!0}var lo=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function yW(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Mg=class{},pe=class t extends Mg{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new qI(e,n,r):n==="array-contains"?new zI(e,r):n==="in"?new Rg(e,r):n==="not-in"?new WI(e,r):n==="array-contains-any"?new KI(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new HI(e,r):new GI(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Xi(n,this.value)):n!==null&&co(this.value)===co(n)&&this.matchesComparison(Xi(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return F()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Te=class t extends Mg{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return uc(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function uc(t){return t.op==="and"}function BI(t){return t.op==="or"}function A0(t){return eO(t)&&uc(t)}function eO(t){for(let e of t.filters)if(e instanceof Te)return!1;return!0}function $I(t){if(t instanceof pe)return t.field.canonicalString()+t.op.toString()+cc(t.value);if(A0(t))return t.filters.map(e=>$I(e)).join(",");{let e=t.filters.map(n=>$I(n)).join(",");return`${t.op}(${e})`}}function tO(t,e){return t instanceof pe?function(r,i){return i instanceof pe&&r.op===i.op&&r.field.isEqual(i.field)&&Mr(r.value,i.value)}(t,e):t instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&tO(o,i.filters[a]),!0):!1}(t,e):void F()}function nO(t,e){let n=t.filters.concat(e);return Te.create(n,t.op)}function rO(t){return t instanceof pe?function(n){return`${n.field.canonicalString()} ${n.op} ${cc(n.value)}`}(t):t instanceof Te?function(n){return n.op.toString()+" {"+n.getFilters().map(rO).join(" ,")+"}"}(t):"Filter"}var qI=class extends pe{constructor(e,n,r){super(e,n,r),this.key=S.fromName(r.referenceValue)}matches(e){let n=S.comparator(e.key,this.key);return this.matchesComparison(n)}},HI=class extends pe{constructor(e,n){super(e,"in",n),this.keys=iO("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},GI=class extends pe{constructor(e,n){super(e,"not-in",n),this.keys=iO("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function iO(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>S.fromName(r.referenceValue))}var zI=class extends pe{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return td(n)&&ed(n.arrayValue,this.value)}},Rg=class extends pe{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&ed(this.value.arrayValue,n)}},WI=class extends pe{constructor(e,n){super(e,"not-in",n)}matches(e){if(ed(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!ed(this.value.arrayValue,n)}},KI=class extends pe{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!td(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ed(this.value.arrayValue,r))}};var QI=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function YI(t,e=null,n=[],r=[],i=null,s=null,o=null){return new QI(t,e,n,r,i,s,o)}function ho(t){let e=R(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>$I(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),_d(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>cc(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>cc(r)).join(",")),e.ce=n}return e.ce}function wd(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!yW(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!tO(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!ZP(t.startAt,e.startAt)&&ZP(t.endAt,e.endAt)}function Ng(t){return S.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Pg(t,e){return t.filters.filter(n=>n instanceof pe&&n.field.isEqual(e))}function XP(t,e,n){let r=vg,i=!0;for(let s of Pg(t,e)){let o=vg,a=!0;switch(s.op){case"<":case"<=":o=gW(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=vg}KP({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];KP({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function JP(t,e,n){let r=zi,i=!0;for(let s of Pg(t,e)){let o=zi,a=!0;switch(s.op){case">=":case">":o=mW(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=zi}QP({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];QP({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var tr=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function sO(t,e,n,r,i,s,o,a){return new tr(t,e,n,r,i,s,o,a)}function Cc(t){return new tr(t)}function ek(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function S0(t){return t.collectionGroup!==null}function ic(t){let e=R(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new xe(Xe.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new lo(s,r))}),n.has(Xe.keyField().canonicalString())||e.le.push(new lo(Xe.keyField(),r))}return e.le}function Qt(t){let e=R(t);return e.he||(e.he=vW(e,ic(t))),e.he}function vW(t,e){if(t.limitType==="F")return YI(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new lo(i.field,s)});let n=t.endAt?new Rr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Rr(t.startAt.position,t.startAt.inclusive):null;return YI(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function ZI(t,e){let n=t.filters.concat([e]);return new tr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function kg(t,e,n){return new tr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ed(t,e){return wd(Qt(t),Qt(e))&&t.limitType===e.limitType}function oO(t){return`${ho(Qt(t))}|lt:${t.limitType}`}function Xa(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>rO(i)).join(", ")}]`),_d(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>cc(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>cc(i)).join(",")),`Target(${r})`}(Qt(t))}; limitType=${t.limitType})`}function Id(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):S.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of ic(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,c){let u=YP(o,a,c);return o.inclusive?u<=0:u<0}(r.startAt,ic(r),i)||r.endAt&&!function(o,a,c){let u=YP(o,a,c);return o.inclusive?u>=0:u>0}(r.endAt,ic(r),i))}(t,e)}function aO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function cO(t){return(e,n)=>{let r=!1;for(let i of ic(t)){let s=_W(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function _W(t,e,n){let r=t.field.isKeyField()?S.comparator(e.key,n.key):function(s,o,a){let c=o.data.field(s),u=a.data.field(s);return c!==null&&u!==null?Xi(c,u):F()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return F()}}var Nr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){wo(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Yk(this.inner)}size(){return this.innerSize}};var wW=new Fe(S.comparator);function on(){return wW}var uO=new Fe(S.comparator);function ql(...t){let e=uO;for(let n of t)e=e.insert(n.key,n);return e}function lO(t){let e=uO;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function br(){return zl()}function dO(){return zl()}function zl(){return new Nr(t=>t.toString(),(t,e)=>t.isEqual(e))}var EW=new Fe(S.comparator),IW=new xe(S.comparator);function te(...t){let e=IW;for(let n of t)e=e.add(n);return e}var CW=new xe(J);function x0(){return CW}function hO(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Zl(e)?"-0":e}}function fO(t){return{integerValue:""+t}}function pO(t,e){return Gk(e)?fO(e):hO(t,e)}var lc=class{constructor(){this._=void 0}};function DW(t,e,n){return t instanceof Ji?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&_m(s)&&(s=b0(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof si?mO(t,e):t instanceof oi?yO(t,e):function(i,s){let o=gO(i,s),a=tk(o)+tk(i.Ie);return UI(o)&&UI(i.Ie)?fO(a):hO(i.serializer,a)}(t,e)}function TW(t,e,n){return t instanceof si?mO(t,e):t instanceof oi?yO(t,e):n}function gO(t,e){return t instanceof es?function(r){return UI(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Ji=class extends lc{},si=class extends lc{constructor(e){super(),this.elements=e}};function mO(t,e){let n=vO(e);for(let r of t.elements)n.some(i=>Mr(i,r))||n.push(r);return{arrayValue:{values:n}}}var oi=class extends lc{constructor(e){super(),this.elements=e}};function yO(t,e){let n=vO(e);for(let r of t.elements)n=n.filter(i=>!Mr(i,r));return{arrayValue:{values:n}}}var es=class extends lc{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function tk(t){return Ge(t.integerValue||t.doubleValue)}function vO(t){return td(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var fo=class{constructor(e,n){this.field=e,this.transform=n}};function bW(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof si&&i instanceof si||r instanceof oi&&i instanceof oi?oc(r.elements,i.elements,Mr):r instanceof es&&i instanceof es?Mr(r.Ie,i.Ie):r instanceof Ji&&i instanceof Ji}(t.transform,e.transform)}var XI=class{constructor(e,n){this.version=e,this.transformResults=n}},ze=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function wg(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var dc=class{};function _O(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new ns(t.key,ze.none()):new ts(t.key,t.data,ze.none());{let n=t.data,r=jt.empty(),i=new xe(Xe.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new nr(t.key,r,new fn(i.toArray()),ze.none())}}function AW(t,e,n){t instanceof ts?function(i,s,o){let a=i.value.clone(),c=rk(i.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof nr?function(i,s,o){if(!wg(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=rk(i.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(wO(i)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Wl(t,e,n,r){return t instanceof ts?function(s,o,a,c){if(!wg(s.precondition,o))return a;let u=s.value.clone(),l=ik(s.fieldTransforms,c,o);return u.setAll(l),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof nr?function(s,o,a,c){if(!wg(s.precondition,o))return a;let u=ik(s.fieldTransforms,c,o),l=o.data;return l.setAll(wO(s)),l.setAll(u),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return wg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function SW(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=gO(r.transform,i||null);s!=null&&(n===null&&(n=jt.empty()),n.set(r.field,s))}return n||null}function nk(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&oc(r,i,(s,o)=>bW(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var ts=class extends dc{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},nr=class extends dc{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function wO(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function rk(t,e,n){let r=new Map;q(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,TW(o,a,n[i]))}return r}function ik(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,DW(s,o,e))}return r}var ns=class extends dc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},nd=class extends dc{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var rd=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&AW(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Wl(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Wl(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=dO();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let c=_O(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(H.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),te())}isEqual(e){return this.batchId===e.batchId&&oc(this.mutations,e.mutations,(n,r)=>nk(n,r))&&oc(this.baseMutations,e.baseMutations,(n,r)=>nk(n,r))}},JI=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){q(e.mutations.length===r.length);let i=function(){return EW}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var id=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var eC=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var st,me;function EO(t){switch(t){default:return F();case v.CANCELLED:case v.UNKNOWN:case v.DEADLINE_EXCEEDED:case v.RESOURCE_EXHAUSTED:case v.INTERNAL:case v.UNAVAILABLE:case v.UNAUTHENTICATED:return!1;case v.INVALID_ARGUMENT:case v.NOT_FOUND:case v.ALREADY_EXISTS:case v.PERMISSION_DENIED:case v.FAILED_PRECONDITION:case v.ABORTED:case v.OUT_OF_RANGE:case v.UNIMPLEMENTED:case v.DATA_LOSS:return!0}}function IO(t){if(t===void 0)return Ze("GRPC error has no .code"),v.UNKNOWN;switch(t){case st.OK:return v.OK;case st.CANCELLED:return v.CANCELLED;case st.UNKNOWN:return v.UNKNOWN;case st.DEADLINE_EXCEEDED:return v.DEADLINE_EXCEEDED;case st.RESOURCE_EXHAUSTED:return v.RESOURCE_EXHAUSTED;case st.INTERNAL:return v.INTERNAL;case st.UNAVAILABLE:return v.UNAVAILABLE;case st.UNAUTHENTICATED:return v.UNAUTHENTICATED;case st.INVALID_ARGUMENT:return v.INVALID_ARGUMENT;case st.NOT_FOUND:return v.NOT_FOUND;case st.ALREADY_EXISTS:return v.ALREADY_EXISTS;case st.PERMISSION_DENIED:return v.PERMISSION_DENIED;case st.FAILED_PRECONDITION:return v.FAILED_PRECONDITION;case st.ABORTED:return v.ABORTED;case st.OUT_OF_RANGE:return v.OUT_OF_RANGE;case st.UNIMPLEMENTED:return v.UNIMPLEMENTED;case st.DATA_LOSS:return v.DATA_LOSS;default:return F()}}(me=st||(st={}))[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var sk=null;function CO(){return new TextEncoder}var xW=new Js([4294967295,4294967295],0);function ok(t){let e=CO().encode(t),n=new jP;return n.update(e),new Uint8Array(n.digest())}function ak(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Js([n,r],0),new Js([i,s],0)]}var tC=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new oo(`Invalid padding: ${n}`);if(r<0)throw new oo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new oo(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new oo(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Js.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Js.fromNumber(r)));return i.compare(xW)===1&&(i=new Js([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=ok(e),[r,i]=ak(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=ok(e),[r,i]=ak(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},oo=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var sd=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,od.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(H.min(),i,new Fe(J),on(),te())}},od=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,te(),te(),te())}};var sc=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},Og=class{constructor(e,n){this.targetId=e,this.fe=n}},Fg=class{constructor(e,n,r=Ct.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},Vg=class{constructor(){this.ge=0,this.pe=uk(),this.ye=Ct.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=te(),n=te(),r=te();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:F()}}),new od(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=uk()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,q(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},nC=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=on(),this.Qe=ck(),this.Ke=new Fe(J)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:F()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(Ng(s))if(r===0){let o=new S(s.path);this.We(n,o,ut.newNoDocument(o,H.min()))}else q(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),c=a?this.et(a,e,o):1;if(c!==0){this.He(n);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,u)}sk?.tt(function(l,d,h,f,p){var g,m,w,P,T,V;let G={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},W=d.unchangedNames;return W&&(G.bloomFilter={applied:p===0,hashCount:(g=W?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(P=(w=(m=W?.bits)===null||m===void 0?void 0:m.bitmap)===null||w===void 0?void 0:w.length)!==null&&P!==void 0?P:0,padding:(V=(T=W?.bits)===null||T===void 0?void 0:T.padding)!==null&&V!==void 0?V:0,mightContain:Ee=>{var en;return(en=f?.mightContain(Ee))!==null&&en!==void 0&&en}}),G}(o,e.fe,this.Le.nt(),a,c))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Yi(r).toUint8Array()}catch(c){if(c instanceof xg)return Pn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new tC(o,i,s)}catch(c){return Pn(c instanceof oo?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&Ng(a.target)){let c=new S(a.target.path);this.qe.get(c)!==null||this.st(o,c)||this.We(o,c,ut.newNoDocument(c,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=te();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.Ye(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new sd(e,n,this.Ke,this.qe,r);return this.qe=on(),this.Qe=ck(),this.Ke=new Fe(J),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new Vg,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new xe(J),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||C("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Vg),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function ck(){return new Fe(S.comparator)}function uk(){return new Fe(S.comparator)}var MW={asc:"ASCENDING",desc:"DESCENDING"},RW={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},NW={and:"AND",or:"OR"},rC=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function iC(t,e){return t.useProto3Json||_d(e)?e:{value:e}}function hc(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function DO(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function PW(t,e){return hc(t,e.toTimestamp())}function Je(t){return q(!!t),H.fromTimestamp(function(n){let r=Qi(n);return new $e(r.seconds,r.nanos)}(t))}function M0(t,e){return sC(t,e).canonicalString()}function sC(t,e){let n=function(i){return new ye(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function TO(t){let e=ye.fromString(t);return q(OO(e)),e}function ad(t,e){return M0(t.databaseId,e.path)}function Sr(t,e){let n=TO(e);if(n.get(1)!==t.databaseId.projectId)throw new I(v.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new I(v.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new S(SO(n))}function bO(t,e){return M0(t.databaseId,e)}function AO(t){let e=TO(t);return e.length===4?ye.emptyPath():SO(e)}function oC(t){return new ye(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function SO(t){return q(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function lk(t,e,n){return{name:ad(t,e),fields:n.value.mapValue.fields}}function xO(t,e,n){let r=Sr(t,e.name),i=Je(e.updateTime),s=e.createTime?Je(e.createTime):H.min(),o=new jt({mapValue:{fields:e.fields}}),a=ut.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function kW(t,e){return"found"in e?function(r,i){q(!!i.found),i.found.name,i.found.updateTime;let s=Sr(r,i.found.name),o=Je(i.found.updateTime),a=i.found.createTime?Je(i.found.createTime):H.min(),c=new jt({mapValue:{fields:i.found.fields}});return ut.newFoundDocument(s,o,a,c)}(t,e):"missing"in e?function(r,i){q(!!i.missing),q(!!i.readTime);let s=Sr(r,i.missing),o=Je(i.readTime);return ut.newNoDocument(s,o)}(t,e):F()}function OW(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:F()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(u,l){return u.useProto3Json?(q(l===void 0||typeof l=="string"),Ct.fromBase64String(l||"")):(q(l===void 0||l instanceof Uint8Array),Ct.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){let l=u.code===void 0?v.UNKNOWN:IO(u.code);return new I(l,u.message||"")}(o);n=new Fg(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Sr(t,r.document.name),s=Je(r.document.updateTime),o=r.document.createTime?Je(r.document.createTime):H.min(),a=new jt({mapValue:{fields:r.document.fields}}),c=ut.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new sc(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Sr(t,r.document),s=r.readTime?Je(r.readTime):H.min(),o=ut.newNoDocument(i,s),a=r.removedTargetIds||[];n=new sc([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Sr(t,r.document),s=r.removedTargetIds||[];n=new sc([],s,i,null)}else{if(!("filter"in e))return F();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new eC(i,s),a=r.targetId;n=new Og(a,o)}}return n}function cd(t,e){let n;if(e instanceof ts)n={update:lk(t,e.key,e.value)};else if(e instanceof ns)n={delete:ad(t,e.key)};else if(e instanceof nr)n={update:lk(t,e.key,e.data),updateMask:BW(e.fieldMask)};else{if(!(e instanceof nd))return F();n={verify:ad(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Ji)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof si)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof oi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof es)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw F()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:PW(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:F()}(t,e.precondition)),n}function aC(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?ze.updateTime(Je(s.updateTime)):s.exists!==void 0?ze.exists(s.exists):ze.none()}(e.currentDocument):ze.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let c=null;if("setToServerValue"in a)q(a.setToServerValue==="REQUEST_TIME"),c=new Ji;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];c=new si(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];c=new oi(l)}else"increment"in a?c=new es(o,a.increment):F();let u=Xe.fromServerFormat(a.fieldPath);return new fo(u,c)}(t,i)):[];if(e.update){e.update.name;let i=Sr(t,e.update.name),s=new jt({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(c){let u=c.fieldPaths||[];return new fn(u.map(l=>Xe.fromServerFormat(l)))}(e.updateMask);return new nr(i,s,o,n,r)}return new ts(i,s,n,r)}if(e.delete){let i=Sr(t,e.delete);return new ns(i,n)}if(e.verify){let i=Sr(t,e.verify);return new nd(i,n)}return F()}function FW(t,e){return t&&t.length>0?(q(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Je(i.updateTime):Je(s);return o.isEqual(H.min())&&(o=Je(s)),new XI(o,i.transformResults||[])}(n,e))):[]}function MO(t,e){return{documents:[bO(t,e.path)]}}function RO(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=bO(t,i);let s=function(u){if(u.length!==0)return kO(Te.create(u,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(u){if(u.length!==0)return u.map(l=>function(h){return{field:Ja(h.field),direction:LW(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=iC(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{ut:n,parent:i}}function NO(t){let e=AO(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){q(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=PO(d);return h instanceof Te&&A0(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new lo(ec(p.field),function(m){switch(m){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,_d(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(d){let h=!!d.before,f=d.values||[];return new Rr(f,h)}(n.startAt));let u=null;return n.endAt&&(u=function(d){let h=!d.before,f=d.values||[];return new Rr(f,h)}(n.endAt)),sO(e,i,o,s,a,"F",c,u)}function VW(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return F()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function PO(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=ec(n.unaryFilter.field);return pe.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ec(n.unaryFilter.field);return pe.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ec(n.unaryFilter.field);return pe.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ec(n.unaryFilter.field);return pe.create(o,"!=",{nullValue:"NULL_VALUE"});default:return F()}}(t):t.fieldFilter!==void 0?function(n){return pe.create(ec(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return F()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Te.create(n.compositeFilter.filters.map(r=>PO(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return F()}}(n.compositeFilter.op))}(t):F()}function LW(t){return MW[t]}function jW(t){return RW[t]}function UW(t){return NW[t]}function Ja(t){return{fieldPath:t.canonicalString()}}function ec(t){return Xe.fromServerFormat(t.fieldPath)}function kO(t){return t instanceof pe?function(n){if(n.op==="=="){if(WP(n.value))return{unaryFilter:{field:Ja(n.field),op:"IS_NAN"}};if(zP(n.value))return{unaryFilter:{field:Ja(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(WP(n.value))return{unaryFilter:{field:Ja(n.field),op:"IS_NOT_NAN"}};if(zP(n.value))return{unaryFilter:{field:Ja(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ja(n.field),op:jW(n.op),value:n.value}}}(t):t instanceof Te?function(n){let r=n.getFilters().map(i=>kO(i));return r.length===1?r[0]:{compositeFilter:{op:UW(n.op),filters:r}}}(t):F()}function BW(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function OO(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var fc=class t{constructor(e,n,r,i,s=H.min(),o=H.min(),a=Ct.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var Lg=class{constructor(e){this.ct=e}};function $W(t,e){let n;if(e.document)n=xO(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=S.fromSegments(e.noDocument.path),i=go(e.noDocument.readTime);n=ut.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return F();{let r=S.fromSegments(e.unknownDocument.path),i=go(e.unknownDocument.version);n=ut.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new $e(i[0],i[1]);return H.fromTimestamp(s)}(e.readTime)),n}function dk(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:jg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:ad(s,o.key),fields:o.data.value.mapValue.fields,updateTime:hc(s,o.version.toTimestamp()),createTime:hc(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:po(e.version)};else{if(!e.isUnknownDocument())return F();r.unknownDocument={path:n.path.toArray(),version:po(e.version)}}return r}function jg(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function po(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function go(t){let e=new $e(t.seconds,t.nanoseconds);return H.fromTimestamp(e)}function ro(t,e){let n=(e.baseMutations||[]).map(s=>aC(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>aC(t.ct,s)),i=$e.fromMillis(e.localWriteTimeMs);return new rd(e.batchId,i,n,r)}function Hl(t){let e=go(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?go(t.lastLimboFreeSnapshotVersion):H.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return q(s.documents.length===1),Qt(Cc(AO(s.documents[0])))}(t.query):function(s){return Qt(NO(s))}(t.query),new fc(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Ct.fromBase64String(t.resumeToken))}function FO(t,e){let n=po(e.snapshotVersion),r=po(e.lastLimboFreeSnapshotVersion),i;i=Ng(e.target)?MO(t.ct,e.target):RO(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ho(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function R0(t){let e=NO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?kg(e,e.limit,"L"):e}function II(t,e){return new id(e.largestBatchId,aC(t.ct,e.overlayMutation))}function hk(t,e){let n=e.path.lastSegment();return[t,Kt(e.path.popLast()),n]}function fk(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:po(r.readTime),documentKey:Kt(r.documentKey.path),largestBatchId:r.largestBatchId}}var cC=class{getBundleMetadata(e,n){return pk(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:go(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return pk(e).put(function(i){return{bundleId:i.id,createTime:po(Je(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return gk(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:R0(s.bundledQuery),readTime:go(s.readTime)}}(r)})}saveNamedQuery(e,n){return gk(e).put(function(i){return{name:i.name,readTime:po(Je(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function pk(t){return Dt(t,"bundles")}function gk(t){return Dt(t,"namedQueries")}var Ug=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return jl(e).get(hk(this.userId,n)).next(r=>r?II(this.serializer,r):null)}getOverlays(e,n){let r=br();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new id(n,o);i.push(this.ht(e,a))}),y.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Kt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(jl(e).H("collectionPathOverlayIndex",a))}),y.waitFor(s)}getOverlaysForCollection(e,n,r){let i=br(),s=Kt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return jl(e).W("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let u=II(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=br(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return jl(e).Y({index:"collectionGroupOverlayIndex",range:a},(c,u,l)=>{let d=II(this.serializer,u);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return jl(e).put(function(i,s,o){let[a,c,u]=hk(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:cd(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function jl(t){return Dt(t,"documentOverlays")}var ni=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Ge(e.integerValue));else if("doubleValue"in e){let r=Ge(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),Zl(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Yi(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?Xk(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):F()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),S.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};ni.bt=new ni;function qW(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function mk(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=qW(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var uC=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Bt(e){let n=this.Lt(e),r=mk(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Lt(e),r=mk(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},lC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}},dC=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},io=class{constructor(){this.Gt=new uC,this.zt=new lC(this.Gt),this.jt=new dC(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var so=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function $i(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=yk(t.arrayValue,e.arrayValue),n!==0?n:(n=yk(t.directionalValue,e.directionalValue),n!==0?n:S.comparator(t.documentKey,e.documentKey)))}function yk(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var Bg=class{constructor(e){this.Yt=new xe((n,r)=>Xe.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(q(e.collectionGroup===this.collectionId),this.en)return!1;let n=PI(e);if(n!==void 0&&!this.nn(n))return!1;let r=to(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let c=r[s];if(!this.rn(a,c)||!this.sn(this.Zt[o++],c))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new xe(Xe.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new rc(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new rc(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new rc(r.field,r.dir==="asc"?0:1)));return new ac(ac.UNKNOWN_ID,this.collectionId,n,Yl.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function VO(t){var e,n;if(q(t instanceof pe||t instanceof Te),t instanceof pe){if(t instanceof Rg){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>pe.create(t.field,"==",s)))||[];return Te.create(i,"or")}return t}let r=t.filters.map(i=>VO(i));return Te.create(r,t.op)}function HW(t){if(t.getFilters().length===0)return[];let e=pC(VO(t));return q(LO(e)),hC(e)||fC(e)?[e]:e.getFilters()}function hC(t){return t instanceof pe}function fC(t){return t instanceof Te&&A0(t)}function LO(t){return hC(t)||fC(t)||function(n){if(n instanceof Te&&BI(n)){for(let r of n.getFilters())if(!hC(r)&&!fC(r))return!1;return!0}return!1}(t)}function pC(t){if(q(t instanceof pe||t instanceof Te),t instanceof pe)return t;if(t.filters.length===1)return pC(t.filters[0]);let e=t.filters.map(r=>pC(r)),n=Te.create(e,t.op);return n=$g(n),LO(n)?n:(q(n instanceof Te),q(uc(n)),q(n.filters.length>1),n.filters.reduce((r,i)=>N0(r,i)))}function N0(t,e){let n;return q(t instanceof pe||t instanceof Te),q(e instanceof pe||e instanceof Te),n=t instanceof pe?e instanceof pe?function(i,s){return Te.create([i,s],"and")}(t,e):vk(t,e):e instanceof pe?vk(e,t):function(i,s){if(q(i.filters.length>0&&s.filters.length>0),uc(i)&&uc(s))return nO(i,s.getFilters());let o=BI(i)?i:s,a=BI(i)?s:i,c=o.filters.map(u=>N0(u,a));return Te.create(c,"or")}(t,e),$g(n)}function vk(t,e){if(uc(e))return nO(e,t.getFilters());{let n=e.filters.map(r=>N0(t,r));return Te.create(n,"or")}}function $g(t){if(q(t instanceof pe||t instanceof Te),t instanceof pe)return t;let e=t.getFilters();if(e.length===1)return $g(e[0]);if(eO(t))return t;let n=e.map(i=>$g(i)),r=[];return n.forEach(i=>{i instanceof pe?r.push(i):i instanceof Te&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Te.create(r,t.op)}var gC=class{constructor(){this._n=new ud}addToCollectionParentIndex(e,n){return this._n.add(n),y.resolve()}getCollectionParents(e,n){return y.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return y.resolve()}deleteFieldIndex(e,n){return y.resolve()}deleteAllFieldIndexes(e){return y.resolve()}createTargetIndexes(e,n){return y.resolve()}getDocumentsMatchingTarget(e,n){return y.resolve(null)}getIndexType(e,n){return y.resolve(0)}getFieldIndexes(e,n){return y.resolve([])}getNextCollectionGroupToUpdate(e){return y.resolve(null)}getMinOffset(e,n){return y.resolve(kn.min())}getMinOffsetFromCollectionGroup(e,n){return y.resolve(kn.min())}updateCollectionGroup(e,n,r){return y.resolve()}updateIndexEntries(e,n){return y.resolve()}},ud=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new xe(ye.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new xe(ye.comparator)).toArray()}};var fg=new Uint8Array(0),mC=class{constructor(e,n){this.databaseId=n,this.an=new ud,this.un=new Nr(r=>ho(r),(r,i)=>wd(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:Kt(i)};return _k(e).put(s)}return y.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[Bk(n),""],!1,!0);return _k(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(Tr(o.parent))}return r})}addFieldIndex(e,n){let r=Ul(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=Qa(e);return s.next(a=>{o.put(fk(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=Ul(e),i=Qa(e),s=Ka(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=Ul(e),r=Ka(e),i=Qa(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return y.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Bg(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=Ka(e),i=!0,s=new Map;return y.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=te(),a=[];return y.forEach(s,(c,u)=>{C("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(V=>`${V.fieldPath}:${V.kind}`).join(",")}`}(c)} to execute ${ho(n)}`);let l=function(T,V){let G=PI(V);if(G===void 0)return null;for(let W of Pg(T,G.fieldPath))switch(W.op){case"array-contains-any":return W.value.arrayValue.values||[];case"array-contains":return[W.value]}return null}(u,c),d=function(T,V){let G=new Map;for(let W of to(V))for(let Ee of Pg(T,W.fieldPath))switch(Ee.op){case"==":case"in":G.set(W.fieldPath.canonicalString(),Ee.value);break;case"not-in":case"!=":return G.set(W.fieldPath.canonicalString(),Ee.value),Array.from(G.values())}return null}(u,c),h=function(T,V){let G=[],W=!0;for(let Ee of to(V)){let en=Ee.kind===0?XP(T,Ee.fieldPath,T.startAt):JP(T,Ee.fieldPath,T.startAt);G.push(en.value),W&&(W=en.inclusive)}return new Rr(G,W)}(u,c),f=function(T,V){let G=[],W=!0;for(let Ee of to(V)){let en=Ee.kind===0?JP(T,Ee.fieldPath,T.endAt):XP(T,Ee.fieldPath,T.endAt);G.push(en.value),W&&(W=en.inclusive)}return new Rr(G,W)}(u,c),p=this.hn(c,u,h),g=this.hn(c,u,f),m=this.Pn(c,u,d),w=this.In(c.indexId,l,p,h.inclusive,g,f.inclusive,m);return y.forEach(w,P=>r.j(P,n.limit).next(T=>{T.forEach(V=>{let G=S.fromSegments(V.documentKey);o.has(G)||(o=o.add(G),a.push(G))})}))}).next(()=>a)}return y.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=HW(Te.create(e.filters,"and")).map(r=>YI(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let c=(n!=null?n.length:1)*Math.max(r.length,s.length),u=c/(n!=null?n.length:1),l=[];for(let d=0;d<c;++d){let h=n?this.Tn(n[d/u]):fg,f=this.En(e,h,r[d%u],i),p=this.dn(e,h,s[d%u],o),g=a.map(m=>this.En(e,h,m,!0));l.push(...this.createRange(f,p,g))}return l}En(e,n,r,i){let s=new so(e,S.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new so(e,S.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new Bg(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return y.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new xe(Xe.comparator),l=!1;for(let d of c.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:u=u.add(h.field));for(let d of c.orderBy)d.field.isKeyField()||(u=u.add(d.field));return u.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new io;for(let i of to(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);ni.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new io;return ni.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new io;return ni.bt.Pt(uo(this.databaseId,n),r.Ht(function(s){let o=to(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new io);let s=0;for(let o of to(e)){let a=r[s++];for(let c of i)if(this.Vn(n,o.fieldPath)&&td(a))i=this.mn(i,o,a);else{let u=c.Ht(o.kind);ni.bt.Pt(a,u)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new io;c.seed(a.Wt()),ni.bt.Pt(o,c.Ht(n.kind)),s.push(c)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof pe&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=Ul(e),i=Qa(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return y.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(l,d){let h=d?new Yl(d.sequenceNumber,new kn(go(d.readTime),new S(Tr(d.documentKey)),d.largestBatchId)):Yl.empty(),f=l.fields.map(([p,g])=>new rc(Xe.fromServerFormat(p),g));return new ac(l.indexId,l.collectionGroup,f,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:J(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=Ul(e),s=Qa(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>y.forEach(a,c=>s.put(fk(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return y.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?y.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),y.forEach(a,c=>this.pn(e,i,c).next(u=>{let l=this.yn(s,c);return u.isEqual(l)?y.resolve():this.wn(e,s,c,u,l)}))))})}Sn(e,n,r,i){return Ka(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return Ka(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=Ka(e),s=new xe($i);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new so(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new xe($i),i=this.An(n,e);if(i==null)return r;let s=PI(n);if(s!=null){let o=e.data.field(s.fieldPath);if(td(o))for(let a of o.arrayValue.values||[])r=r.add(new so(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new so(n.indexId,e.key,fg,i));return r}wn(e,n,r,i,s){C("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(c,u,l,d,h){let f=c.getIterator(),p=u.getIterator(),g=Wa(f),m=Wa(p);for(;g||m;){let w=!1,P=!1;if(g&&m){let T=l(g,m);T<0?P=!0:T>0&&(w=!0)}else g!=null?P=!0:w=!0;w?(d(m),m=Wa(p)):P?(h(g),g=Wa(f)):(g=Wa(f),m=Wa(p))}}(i,s,$i,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),y.waitFor(o)}gn(e){let n=1;return Qa(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>$i(o,a)).filter((o,a,c)=>!a||$i(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=$i(o,e),c=$i(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&c<0)i.push(o),i.push(o.Jt());else if(c>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,fg,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,fg,[]];s.push(IDBKeyRange.bound(a,c))}return s}Dn(e,n){return $i(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(wk)}getMinOffset(e,n){return y.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||F())).next(wk)}};function _k(t){return Dt(t,"collectionParents")}function Ka(t){return Dt(t,"indexEntries")}function Ul(t){return Dt(t,"indexConfiguration")}function Qa(t){return Dt(t,"indexState")}function wk(t){q(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;D0(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new kn(e.readTime,e.documentKey,n)}var Ek={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Nn=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function jO(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,c=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(c.next(()=>{q(a===1)}));let u=[];for(let l of n.mutations){let d=zk(e,l.key.path,n.batchId);s.push(i.delete(d)),u.push(l.key)}return y.waitFor(s).next(()=>u)}function qg(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw F();e=t.noDocument}return JSON.stringify(e).length}Nn.DEFAULT_COLLECTION_PERCENTILE=10,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nn.DEFAULT=new Nn(41943040,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nn.DISABLED=new Nn(-1,0,0);var Hg=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){q(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return qi(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=tc(e),o=qi(e);return o.add({}).next(a=>{q(typeof a=="number");let c=new rd(a,n,r,i),u=function(f,p,g){let m=g.baseMutations.map(P=>cd(f.ct,P)),w=g.mutations.map(P=>cd(f.ct,P));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:m,mutations:w}}(this.serializer,this.userId,c),l=[],d=new xe((h,f)=>J(h.canonicalString(),f.canonicalString()));for(let h of i){let f=zk(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(u)),l.push(s.put(f,Z3))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=c.keys()}),y.waitFor(l).next(()=>c)})}lookupMutationBatch(e,n){return qi(e).get(n).next(r=>r?(q(r.userId===this.userId),ro(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?y.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return qi(e).Y({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(q(a.batchId>=r),s=ro(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return qi(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return qi(e).W("userMutationsIndex",n).next(r=>r.map(i=>ro(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=yg(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return tc(e).Y({range:i},(o,a,c)=>{let[u,l,d]=o,h=Tr(l);if(u===this.userId&&n.path.isEqual(h))return qi(e).get(d).next(f=>{if(!f)throw F();q(f.userId===this.userId),s.push(ro(this.serializer,f))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xe(J),i=[];return n.forEach(s=>{let o=yg(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=tc(e).Y({range:a},(u,l,d)=>{let[h,f,p]=u,g=Tr(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(c)}),y.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=yg(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new xe(J);return tc(e).Y({range:o},(c,u,l)=>{let[d,h,f]=c,p=Tr(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(qi(e).get(s).next(o=>{if(o===null)throw F();q(o.userId===this.userId),r.push(ro(this.serializer,o))}))}),y.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return jO(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),y.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return y.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return tc(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=Tr(s[1]);i.push(c)}else a.done()}).next(()=>{q(i.length===0)})})}containsKey(e,n){return UO(e,this.userId,n)}xn(e){return BO(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function UO(t,e,n){let r=yg(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return tc(t).Y({range:s,J:!0},(a,c,u)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),u.done()}).next(()=>o)}function qi(t){return Dt(t,"mutations")}function tc(t){return Dt(t,"documentMutations")}function BO(t){return Dt(t,"mutationQueues")}var pc=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Bn(){return new t(-1)}};var yC=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new pc(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>H.fromTimestamp(new $e(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ya(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(q(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return Ya(e).Y((o,a)=>{let c=Hl(a);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>y.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Ya(e).Y((r,i)=>{let s=Hl(i);n(s)})}Ln(e){return Ik(e).get("targetGlobalKey").next(n=>(q(n!==null),n))}kn(e,n){return Ik(e).put("targetGlobalKey",n)}qn(e,n){return Ya(e).put(FO(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=ho(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return Ya(e).Y({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let u=Hl(a);wd(n,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=Hi(e);return n.forEach(o=>{let a=Kt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),y.waitFor(i)}removeMatchingKeys(e,n,r){let i=Hi(e);return y.forEach(n,s=>{let o=Kt(s.path);return y.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=Hi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Hi(e),s=te();return i.Y({range:r,J:!0},(o,a,c)=>{let u=Tr(o[1]),l=new S(u);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=Kt(n.path),i=IDBKeyRange.bound([r],[Bk(r)],!1,!0),s=0;return Hi(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}_t(e,n){return Ya(e).get(n).next(r=>r?Hl(r):null)}};function Ya(t){return Dt(t,"targets")}function Ik(t){return Dt(t,"targetGlobal")}function Hi(t){return Dt(t,"targetDocuments")}function Ck([t,e],[n,r]){let i=J(t,n);return i===0?J(e,r):i}var vC=class{constructor(e){this.Kn=e,this.buffer=new xe(Ck),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();Ck(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},_C=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){C("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>_(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){ss(n)?C("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield is(n)}yield this.zn(3e5)}))}},wC=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return y.resolve(hn._e);let r=new vC(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(C("LruGarbageCollector","Garbage collection skipped; disabled"),y.resolve(Ek)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ek):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,c,u,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(u=Date.now(),Za()<=_n.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(u-c)+`ms
Total Duration: ${u-l}ms`),y.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function GW(t,e){return new wC(t,e)}var EC=class{constructor(e,n){this.db=e,this.garbageCollector=GW(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return pg(e,r)}removeReference(e,n,r){return pg(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return pg(e,n)}er(e,n){return function(i,s){let o=!1;return BO(i).Z(a=>UO(i,a,s).next(c=>(c&&(o=!0),y.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let c=this.er(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,H.min()),Hi(e).delete(function(d){return[0,Kt(d.path)]}(o))))});i.push(c)}}).next(()=>y.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return pg(e,n)}Xn(e,n){let r=Hi(e),i,s=hn._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==hn._e&&n(new S(Tr(i)),s),s=u,i=c):s=hn._e}).next(()=>{s!==hn._e&&n(new S(Tr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function pg(t,e){return Hi(t).put(function(r,i){return{targetId:0,path:Kt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var Gg=class{constructor(){this.changes=new Nr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ut.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?y.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var IC=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return eo(e).put(r)}removeEntry(e,n,r){return eo(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],jg(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=ut.newInvalidDocument(n);return eo(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Bl(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:ut.newInvalidDocument(n)};return eo(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Bl(n))},(i,s)=>{r={document:this.nr(n,s),size:qg(s)}}).next(()=>r)}getEntries(e,n){let r=on();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=on(),i=new Fe(S.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,qg(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return y.resolve();let i=new xe(bk);n.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(Bl(i.first()),Bl(i.last())),o=i.getIterator(),a=o.getNext();return eo(e).Y({index:"documentKeyIndex",range:s},(c,u,l)=>{let d=S.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&bk(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?l.U(Bl(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),jg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return eo(e).W(IDBKeyRange.bound(a,c,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let l=on();for(let d of u){let h=this.nr(S.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(Id(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=on(),o=Tk(n,r),a=Tk(n,kn.max());return eo(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,l)=>{let d=this.nr(S.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new CC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return Dk(e).get("remoteDocumentGlobalKey").next(n=>(q(!!n),n))}tr(e,n){return Dk(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=$W(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(H.min())))return r}return ut.newInvalidDocument(e)}};function $O(t){return new IC(t)}var CC=class extends Gg{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new Nr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new xe((s,o)=>J(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=dk(this.ar.serializer,o);i=i.add(s.path.popLast());let u=qg(c);r+=u-a.size,n.push(this.ar.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=dk(this.ar.serializer,o.convertToNoDocument(H.min()));n.push(this.ar.addEntry(e,s,c))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),y.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function Dk(t){return Dt(t,"remoteDocumentGlobal")}function eo(t){return Dt(t,"remoteDocumentsV14")}function Bl(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Tk(t,e){let n=e.documentKey.path.toArray();return[t,jg(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function bk(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=J(n[s],r[s]),i)return i;return i=J(n.length,r.length),i||(i=J(n[n.length-2],r[r.length-2]),i||J(n[n.length-1],r[r.length-1]))}var DC=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var zg=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Wl(r.mutation,i,fn.empty(),$e.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=te()){let i=br();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ql();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=br();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,te()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=on(),o=zl(),a=function(){return zl()}();return n.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof nr)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),Wl(l.mutation,u,l.mutation.getFieldMask(),$e.now())):o.set(u.key,fn.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),n.forEach((u,l)=>{var d;return a.set(u,new DC(l,(d=o.get(u))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=zl(),i=new Fe((o,a)=>o-a),s=te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=n.get(c);if(u===null)return;let l=r.get(c)||fn.empty();l=a.applyToLocalView(u,l),r.set(c,l);let d=(i.get(a.batchId)||te()).add(c);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,d=dO();l.forEach(h=>{if(!s.has(h)){let f=_O(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,d))}return y.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return S.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):S0(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):y.resolve(br()),a=-1,c=s;return o.next(u=>y.forEach(u,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?y.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{c=c.insert(l,h)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,te())).next(l=>({batchId:a,changes:lO(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new S(n)).next(r=>{let i=ql();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=ql();return this.indexManager.getCollectionParents(e,s).next(a=>y.forEach(a,c=>{let u=function(d,h){return new tr(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((c,u)=>{let l=u.getKey();o.get(l)===null&&(o=o.insert(l,ut.newInvalidDocument(l)))});let a=ql();return o.forEach((c,u)=>{let l=s.get(c);l!==void 0&&Wl(l.mutation,u,fn.empty(),$e.now()),Id(n,u)&&(a=a.insert(c,u))}),a})}};var TC=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return y.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Je(i.createTime)}}(n)),y.resolve()}getNamedQuery(e,n){return y.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:R0(i.bundledQuery),readTime:Je(i.readTime)}}(n)),y.resolve()}};var bC=class{constructor(){this.overlays=new Fe(S.comparator),this.hr=new Map}getOverlay(e,n){return y.resolve(this.overlays.get(n))}getOverlays(e,n){let r=br();return y.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),y.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),y.resolve()}getOverlaysForCollection(e,n,r){let i=br(),s=n.length+1,o=new S(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return y.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Fe((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=br(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=br(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return y.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new id(n,r));let s=this.hr.get(n);s===void 0&&(s=te(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var ld=class{constructor(){this.Pr=new xe(ot.Ir),this.Tr=new xe(ot.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new ot(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new ot(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new S(new ye([])),r=new ot(n,e),i=new ot(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new S(new ye([])),r=new ot(n,e),i=new ot(n,e+1),s=te();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new ot(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},ot=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return S.comparator(e.key,n.key)||J(e.pr,n.pr)}static Er(e,n){return J(e.pr,n.pr)||S.comparator(e.key,n.key)}};var AC=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new xe(ot.Ir)}checkEmpty(e){return y.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new rd(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new ot(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return y.resolve(o)}lookupMutationBatch(e,n){return y.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return y.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return y.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return y.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new ot(n,0),i=new ot(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),y.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new xe(J);return n.forEach(i=>{let s=new ot(i,0),o=new ot(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),y.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;S.isDocumentKey(s)||(s=s.child(""));let o=new ot(new S(s),0),a=new xe(J);return this.wr.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.pr)),!0)},o),y.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){q(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return y.forEach(n.mutations,i=>{let s=new ot(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new ot(n,0),i=this.wr.firstAfterOrEqual(r);return y.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,y.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var SC=class{constructor(e){this.vr=e,this.docs=function(){return new Fe(S.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return y.resolve(r?r.document.mutableCopy():ut.newInvalidDocument(n))}getEntries(e,n){let r=on();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ut.newInvalidDocument(i))}),y.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=on(),o=n.path,a=new S(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||D0(qk(l),r)<=0||(i.has(l.key)||Id(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return y.resolve(s)}getAllFromCollectionGroup(e,n,r,i){F()}Fr(e,n){return y.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new xC(this)}getSize(e){return y.resolve(this.size)}},xC=class extends Gg{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),y.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var MC=class{constructor(e){this.persistence=e,this.Mr=new Nr(n=>ho(n),wd),this.lastRemoteSnapshotVersion=H.min(),this.highestTargetId=0,this.Or=0,this.Nr=new ld,this.targetCount=0,this.Br=pc.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),y.resolve()}getLastRemoteSnapshotVersion(e){return y.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return y.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),y.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),y.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Br=new pc(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,y.resolve()}updateTargetData(e,n){return this.qn(n),y.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,y.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),y.waitFor(s).next(()=>i)}getTargetCount(e){return y.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return y.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),y.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),y.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),y.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return y.resolve(r)}containsKey(e,n){return y.resolve(this.Nr.containsKey(n))}};var Wg=class{constructor(e,n){this.Lr={},this.overlays={},this.kr=new hn(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new MC(this),this.indexManager=new gC,this.remoteDocumentCache=function(i){return new SC(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new Lg(n),this.$r=new TC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new bC,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new AC(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){C("MemoryPersistence","Starting transaction:",e);let i=new RC(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return y.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},RC=class extends bg{constructor(e){super(),this.currentSequenceNumber=e}},Kg=class t{constructor(e){this.persistence=e,this.zr=new ld,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw F()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),y.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),y.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),y.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return y.forEach(this.Jr,r=>{let i=S.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,H.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return y.or([()=>y.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var NC=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new Ag("createOrUpgrade",n);r<1&&i>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qP,{unique:!0}),c.createObjectStore("documentMutations")}(e),Ak(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=y.resolve();return r<3&&i>=3&&(r!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),Ak(e)),o=o.next(()=>function(c){let u=c.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:H.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").W().next(l=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",qP,{unique:!0});let d=u.store("mutations"),h=l.map(f=>d.put(f));return y.waitFor(h)})}(e,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(c){let u=c.createObjectStore("documentOverlays",{keyPath:uW});u.createIndex("collectionPathOverlayIndex",lW,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",dW,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(c){let u=c.createObjectStore("remoteDocumentsV14",{keyPath:X3});u.createIndex("documentKeyIndex",J3),u.createIndex("collectionGroupIndex",eW)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:sW}).createIndex("sequenceNumberIndex",oW,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:aW}).createIndex("documentKeyIndex",cW,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=qg(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>y.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>y.forEach(a,c=>{q(c.userId===s.userId);let u=ro(this.serializer,c);return jO(e,s.userId,u).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let c=new ye(o),u=function(d){return[0,Kt(d)]}(c);s.push(n.get(u).next(l=>l?y.resolve():(d=>n.put({targetId:0,path:Kt(d),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>y.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:iW});let r=n.store("collectionParents"),i=new ud,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Kt(c)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let c=new ye(o);return s(c.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,c],u)=>{let l=Tr(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=Hl(i),o=FO(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),c=function(d){return d.document?new S(ye.fromString(d.document.name).popFirst(5)):d.noDocument?S.fromSegments(d.noDocument.path):d.unknownDocument?S.fromSegments(d.unknownDocument.path):F()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(u))}).next(()=>y.waitFor(i))}si(e,n){let r=n.store("mutations"),i=$O(this.serializer),s=new Wg(Kg.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(c=>{var u;let l=(u=a.get(c.userId))!==null&&u!==void 0?u:te();ro(this.serializer,c).keys().forEach(d=>l=l.add(d)),a.set(c.userId,l)}),y.forEach(a,(c,u)=>{let l=new at(u),d=Ug.lt(this.serializer,l),h=s.getIndexManager(l),f=Hg.lt(l,this.serializer,h,s.referenceDelegate);return new zg(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new Xl(n,hn._e),c).next()})})}};function Ak(t){t.createObjectStore("targetDocuments",{keyPath:nW}).createIndex("documentTargetsIndex",rW,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",tW,{unique:!0}),t.createObjectStore("targetGlobal")}var CI="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",PC=class t{constructor(e,n,r,i,s,o,a,c,u,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=u,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new I(v.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new EC(this,i),this.Ti=n+"main",this.serializer=new Lg(c),this.Ei=new ii(this.Ti,this.ui,new NC(this.serializer)),this.Qr=new yC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=$O(this.serializer),this.$r=new cC,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&Ze("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new I(v.FAILED_PRECONDITION,CI);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new hn(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>_(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(n=>_(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>_(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>gg(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(ss(e))return C("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return C("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return $l(e).get("owner").next(n=>y.resolve(this.Si(n)))}bi(e){return gg(e).delete(this.clientId)}Di(){return _(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=Dt(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return y.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?y.resolve(!0):$l(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new I(v.FAILED_PRECONDITION,CI);return!1}}return!(!this.networkEnabled||!this.inForeground)||gg(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&C("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return _(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new Xl(e,hn._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Bi()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>gg(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return Hg.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new mC(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ug.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){C("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(c){return c===15?fW:c===14?Qk:c===13?Kk:c===12?hW:c===11?Wk:void F()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new Xl(a,this.kr?this.kr.next():hn._e),n==="readwrite-primary"?this.gi(o).next(c=>!!c||this.pi(o)).next(c=>{if(!c)throw Ze(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new I(v.FAILED_PRECONDITION,Hk);return r(o)}).next(c=>this.wi(o).next(()=>c)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return $l(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new I(v.FAILED_PRECONDITION,CI)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return $l(e).put("owner",n)}static D(){return ii.D()}yi(e){let n=$l(e);return n.get("owner").next(r=>this.Si(r)?(C("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):y.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(Ze(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;Ry()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return C("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ze("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){Ze("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function $l(t){return Dt(t,"owner")}function gg(t){return Dt(t,"clientMetadata")}function P0(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var kC=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=te(),i=te();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var OC=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Qg=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return Ry()?8:ii.v(Qc())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new OC;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(Za()<=_n.DEBUG&&C("QueryEngine","SDK will not create cache indexes for query:",Xa(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),y.resolve()):(Za()<=_n.DEBUG&&C("QueryEngine","Query:",Xa(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(Za()<=_n.DEBUG&&C("QueryEngine","The SDK decides to create cache indexes for query:",Xa(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qt(n))):y.resolve())}ji(e,n){if(ek(n))return y.resolve(null);let r=Qt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=kg(n,null,"F"),r=Qt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=te(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.Zi(n,a);return this.Xi(n,u,o,c.readTime)?this.ji(e,kg(n,null,"F")):this.es(e,u,n,c)}))})))}Hi(e,n,r,i){return ek(n)||i.isEqual(H.min())?y.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?y.resolve(null):(Za()<=_n.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Xa(n)),this.es(e,o,n,$k(i,-1)).next(a=>a))})}Zi(e,n){let r=new xe(cO(e));return n.forEach((i,s)=>{Id(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return Za()<=_n.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",Xa(n)),this.zi.getDocumentsMatchingQuery(e,n,kn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var FC=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new Fe(J),this.rs=new Nr(s=>ho(s),wd),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zg(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function qO(t,e,n,r){return new FC(t,e,n,r)}function HO(t,e){return _(this,null,function*(){let n=R(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=te();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return n.localDocuments.getDocuments(r,c).next(u=>({us:u,removedBatchIds:o,addedBatchIds:a}))})})})}function zW(t,e){let n=R(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,c,u,l){let d=u.batch,h=d.keys(),f=y.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(c,p)).next(g=>{let m=u.docVersions.get(p);q(m!==null),g.version.compareTo(m)<0&&(d.applyToRemoteDocument(g,u),g.isValidDocument()&&(g.setReadTime(u.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let c=te();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(c=c.add(a.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function GO(t){let e=R(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function WW(t,e){let n=R(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(Ct.EMPTY_BYTE_STRING,H.min()).withLastLimboFreeSnapshotVersion(H.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,m,w){return g.resumeToken.approximateByteSize()===0||m.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let c=on(),u=te();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(zO(s,o,e.documentUpdates).next(l=>{c=l.cs,u=l.ls})),!r.isEqual(H.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return y.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(n.ns=i,s))}function zO(t,e,n){let r=te(),i=te();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=on();return n.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(H.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):C("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{cs:o,ls:i}})}function KW(t,e){let n=R(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function gc(t,e){let n=R(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,y.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new fc(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function mc(t,e,n){return _(this,null,function*(){let r=R(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ss(o))throw o;C("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function Yg(t,e,n){let r=R(t),i=H.min(),s=te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,l){let d=R(c),h=d.rs.get(l);return h!==void 0?y.resolve(d.ns.get(h)):d.Qr.getTargetData(u,l)}(r,o,Qt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:H.min(),n?s:te())).next(a=>(QO(r,aO(e),a),{documents:a,hs:s})))}function WO(t,e){let n=R(t),r=R(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function KO(t,e){let n=R(t),r=n.ss.get(e)||H.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,$k(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(QO(n,e,i),i))}function QO(t,e,n){let r=t.ss.get(e)||H.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function QW(t,e,n,r){return _(this,null,function*(){let i=R(t),s=te(),o=on();for(let u of n){let l=e.Ps(u.metadata.name);u.document&&(s=s.add(l));let d=e.Is(u);d.setReadTime(e.Ts(u.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),c=yield gc(i,function(l){return Qt(Cc(ye.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>zO(u,a,o).next(l=>(a.apply(u),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Qr.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,l.cs,l.ls)).next(()=>l.cs)))})}function YW(r,i){return _(this,arguments,function*(t,e,n=te()){let s=yield gc(t,Qt(R0(e.bundledQuery))),o=R(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Je(e.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.$r.saveNamedQuery(a,e);let u=s.withResumeToken(Ct.EMPTY_BYTE_STRING,c);return o.ns=o.ns.insert(u.targetId,u),o.Qr.updateTargetData(a,u).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function Sk(t,e){return`firestore_clients_${t}_${e}`}function xk(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function DI(t,e){return`firestore_targets_${t}_${e}`}var Zg=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new I(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(Ze("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Kl=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new I(r.error.code,r.error.message))),s?new t(e,r.state,i):(Ze("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Xg=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=x0();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=Gk(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(Ze("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},VC=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(Ze("SharedClientState",`Failed to parse online state: ${e}`),null)}},dd=class{constructor(){this.activeTargetIds=x0()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Ql=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Fe(J),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=Sk(this.persistenceKey,this.Vs),this.Ss=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new dd),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Fs=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return _(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(Sk(this.persistenceKey,r));if(i){let s=Xg.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,n,r){this.Bs(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(DI(this.persistenceKey,e));if(r){let i=Kl.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(DI(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return C("SharedClientState","READ",e,n),n}setItem(e,n){C("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){C("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(C("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void Ze("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>_(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=hn._e;if(s!=null)try{let a=JSON.parse(s);q(typeof a=="number"),o=a}catch(a){Ze("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==hn._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,n,r){let i=new Zg(this.currentUser,e,n,r),s=xk(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Ls(e){let n=xk(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=DI(this.persistenceKey,e),s=new Kl(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return Xg.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Zg.Es(new at(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return Kl.Es(i,n)}xs(e){return VC.Es(e)}Js(e){return JSON.parse(e)}zs(e){return _(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);C("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=x0();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},Jg=class{constructor(){this.no=new dd,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new dd,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var LC=class{io(e){}shutdown(){}};var em=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){C("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){C("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var mg=null;function TI(){return mg===null?mg=function(){return 268435456+Math.round(2147483648*Math.random())}():mg++,"0x"+mg.toString(16)}var ZW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var jC=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var Lt="WebChannelConnection",UC=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=TI(),c=this.bo(n,r.toUriEncodedString());C("RestConnection",`Sending RPC '${n}' ${a}:`,c,i);let u={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(u,s,o),this.Co(n,c,u,i).then(l=>(C("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw Pn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",c,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ic}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=ZW[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=TI();return new Promise((o,a)=>{let c=new LP;c.setWithCredentials(!0),c.listenOnce(FP.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case hg.NO_ERROR:let l=c.getResponseJson();C(Lt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case hg.TIMEOUT:C(Lt,`RPC '${e}' ${s} timed out`),a(new I(v.DEADLINE_EXCEEDED,"Request time out"));break;case hg.HTTP_ERROR:let d=c.getStatus();if(C(Lt,`RPC '${e}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let h=c.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(m){let w=m.toLowerCase().replace(/_/g,"-");return Object.values(v).indexOf(w)>=0?w:v.UNKNOWN}(f.status);a(new I(p,f.message))}else a(new I(v.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new I(v.UNAVAILABLE,"Connection failed."));break;default:F()}}finally{C(Lt,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);C(Lt,`RPC '${e}' ${s} sending request:`,i),c.send(n,"POST",u,r,15)})}Fo(e,n,r){let i=TI(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=kP(),a=OP(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;let l=s.join("");C(Lt,`Creating RPC '${e}' stream ${i}: ${l}`,c);let d=o.createWebChannel(l,c),h=!1,f=!1,p=new jC({lo:m=>{f?C(Lt,`Not sending because RPC '${e}' stream ${i} is closed:`,m):(h||(C(Lt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),C(Lt,`RPC '${e}' stream ${i} sending:`,m),d.send(m))},ho:()=>d.close()}),g=(m,w,P)=>{m.listen(w,T=>{try{P(T)}catch(V){setTimeout(()=>{throw V},0)}})};return g(d,Ll.EventType.OPEN,()=>{f||C(Lt,`RPC '${e}' stream ${i} transport opened.`)}),g(d,Ll.EventType.CLOSE,()=>{f||(f=!0,C(Lt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,Ll.EventType.ERROR,m=>{f||(f=!0,Pn(Lt,`RPC '${e}' stream ${i} transport errored:`,m),p.Vo(new I(v.UNAVAILABLE,"The operation could not be completed")))}),g(d,Ll.EventType.MESSAGE,m=>{var w;if(!f){let P=m.data[0];q(!!P);let T=P,V=T.error||((w=T[0])===null||w===void 0?void 0:w.error);if(V){C(Lt,`RPC '${e}' stream ${i} received error:`,V);let G=V.status,W=function(Ay){let ah=st[Ay];if(ah!==void 0)return IO(ah)}(G),Ee=V.message;W===void 0&&(W=v.INTERNAL,Ee="Unknown error status: "+G+" with message "+V.message),f=!0,p.Vo(new I(W,Ee)),d.close()}else C(Lt,`RPC '${e}' stream ${i} received:`,P),p.mo(P)}}),g(a,VP.STAT_EVENT,m=>{m.stat===EI.PROXY?C(Lt,`RPC '${e}' stream ${i} detected buffering proxy`):m.stat===EI.NOPROXY&&C(Lt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function YO(){return typeof window<"u"?window:null}function Eg(){return typeof document<"u"?document:null}function Cd(t){return new rC(t,!0)}var hd=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&C("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var tm=class{constructor(e,n,r,i,s,o,a,c){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new hd(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return _(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return _(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return _(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===v.RESOURCE_EXHAUSTED?(Ze(n.toString()),Ze("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===v.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new I(v.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>_(this,null,function*(){this.state=0,this.start()}))}__(e){return C("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(C("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},BC=class extends tm{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=OW(this.serializer,e),r=function(s){if(!("targetChange"in s))return H.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?H.min():o.readTime?Je(o.readTime):H.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=oC(this.serializer),n.addTarget=function(s,o){let a,c=o.target;if(a=Ng(c)?{documents:MO(s,c)}:{query:RO(s,c).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=DO(s,o.resumeToken);let u=iC(s,o.expectedCount);u!==null&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(H.min())>0){a.readTime=hc(s,o.snapshotVersion.toTimestamp());let u=iC(s,o.expectedCount);u!==null&&(a.expectedCount=u)}return a}(this.serializer,e);let r=VW(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=oC(this.serializer),n.removeTarget=e,this.t_(n)}},$C=class extends tm{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(q(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=FW(e.writeResults,e.commitTime),r=Je(e.commitTime);return this.listener.T_(r,n)}return q(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=oC(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>cd(this.serializer,r))};this.t_(n)}};var qC=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new I(v.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,sC(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new I(v.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,sC(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===v.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new I(v.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var HC=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(Ze(n),this.g_=!1):C("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var GC=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>_(this,null,function*(){os(this)&&(C("RemoteStore","Restarting streams for network reachability change."),yield function(c){return _(this,null,function*(){let u=R(c);u.v_.add(4),yield Dc(u),u.x_.set("Unknown"),u.v_.delete(4),yield Dd(u)})}(this))}))}),this.x_=new HC(r,i)}};function Dd(t){return _(this,null,function*(){if(os(t))for(let e of t.F_)yield e(!0)})}function Dc(t){return _(this,null,function*(){for(let e of t.F_)yield e(!1)})}function wm(t,e){let n=R(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),F0(n)?O0(n):bc(n).Jo()&&k0(n,e))}function fd(t,e){let n=R(t),r=bc(n);n.C_.delete(e),r.Jo()&&ZO(n,e),n.C_.size===0&&(r.Jo()?r.Xo():os(n)&&n.x_.set("Unknown"))}function k0(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(H.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}bc(t).c_(e)}function ZO(t,e){t.O_.Oe(e),bc(t).l_(e)}function O0(t){t.O_=new nC({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),bc(t).start(),t.x_.p_()}function F0(t){return os(t)&&!bc(t).Ho()&&t.C_.size>0}function os(t){return R(t).v_.size===0}function XO(t){t.O_=void 0}function XW(t){return _(this,null,function*(){t.C_.forEach((e,n)=>{k0(t,e)})})}function JW(t,e){return _(this,null,function*(){XO(t),F0(t)?(t.x_.S_(e),O0(t)):t.x_.set("Unknown")})}function e9(t,e,n){return _(this,null,function*(){if(t.x_.set("Online"),e instanceof Fg&&e.state===2&&e.cause)try{yield function(i,s){return _(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){C("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield nm(t,r)}else if(e instanceof sc?t.O_.$e(e):e instanceof Og?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(H.min()))try{let r=yield GO(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){let l=s.C_.get(u);l&&s.C_.set(u,l.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,u)=>{let l=s.C_.get(c);if(!l)return;s.C_.set(c,l.withResumeToken(Ct.EMPTY_BYTE_STRING,l.snapshotVersion)),ZO(s,c);let d=new fc(l.target,c,u,l.sequenceNumber);k0(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){C("RemoteStore","Failed to raise snapshot:",r),yield nm(t,r)}})}function nm(t,e,n){return _(this,null,function*(){if(!ss(e))throw e;t.v_.add(1),yield Dc(t),t.x_.set("Offline"),n||(n=()=>GO(t.localStore)),t.asyncQueue.enqueueRetryable(()=>_(this,null,function*(){C("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Dd(t)}))})}function JO(t,e){return e().catch(n=>nm(t,n,e))}function Tc(t){return _(this,null,function*(){let e=R(t),n=rs(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;t9(e);)try{let i=yield KW(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,n9(e,i)}catch(i){yield nm(e,i)}e1(e)&&t1(e)})}function t9(t){return os(t)&&t.D_.length<10}function n9(t,e){t.D_.push(e);let n=rs(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function e1(t){return os(t)&&!rs(t).Ho()&&t.D_.length>0}function t1(t){rs(t).start()}function r9(t){return _(this,null,function*(){rs(t).d_()})}function i9(t){return _(this,null,function*(){let e=rs(t);for(let n of t.D_)e.I_(n.mutations)})}function s9(t,e,n){return _(this,null,function*(){let r=t.D_.shift(),i=JI.from(r,e,n);yield JO(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield Tc(t)})}function o9(t,e){return _(this,null,function*(){e&&rs(t).P_&&(yield function(r,i){return _(this,null,function*(){if(function(o){return EO(o)&&o!==v.ABORTED}(i.code)){let s=r.D_.shift();rs(r).Zo(),yield JO(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Tc(r)}})}(t,e)),e1(t)&&t1(t)})}function Mk(t,e){return _(this,null,function*(){let n=R(t);n.asyncQueue.verifyOperationInProgress(),C("RemoteStore","RemoteStore received new credentials");let r=os(n);n.v_.add(3),yield Dc(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Dd(n)})}function zC(t,e){return _(this,null,function*(){let n=R(t);e?(n.v_.delete(2),yield Dd(n)):e||(n.v_.add(2),yield Dc(n),n.x_.set("Unknown"))})}function bc(t){return t.N_||(t.N_=function(n,r,i){let s=R(n);return s.R_(),new BC(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:XW.bind(null,t),To:JW.bind(null,t),u_:e9.bind(null,t)}),t.F_.push(e=>_(this,null,function*(){e?(t.N_.Zo(),F0(t)?O0(t):t.x_.set("Unknown")):(yield t.N_.stop(),XO(t))}))),t.N_}function rs(t){return t.B_||(t.B_=function(n,r,i){let s=R(n);return s.R_(),new $C(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:r9.bind(null,t),To:o9.bind(null,t),E_:i9.bind(null,t),T_:s9.bind(null,t)}),t.F_.push(e=>_(this,null,function*(){e?(t.B_.Zo(),yield Tc(t)):(yield t.B_.stop(),t.D_.length>0&&(C("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}var WC=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new ct,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new I(v.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ac(t,e){if(Ze("AsyncQueue",`${e}: ${t}`),ss(t))return new I(v.UNAVAILABLE,`${e}: ${t}`);throw t}var rm=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||S.comparator(n.key,r.key):(n,r)=>S.comparator(n.key,r.key),this.keyedMap=ql(),this.sortedSet=new Fe(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var im=class{constructor(){this.L_=new Fe(S.comparator)}track(e){let n=e.doc.key,r=this.L_.get(n);r?e.type!==0&&r.type===3?this.L_=this.L_.insert(n,e):e.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.L_=this.L_.remove(n):e.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):F():this.L_=this.L_.insert(n,e)}k_(){let e=[];return this.L_.inorderTraversal((n,r)=>{e.push(r)}),e}},yc=class t{constructor(e,n,r,i,s,o,a,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,rm.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ed(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var KC=class{constructor(){this.q_=void 0,this.Q_=[]}},QC=class{constructor(){this.queries=new Nr(e=>oO(e),Ed),this.onlineState="Unknown",this.K_=new Set}};function V0(t,e){return _(this,null,function*(){let n=R(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new KC),i)try{s.q_=yield n.onListen(r)}catch(o){let a=Ac(o,`Initialization of query '${Xa(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&j0(n)})}function L0(t,e){return _(this,null,function*(){let n=R(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),i=s.Q_.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function a9(t,e){let n=R(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.W_(i)&&(r=!0);o.q_=i}}r&&j0(n)}function c9(t,e,n){let r=R(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function j0(t){t.K_.forEach(e=>{e.next()})}var pd=class{constructor(e,n,r){this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new yc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.z_?this.H_(e)&&(this.G_.next(e),n=!0):this.J_(e,this.onlineState)&&(this.Y_(e),n=!0),this.j_=e,n}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),n=!0),n}J_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.Z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}H_(e){if(e.docChanges.length>0)return!0;let n=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(e){e=yc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}};var YC=class{constructor(e,n){this.X_=e,this.byteLength=n}ea(){return"metadata"in this.X_}};var sm=class{constructor(e){this.serializer=e}Ps(e){return Sr(this.serializer,e)}Is(e){return e.metadata.exists?xO(this.serializer,e.document,!1):ut.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Je(e)}},ZC=class{constructor(e,n,r){this.ta=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=n1(e)}na(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.X_.namedQuery)this.queries.push(e.X_.namedQuery);else if(e.X_.documentMetadata){this.documents.push({metadata:e.X_.documentMetadata}),e.X_.documentMetadata.exists||++n;let r=ye.fromString(e.X_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.X_.document&&(this.documents[this.documents.length-1].document=e.X_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ra(e){let n=new Map,r=new sm(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||te()).add(s);n.set(o,a)}}return n}complete(){return _(this,null,function*(){let e=yield QW(this.localStore,new sm(this.serializer),this.documents,this.ta.id),n=this.ra(this.documents);for(let r of this.queries)yield YW(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ia:this.collectionGroups,sa:e}})}};function n1(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var om=class{constructor(e){this.key=e}},am=class{constructor(e){this.key=e}},cm=class{constructor(e,n){this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=te(),this.mutatedKeys=te(),this.ua=cO(e),this.ca=new rm(this.ua)}get la(){return this.oa}ha(e,n){let r=n?n.Pa:new im,i=n?n.ca:this.ca,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=Id(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),m=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),m=!0):this.Ia(h,f)||(r.track({type:2,doc:f}),m=!0,(c&&this.ua(f,c)>0||u&&this.ua(f,u)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),m=!0):h&&!f&&(r.track({type:1,doc:h}),m=!0,(c||u)&&(a=!0)),m&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{ca:o,Pa:r,Xi:a,mutatedKeys:s}}Ia(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;let o=e.Pa.k_();o.sort((l,d)=>function(f,p){let g=m=>{switch(m){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return F()}};return g(f)-g(p)}(l.type,d.type)||this.ua(l.doc,d.doc)),this.Ta(r),i=i!=null&&i;let a=n&&!i?this.Ea():[],c=this.aa.size===0&&this.current&&!i?1:0,u=c!==this._a;return this._a=c,o.length!==0||u?{snapshot:new yc(this.query,e.ca,s,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new im,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=e.current)}Ea(){if(!this.current)return[];let e=this.aa;this.aa=te(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});let n=[];return e.forEach(r=>{this.aa.has(r)||n.push(new am(r))}),this.aa.forEach(r=>{e.has(r)||n.push(new om(r))}),n}Ra(e){this.oa=e.hs,this.aa=te();let n=this.ha(e.documents);return this.applyChanges(n,!0)}Va(){return yc.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}},XC=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},JC=class{constructor(e){this.key=e,this.ma=!1}},e0=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new Nr(a=>oO(a),Ed),this.pa=new Map,this.ya=new Set,this.wa=new Fe(S.comparator),this.Sa=new Map,this.ba=new ld,this.Da={},this.Ca=new Map,this.va=pc.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}};function u9(t,e){return _(this,null,function*(){let n=H0(t),r,i,s=n.ga.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{let o=yield gc(n.localStore,Qt(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield U0(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&wm(n.remoteStore,o)}return i})}function U0(t,e,n,r,i){return _(this,null,function*(){t.Ma=(d,h,f)=>function(g,m,w,P){return _(this,null,function*(){let T=m.view.ha(w);T.Xi&&(T=yield Yg(g.localStore,m.query,!1).then(({documents:Ee})=>m.view.ha(Ee,T)));let V=P&&P.targetChanges.get(m.targetId),G=P&&P.targetMismatches.get(m.targetId)!=null,W=m.view.applyChanges(T,g.isPrimaryClient,V,G);return t0(g,m.targetId,W.da),W.snapshot})}(t,d,h,f);let s=yield Yg(t.localStore,e,!0),o=new cm(e,s.hs),a=o.ha(s.documents),c=od.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),u=o.applyChanges(a,t.isPrimaryClient,c);t0(t,n,u.da);let l=new XC(e,n,o);return t.ga.set(e,l),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),u.snapshot})}function l9(t,e){return _(this,null,function*(){let n=R(t),r=n.ga.get(e),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter(s=>!Ed(s,e))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield mc(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),fd(n.remoteStore,r.targetId),vc(n,r.targetId)}).catch(is))):(vc(n,r.targetId),yield mc(n.localStore,r.targetId,!0))})}function d9(t,e,n){return _(this,null,function*(){let r=G0(t);try{let i=yield function(o,a){let c=R(o),u=$e.now(),l=a.reduce((f,p)=>f.add(p.key),te()),d,h;return c.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=on(),g=te();return c.os.getEntries(f,l).next(m=>{p=m,p.forEach((w,P)=>{P.isValidDocument()||(g=g.add(w))})}).next(()=>c.localDocuments.getOverlayedDocuments(f,p)).next(m=>{d=m;let w=[];for(let P of a){let T=SW(P,d.get(P.key).overlayedDocument);T!=null&&w.push(new nr(P.key,T,Jk(T.value.mapValue),ze.exists(!0)))}return c.mutationQueue.addMutationBatch(f,u,w,a)}).next(m=>{h=m;let w=m.applyToLocalDocumentSet(d,g);return c.documentOverlayCache.saveOverlays(f,m.batchId,w)})}).then(()=>({batchId:h.batchId,changes:lO(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,c){let u=o.Da[o.currentUser.toKey()];u||(u=new Fe(J)),u=u.insert(a,c),o.Da[o.currentUser.toKey()]=u}(r,i.batchId,n),yield ui(r,i.changes),yield Tc(r.remoteStore)}catch(i){let s=Ac(i,"Failed to persist write");n.reject(s)}})}function r1(t,e){return _(this,null,function*(){let n=R(t);try{let r=yield WW(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Sa.get(s);o&&(q(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ma=!0:i.modifiedDocuments.size>0?q(o.ma):i.removedDocuments.size>0&&(q(o.ma),o.ma=!1))}),yield ui(n,r,e)}catch(r){yield is(r)}})}function Rk(t,e,n){let r=R(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ga.forEach((s,o)=>{let a=o.view.U_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let c=R(o);c.onlineState=a;let u=!1;c.queries.forEach((l,d)=>{for(let h of d.Q_)h.U_(a)&&(u=!0)}),u&&j0(c)}(r.eventManager,e),i.length&&r.fa.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function h9(t,e,n){return _(this,null,function*(){let r=R(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Sa.get(e),s=i&&i.key;if(s){let o=new Fe(S.comparator);o=o.insert(s,ut.newNoDocument(s,H.min()));let a=te().add(s),c=new sd(H.min(),new Map,new Fe(J),o,a);yield r1(r,c),r.wa=r.wa.remove(s),r.Sa.delete(e),q0(r)}else yield mc(r.localStore,e,!1).then(()=>vc(r,e,n)).catch(is)})}function f9(t,e){return _(this,null,function*(){let n=R(t),r=e.batch.batchId;try{let i=yield zW(n.localStore,e);$0(n,r,null),B0(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield ui(n,i)}catch(i){yield is(i)}})}function p9(t,e,n){return _(this,null,function*(){let r=R(t);try{let i=yield function(o,a){let c=R(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let l;return c.mutationQueue.lookupMutationBatch(u,a).next(d=>(q(d!==null),l=d.keys(),c.mutationQueue.removeMutationBatch(u,d))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,l,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,l)).next(()=>c.localDocuments.getDocuments(u,l))})}(r.localStore,e);$0(r,e,n),B0(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield ui(r,i)}catch(i){yield is(i)}})}function g9(t,e){return _(this,null,function*(){let n=R(t);os(n.remoteStore)||C("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=R(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ca.get(r)||[];i.push(e),n.Ca.set(r,i)}catch(r){let i=Ac(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function B0(t,e){(t.Ca.get(e)||[]).forEach(n=>{n.resolve()}),t.Ca.delete(e)}function $0(t,e,n){let r=R(t),i=r.Da[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}function vc(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.pa.get(e))t.ga.delete(r),n&&t.fa.xa(r,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach(r=>{t.ba.containsKey(r)||i1(t,r)})}function i1(t,e){t.ya.delete(e.path.canonicalString());let n=t.wa.get(e);n!==null&&(fd(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),q0(t))}function t0(t,e,n){for(let r of n)r instanceof om?(t.ba.addReference(r.key,e),m9(t,r)):r instanceof am?(C("SyncEngine","Document no longer in limbo: "+r.key),t.ba.removeReference(r.key,e),t.ba.containsKey(r.key)||i1(t,r.key)):F()}function m9(t,e){let n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(C("SyncEngine","New document in limbo: "+n),t.ya.add(r),q0(t))}function q0(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){let e=t.ya.values().next().value;t.ya.delete(e);let n=new S(ye.fromString(e)),r=t.va.next();t.Sa.set(r,new JC(n)),t.wa=t.wa.insert(n,r),wm(t.remoteStore,new fc(Qt(Cc(n.path)),r,"TargetPurposeLimboResolution",hn._e))}}function ui(t,e,n){return _(this,null,function*(){let r=R(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,c)=>{o.push(r.Ma(c,e,n).then(u=>{if((u||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=kC.Ki(c.targetId,u);s.push(l)}}))}),yield Promise.all(o),r.fa.u_(i),yield function(c,u){return _(this,null,function*(){let l=R(c);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>y.forEach(u,h=>y.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>y.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!ss(d))throw d;C("LocalStore","Failed to update sequence numbers: "+d)}for(let d of u){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,g)}}})}(r.localStore,s))})}function y9(t,e){return _(this,null,function*(){let n=R(t);if(!n.currentUser.isEqual(e)){C("SyncEngine","User change. New user:",e.toKey());let r=yield HO(n.localStore,e);n.currentUser=e,function(s,o){s.Ca.forEach(a=>{a.forEach(c=>{c.reject(new I(v.CANCELLED,o))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield ui(n,r.us)}})}function v9(t,e){let n=R(t),r=n.Sa.get(e);if(r&&r.ma)return te().add(r.key);{let i=te(),s=n.pa.get(e);if(!s)return i;for(let o of s){let a=n.ga.get(o);i=i.unionWith(a.view.la)}return i}}function _9(t,e){return _(this,null,function*(){let n=R(t),r=yield Yg(n.localStore,e.query,!0),i=e.view.Ra(r);return n.isPrimaryClient&&t0(n,e.targetId,i.da),i})}function w9(t,e){return _(this,null,function*(){let n=R(t);return KO(n.localStore,e).then(r=>ui(n,r))})}function E9(t,e,n,r){return _(this,null,function*(){let i=R(t),s=yield function(a,c){let u=R(a),l=R(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,c).next(h=>h?u.localDocuments.getDocuments(d,h):y.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield Tc(i.remoteStore):n==="acknowledged"||n==="rejected"?($0(i,e,r||null),B0(i,e),function(a,c){R(R(a).mutationQueue).Mn(c)}(i.localStore,e)):F(),yield ui(i,s)):C("SyncEngine","Cannot apply mutation batch with id: "+e)})}function I9(t,e){return _(this,null,function*(){let n=R(t);if(H0(n),G0(n),e===!0&&n.Fa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield Nk(n,r.toArray());n.Fa=!0,yield zC(n.remoteStore,!0);for(let s of i)wm(n.remoteStore,s)}else if(e===!1&&n.Fa!==!1){let r=[],i=Promise.resolve();n.pa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(vc(n,o),mc(n.localStore,o,!0))),fd(n.remoteStore,o)}),yield i,yield Nk(n,r),function(o){let a=R(o);a.Sa.forEach((c,u)=>{fd(a.remoteStore,u)}),a.ba.mr(),a.Sa=new Map,a.wa=new Fe(S.comparator)}(n),n.Fa=!1,yield zC(n.remoteStore,!1)}})}function Nk(t,e,n){return _(this,null,function*(){let r=R(t),i=[],s=[];for(let o of e){let a,c=r.pa.get(o);if(c&&c.length!==0){a=yield gc(r.localStore,Qt(c[0]));for(let u of c){let l=r.ga.get(u),d=yield _9(r,l);d.snapshot&&s.push(d.snapshot)}}else{let u=yield WO(r.localStore,o);a=yield gc(r.localStore,u),yield U0(r,s1(u),o,!1,a.resumeToken)}i.push(a)}return r.fa.u_(s),i})}function s1(t){return sO(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function C9(t){return function(n){return R(R(n).persistence).Li()}(R(t).localStore)}function D9(t,e,n,r){return _(this,null,function*(){let i=R(t);if(i.Fa)return void C("SyncEngine","Ignoring unexpected query state notification.");let s=i.pa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield KO(i.localStore,aO(s[0])),a=sd.createSynthesizedRemoteEventForCurrentChange(e,n==="current",Ct.EMPTY_BYTE_STRING);yield ui(i,o,a);break}case"rejected":yield mc(i.localStore,e,!0),vc(i,e,r);break;default:F()}})}function T9(t,e,n){return _(this,null,function*(){let r=H0(t);if(r.Fa){for(let i of e){if(r.pa.has(i)){C("SyncEngine","Adding an already active target "+i);continue}let s=yield WO(r.localStore,i),o=yield gc(r.localStore,s);yield U0(r,s1(s),o.targetId,!1,o.resumeToken),wm(r.remoteStore,o)}for(let i of n)r.pa.has(i)&&(yield mc(r.localStore,i,!1).then(()=>{fd(r.remoteStore,i),vc(r,i)}).catch(is))}})}function H0(t){let e=R(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=r1.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=v9.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=h9.bind(null,e),e.fa.u_=a9.bind(null,e.eventManager),e.fa.xa=c9.bind(null,e.eventManager),e}function G0(t){let e=R(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=f9.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=p9.bind(null,e),e}function b9(t,e,n){let r=R(t);(function(s,o,a){return _(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(f,p){let g=R(f),m=Je(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",w=>g.$r.getBundleMetadata(w,p.id)).then(w=>!!w&&w.createTime.compareTo(m)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(n1(c));let u=new ZC(c,s.localStore,o.serializer),l=yield o.Oa();for(;l;){let h=yield u.na(l);h&&a._updateProgress(h),l=yield o.Oa()}let d=yield u.complete();return yield ui(s,d.sa,void 0),yield function(f,p){let g=R(f);return g.persistence.runTransaction("Save bundle","readwrite",m=>g.$r.saveBundleMetadata(m,p))}(s.localStore,c),a._completeWith(d.progress),Promise.resolve(d.ia)}catch(c){return Pn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var gd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){this.serializer=Cd(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return qO(this.persistence,new Qg,e.initialUser,this.serializer)}createPersistence(e){return new Wg(Kg.Hr,this.serializer)}createSharedClientState(e){return new Jg}terminate(){return _(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var um=class t extends gd{constructor(e,n,r){super(),this.Na=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return _(this,null,function*(){yield xy(t.prototype,this,"initialize").call(this,e),yield this.Na.initialize(this,e),yield G0(this.Na.syncEngine),yield Tc(this.Na.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return qO(this.persistence,new Qg,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new _C(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new VI(n,this.persistence);return new FI(e.asyncQueue,r)}createPersistence(e){let n=P0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new PC(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,YO(),Eg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Jg}},n0=class t extends um{constructor(e,n){super(e,n,!1),this.Na=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return _(this,null,function*(){yield xy(t.prototype,this,"initialize").call(this,e);let n=this.Na.syncEngine;this.sharedClientState instanceof Ql&&(this.sharedClientState.syncEngine={Zs:E9.bind(null,n),Xs:D9.bind(null,n),eo:T9.bind(null,n),Li:C9.bind(null,n),Ys:w9.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>_(this,null,function*(){yield I9(this.Na.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=YO();if(!Ql.D(n))throw new I(v.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=P0(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ql(n,e.asyncQueue,r,e.clientId,e.initialUser)}},md=class{initialize(e,n){return _(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Rk(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=y9.bind(null,this.syncEngine),yield zC(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new QC}()}createDatastore(e){let n=Cd(e.databaseInfo.databaseId),r=function(s){return new UC(s)}(e.databaseInfo);return function(s,o,a,c){return new qC(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new GC(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Rk(this.syncEngine,n,0),function(){return em.D()?new em:new LC}())}createSyncEngine(e,n){return function(i,s,o,a,c,u,l){let d=new e0(i,s,o,a,c,u);return l&&(d.Fa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return _(this,null,function*(){var e;yield function(r){return _(this,null,function*(){let i=R(r);C("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield Dc(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function Pk(t,e=10240){let n=0;return{read(){return _(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return _(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var _c=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):Ze("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var r0=class{constructor(e,n){this.ka=e,this.serializer=n,this.metadata=new ct,this.buffer=new Uint8Array,this.qa=function(){return new TextDecoder("utf-8")}(),this.Qa().then(r=>{r&&r.ea()?this.metadata.resolve(r.X_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.X_)}`))},r=>this.metadata.reject(r))}close(){return this.ka.cancel()}getMetadata(){return _(this,null,function*(){return this.metadata.promise})}Oa(){return _(this,null,function*(){return yield this.getMetadata(),this.Qa()})}Qa(){return _(this,null,function*(){let e=yield this.Ka();if(e===null)return null;let n=this.qa.decode(e),r=Number(n);isNaN(r)&&this.$a(`length string (${n}) is not valid number`);let i=yield this.Ua(r);return new YC(JSON.parse(i),e.length+r)})}Wa(){return this.buffer.findIndex(e=>e===123)}Ka(){return _(this,null,function*(){for(;this.Wa()<0&&!(yield this.Ga()););if(this.buffer.length===0)return null;let e=this.Wa();e<0&&this.$a("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ua(e){return _(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ga())&&this.$a("Reached the end of bundle when more is expected.");let n=this.qa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}$a(e){throw this.ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ga(){return _(this,null,function*(){let e=yield this.ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var i0=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new I(v.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return _(this,null,function*(){let o=R(i),a={documents:s.map(d=>ad(o.serializer,d))},c=yield o.vo("BatchGetDocuments",o.serializer.databaseId,ye.emptyPath(),a,s.length),u=new Map;c.forEach(d=>{let h=kW(o.serializer,d);u.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=u.get(d.toString());q(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new ns(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return _(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=S.fromPath(r);this.mutations.push(new nd(i,this.precondition(i)))}),yield function(r,i){return _(this,null,function*(){let s=R(r),o={writes:i.map(a=>cd(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,ye.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw F();n=H.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new I(v.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(H.min())?ze.exists(!1):ze.updateTime(n):ze.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(H.min()))throw new I(v.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ze.updateTime(n)}return ze.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var s0=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.za=r.maxAttempts,this.jo=new hd(this.asyncQueue,"transaction_retry")}ja(){this.za-=1,this.Ha()}Ha(){this.jo.qo(()=>_(this,null,function*(){let e=new i0(this.datastore),n=this.Ja(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Ya(i)}))}).catch(r=>{this.Ya(r)})}))}Ja(e){try{let n=this.updateFunction(e);return!_d(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Ya(e){this.za>0&&this.Za(e)?(this.za-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ha(),Promise.resolve()))):this.deferred.reject(e)}Za(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!EO(n)}return!1}};var o0=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=at.UNAUTHENTICATED,this.clientId=Dg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>_(this,null,function*(){C("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(C("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new I(v.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ct;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=Ac(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function Ig(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),C("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>_(this,null,function*(){r.isEqual(i)||(yield HO(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function a0(t,e){return _(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield z0(t);C("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Mk(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Mk(e.remoteStore,i)),t._onlineComponents=e})}function o1(t){return t.name==="FirebaseError"?t.code===v.FAILED_PRECONDITION||t.code===v.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function z0(t){return _(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){C("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Ig(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!o1(n))throw n;Pn("Error using user provided cache. Falling back to memory cache: "+n),yield Ig(t,new gd)}}else C("FirestoreClient","Using default OfflineComponentProvider"),yield Ig(t,new gd);return t._offlineComponents})}function Em(t){return _(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(C("FirestoreClient","Using user provided OnlineComponentProvider"),yield a0(t,t._uninitializedComponentsProvider._online)):(C("FirestoreClient","Using default OnlineComponentProvider"),yield a0(t,new md))),t._onlineComponents})}function a1(t){return z0(t).then(e=>e.persistence)}function W0(t){return z0(t).then(e=>e.localStore)}function c1(t){return Em(t).then(e=>e.remoteStore)}function K0(t){return Em(t).then(e=>e.syncEngine)}function A9(t){return Em(t).then(e=>e.datastore)}function wc(t){return _(this,null,function*(){let e=yield Em(t),n=e.eventManager;return n.onListen=u9.bind(null,e.syncEngine),n.onUnlisten=l9.bind(null,e.syncEngine),n})}function S9(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield a1(t),n=yield c1(t);return e.setNetworkEnabled(!0),function(i){let s=R(i);return s.v_.delete(0),Dd(s)}(n)}))}function x9(t){return t.asyncQueue.enqueue(()=>_(this,null,function*(){let e=yield a1(t),n=yield c1(t);return e.setNetworkEnabled(!1),function(i){return _(this,null,function*(){let s=R(i);s.v_.add(0),yield Dc(s),s.x_.set("Offline")})}(n)}))}function M9(t,e){let n=new ct;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield function(u,l){let d=R(u);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new I(v.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Ac(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield W0(t),e,n)})),n.promise}function u1(t,e,n={}){let r=new ct;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,c,u){let l=new _c({next:h=>{o.enqueueAndForget(()=>L0(s,d));let f=h.docs.has(a);!f&&h.fromCache?u.reject(new I(v.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&c&&c.source==="server"?u.reject(new I(v.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new pd(Cc(a.path),l,{includeMetadataChanges:!0,Z_:!0});return V0(s,d)}(yield wc(t),t.asyncQueue,e,n,r)})),r.promise}function R9(t,e){let n=new ct;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s,o){return _(this,null,function*(){try{let a=yield Yg(i,s,!0),c=new cm(s,a.hs),u=c.ha(a.documents),l=c.applyChanges(u,!1);o.resolve(l.snapshot)}catch(a){let c=Ac(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield W0(t),e,n)})),n.promise}function l1(t,e,n={}){let r=new ct;return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(s,o,a,c,u){let l=new _c({next:h=>{o.enqueueAndForget(()=>L0(s,d)),h.fromCache&&c.source==="server"?u.reject(new I(v.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(h)},error:h=>u.reject(h)}),d=new pd(a,l,{includeMetadataChanges:!0,Z_:!0});return V0(s,d)}(yield wc(t),t.asyncQueue,e,n,r)})),r.promise}function N9(t,e){let n=new _c(e);return t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){R(i).K_.add(s),s.next()}(yield wc(t),n)})),()=>{n.La(),t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return function(i,s){R(i).K_.delete(s)}(yield wc(t),n)}))}}function P9(t,e,n,r){let i=function(o,a){let c;return c=typeof o=="string"?CO().encode(o):o,function(l,d){return new r0(l,d)}(function(l,d){if(l instanceof Uint8Array)return Pk(l,d);if(l instanceof ArrayBuffer)return Pk(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(n,Cd(e));t.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){b9(yield K0(t),i,r)}))}function k9(t,e){return t.asyncQueue.enqueue(()=>_(this,null,function*(){return function(r,i){let s=R(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield W0(t),e)}))}function d1(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var kk=new Map;function Q0(t,e,n){if(!n)throw new I(v.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Y0(t,e,n,r){if(e===!0&&r===!0)throw new I(v.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Ok(t){if(!S.isDocumentKey(t))throw new I(v.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Fk(t){if(S.isDocumentKey(t))throw new I(v.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Im(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":F()}function ve(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new I(v.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=Im(t);throw new I(v.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function h1(t,e){if(e<=0)throw new I(v.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var lm=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new I(v.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new I(v.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Y0("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=d1((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new I(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new I(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new I(v.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},mo=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lm({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new I(v.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new I(v.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lm(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new bI;switch(r.type){case"firstParty":return new MI(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new I(v.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=kk.get(n);r&&(C("ComponentProvider","Removing Datastore"),kk.delete(n),r.terminate())}(this),Promise.resolve()}};function f1(t,e,n,r={}){var i;let s=(t=ve(t,mo))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&Pn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=at.MOCK_USER;else{a=lh(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new I(v.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new at(u)}t._authCredentials=new AI(new Cg(a,c))}}var Pt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},Pe=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new xr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},xr=class t extends Pt{constructor(e,n,r){super(e,n,Cc(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new Pe(this.firestore,null,new S(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function Z0(t,e,...n){if(t=le(t),Q0("collection","path",e),t instanceof mo){let r=ye.fromString(e,...n);return Fk(r),new xr(t,null,r)}{if(!(t instanceof Pe||t instanceof xr))throw new I(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ye.fromString(e,...n));return Fk(r),new xr(t.firestore,null,r)}}function p1(t,e){if(t=ve(t,mo),Q0("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new I(v.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Pt(t,null,function(r){return new tr(ye.emptyPath(),r)}(e))}function Td(t,e,...n){if(t=le(t),arguments.length===1&&(e=Dg.newId()),Q0("doc","path",e),t instanceof mo){let r=ye.fromString(e,...n);return Ok(r),new Pe(t,null,new S(r))}{if(!(t instanceof Pe||t instanceof xr))throw new I(v.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(ye.fromString(e,...n));return Ok(r),new Pe(t.firestore,t instanceof xr?t.converter:null,new S(r))}}function X0(t,e){return t=le(t),e=le(e),(t instanceof Pe||t instanceof xr)&&(e instanceof Pe||e instanceof xr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function J0(t,e){return t=le(t),e=le(e),t instanceof Pt&&e instanceof Pt&&t.firestore===e.firestore&&Ed(t._query,e._query)&&t.converter===e.converter}var c0=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new hd(this,"async_queue_retry"),this._u=()=>{let n=Eg();n&&C("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=Eg();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;let n=Eg();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});let n=new ct;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){return _(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!ss(e))throw e;C("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(e){let n=this.Xa.then(()=>(this.iu=!0,e().catch(r=>{this.ru=r,this.iu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Ze("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(e,n,r){this.au(),this.ou.indexOf(e)>-1&&(n=0);let i=WC.createAndSchedule(this,e,n,r,s=>this.lu(s));return this.nu.push(i),i}au(){this.ru&&F()}verifyOperationInProgress(){}hu(){return _(this,null,function*(){let e;do e=this.Xa,yield e;while(e!==this.Xa)})}Pu(e){for(let n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){let n=this.nu.indexOf(e);this.nu.splice(n,1)}};function u0(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var l0=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new ct,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var g1=-1,Ue=class extends mo{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new c0}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||m1(this),this._firestoreClient.terminate()}};function mt(t){return t._firestoreClient||m1(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function m1(t){var e,n,r;let i=t._freezeSettings(),s=function(a,c,u,l){return new LI(a,c,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,d1(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new o0(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function y1(t,e){b1(t=ve(t,Ue));let n=mt(t);if(n._uninitializedComponentsProvider)throw new I(v.FAILED_PRECONDITION,"SDK cache is already specified.");Pn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new md;return _1(n,i,new um(i,r.cacheSizeBytes,e?.forceOwnership))}function v1(t){b1(t=ve(t,Ue));let e=mt(t);if(e._uninitializedComponentsProvider)throw new I(v.FAILED_PRECONDITION,"SDK cache is already specified.");Pn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new md;return _1(e,r,new n0(r,n.cacheSizeBytes))}function _1(t,e,n){let r=new ct;return t.asyncQueue.enqueue(()=>_(this,null,function*(){try{yield Ig(t,n),yield a0(t,e),r.resolve()}catch(i){let s=i;if(!o1(s))throw s;Pn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function w1(t){if(t._initialized&&!t._terminated)throw new I(v.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new ct;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>_(this,null,function*(){try{yield function(r){return _(this,null,function*(){if(!ii.D())return Promise.resolve();let i=r+"main";yield ii.delete(i)})}(P0(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function E1(t){return function(n){let r=new ct;return n.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return g9(yield K0(n),r)})),r.promise}(mt(t=ve(t,Ue)))}function I1(t){return S9(mt(t=ve(t,Ue)))}function C1(t){return x9(mt(t=ve(t,Ue)))}function D1(t,e){let n=mt(t=ve(t,Ue)),r=new l0;return P9(n,t._databaseId,e,r),r}function T1(t,e){return k9(mt(t=ve(t,Ue)),e).then(n=>n?new Pt(t,null,n.query):null)}function b1(t){if(t._initialized||t._terminated)throw new I(v.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Pr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(Ct.fromBase64String(e))}catch(n){throw new I(v.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(Ct.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var rr=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new I(v.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ai=class{constructor(e){this._methodName=e}};var yo=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new I(v.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new I(v.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return J(this._lat,e._lat)||J(this._long,e._long)}};var O9=/^__.*__$/,d0=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new nr(e,this.data,this.fieldMask,n,this.fieldTransforms):new ts(e,this.data,n,this.fieldTransforms)}},dm=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new nr(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function A1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw F()}}var hm=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.mu(e),i}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.Eu(),i}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return fm(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(e.length===0)throw this.pu("Document fields must not be empty");if(A1(this.du)&&O9.test(e))throw this.pu('Document fields cannot begin and end with "__"')}},h0=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Cd(e)}Su(e,n,r,i=!1){return new hm({du:e,methodName:n,wu:r,path:Xe.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Eo(t){let e=t._freezeSettings(),n=Cd(t._databaseId);return new h0(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Cm(t,e,n,r,i,s={}){let o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);nD("Data must be an object, but it was:",o,r);let a=M1(r,o),c,u;if(s.merge)c=new fn(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=y0(e,d,n);if(!o.contains(h))throw new I(v.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);N1(l,h)||l.push(h)}c=new fn(l),u=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,u=o.fieldTransforms;return new d0(new jt(a),c,u)}var yd=class t extends ai{_toFieldTransform(e){if(e.du!==2)throw e.du===1?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function S1(t,e,n){return new hm({du:3,wu:e.settings.wu,methodName:t._methodName,Vu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var f0=class t extends ai{_toFieldTransform(e){return new fo(e.path,new Ji)}isEqual(e){return e instanceof t}},p0=class t extends ai{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=S1(this,e,!0),r=this.bu.map(s=>Io(s,n)),i=new si(r);return new fo(e.path,i)}isEqual(e){return e instanceof t&&Ny(this.bu,e.bu)}},g0=class t extends ai{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=S1(this,e,!0),r=this.bu.map(s=>Io(s,n)),i=new oi(r);return new fo(e.path,i)}isEqual(e){return e instanceof t&&Ny(this.bu,e.bu)}},m0=class t extends ai{constructor(e,n){super(e),this.Du=n}_toFieldTransform(e){let n=new es(e.serializer,pO(e.serializer,this.Du));return new fo(e.path,n)}isEqual(e){return e instanceof t&&this.Du===e.Du}};function eD(t,e,n,r){let i=t.Su(1,e,n);nD("Data must be an object, but it was:",i,r);let s=[],o=jt.empty();wo(r,(c,u)=>{let l=rD(e,c,n);u=le(u);let d=i.fu(l);if(u instanceof yd)s.push(l);else{let h=Io(u,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new fn(s);return new dm(o,a,i.fieldTransforms)}function tD(t,e,n,r,i,s){let o=t.Su(1,e,n),a=[y0(e,r,n)],c=[i];if(s.length%2!=0)throw new I(v.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(y0(e,s[h])),c.push(s[h+1]);let u=[],l=jt.empty();for(let h=a.length-1;h>=0;--h)if(!N1(u,a[h])){let f=a[h],p=c[h];p=le(p);let g=o.fu(f);if(p instanceof yd)u.push(f);else{let m=Io(p,g);m!=null&&(u.push(f),l.set(f,m))}}let d=new fn(u);return new dm(l,d,o.fieldTransforms)}function x1(t,e,n,r=!1){return Io(n,t.Su(r?4:3,e))}function Io(t,e){if(R1(t=le(t)))return nD("Unsupported field value:",e,t),M1(t,e);if(t instanceof ai)return function(r,i){if(!A1(i.du))throw i.pu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&e.du!==4)throw e.pu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let c=Io(a,i.gu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=le(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return pO(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=$e.fromDate(r);return{timestampValue:hc(i.serializer,s)}}if(r instanceof $e){let s=new $e(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:hc(i.serializer,s)}}if(r instanceof yo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Pr)return{bytesValue:DO(i.serializer,r._byteString)};if(r instanceof Pe){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:M0(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.pu(`Unsupported field value: ${Im(r)}`)}(t,e)}function M1(t,e){let n={};return Yk(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):wo(t,(r,i)=>{let s=Io(i,e.Ru(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function R1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $e||t instanceof yo||t instanceof Pr||t instanceof Pe||t instanceof ai)}function nD(t,e,n){if(!R1(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=Im(n);throw r==="an object"?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function y0(t,e,n){if((e=le(e))instanceof rr)return e._internalPath;if(typeof e=="string")return rD(t,e);throw fm("Field path arguments must be of type string or ",t,!1,void 0,n)}var F9=new RegExp("[~\\*/\\[\\]]");function rD(t,e,n){if(e.search(F9)>=0)throw fm(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new rr(...e.split("."))._internalPath}catch{throw fm(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function fm(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new I(v.INVALID_ARGUMENT,a+t+c)}function N1(t,e){return t.some(n=>n.isEqual(e))}var vo=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Pe(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new v0(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(Dm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},v0=class extends vo{data(){return super.data()}};function Dm(t,e){return typeof e=="string"?rD(t,e):e instanceof rr?e._internalPath:e._delegate._internalPath}function P1(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new I(v.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var vd=class{},_o=class extends vd{};function li(t,e,...n){let r=[];e instanceof vd&&r.push(e),r=r.concat(n),function(s){let o=s.filter(c=>c instanceof _0).length,a=s.filter(c=>c instanceof pm).length;if(o>1||o>0&&a>0)throw new I(v.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var pm=class t extends _o{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return q1(e._query,n),new Pt(e.firestore,e.converter,ZI(e._query,n))}_parse(e){let n=Eo(e.firestore);return function(s,o,a,c,u,l,d){let h;if(u.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new I(v.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){Lk(d,l);let f=[];for(let p of d)f.push(Vk(c,s,p));h={arrayValue:{values:f}}}else h=Vk(c,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||Lk(d,l),h=x1(a,o,d,l==="in"||l==="not-in");return pe.create(u,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function k1(t,e,n){let r=e,i=Dm("where",t);return pm._create(i,r,n)}var _0=class t extends vd{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Te.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let c of a)q1(o,c),o=ZI(o,c)}(e._query,n),new Pt(e.firestore,e.converter,ZI(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var w0=class t extends _o{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new I(v.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new I(v.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new lo(s,o)}(e._query,this._field,this._direction);return new Pt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new tr(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function O1(t,e="asc"){let n=e,r=Dm("orderBy",t);return w0._create(r,n)}var gm=class t extends _o{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new Pt(e.firestore,e.converter,kg(e._query,this._limit,this._limitType))}};function F1(t){return h1("limit",t),gm._create("limit",t,"F")}function V1(t){return h1("limitToLast",t),gm._create("limitToLast",t,"L")}var mm=class t extends _o{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=$1(e,this.type,this._docOrFields,this._inclusive);return new Pt(e.firestore,e.converter,function(i,s){return new tr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function L1(...t){return mm._create("startAt",t,!0)}function j1(...t){return mm._create("startAfter",t,!1)}var ym=class t extends _o{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=$1(e,this.type,this._docOrFields,this._inclusive);return new Pt(e.firestore,e.converter,function(i,s){return new tr(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function U1(...t){return ym._create("endBefore",t,!1)}function B1(...t){return ym._create("endAt",t,!0)}function $1(t,e,n,r){if(n[0]=le(n[0]),n[0]instanceof vo)return function(s,o,a,c,u){if(!c)throw new I(v.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of ic(s))if(d.field.isKeyField())l.push(uo(o,c.key));else{let h=c.data.field(d.field);if(_m(h))throw new I(v.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new I(v.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new Rr(l,u)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=Eo(t.firestore);return function(o,a,c,u,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new I(v.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new I(v.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof g}`);if(!S0(o)&&g.indexOf("/")!==-1)throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${g}' contains a slash.`);let m=o.path.child(ye.fromString(g));if(!S.isDocumentKey(m))throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${m}' is not because it contains an odd number of segments.`);let w=new S(m);f.push(uo(a,w))}else{let m=x1(c,u,g);f.push(m)}}return new Rr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function Vk(t,e,n){if(typeof(n=le(n))=="string"){if(n==="")throw new I(v.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!S0(e)&&n.indexOf("/")!==-1)throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(ye.fromString(n));if(!S.isDocumentKey(r))throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return uo(t,new S(r))}if(n instanceof Pe)return uo(t,n._key);throw new I(v.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Im(n)}.`)}function Lk(t,e){if(!Array.isArray(t)||t.length===0)throw new I(v.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function q1(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new I(v.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new I(v.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var Ec=class{convertValue(e,n="none"){switch(co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Yi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw F()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return wo(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new yo(Ge(e.latitude),Ge(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=b0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Jl(e));default:return null}}convertTimestamp(e){let n=Qi(e);return new $e(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=ye.fromString(e);q(OO(r));let i=new Zi(r.get(1),r.get(3)),s=new S(r.popFirst(5));return i.isEqual(n)||Ze(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function Tm(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var E0=class extends Ec{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}};var ri=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},On=class extends vo{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Wi(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(Dm("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Wi=class extends On{data(e={}){return super.data(e)}},ir=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ri(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Wi(this._firestore,this._userDataWriter,r.key,r,new ri(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new I(v.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let c=new Wi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ri(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Wi(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ri(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),u=-1,l=-1;return a.type!==0&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:V9(a.type),doc:c,oldIndex:u,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function V9(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return F()}}function iD(t,e){return t instanceof On&&e instanceof On?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof ir&&e instanceof ir&&t._firestore===e._firestore&&J0(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function H1(t){t=ve(t,Pe);let e=ve(t.firestore,Ue);return u1(mt(e),t._key).then(n=>cD(e,t,n))}var ci=class extends Ec{constructor(e){super(),this.firestore=e}convertBytes(e){return new Pr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new Pe(this.firestore,null,n)}};function G1(t){t=ve(t,Pe);let e=ve(t.firestore,Ue),n=mt(e),r=new ci(e);return M9(n,t._key).then(i=>new On(e,r,t._key,i,new ri(i!==null&&i.hasLocalMutations,!0),t.converter))}function z1(t){t=ve(t,Pe);let e=ve(t.firestore,Ue);return u1(mt(e),t._key,{source:"server"}).then(n=>cD(e,t,n))}function W1(t){t=ve(t,Pt);let e=ve(t.firestore,Ue),n=mt(e),r=new ci(e);return P1(t._query),l1(n,t._query).then(i=>new ir(e,r,t,i))}function K1(t){t=ve(t,Pt);let e=ve(t.firestore,Ue),n=mt(e),r=new ci(e);return R9(n,t._query).then(i=>new ir(e,r,t,i))}function Q1(t){t=ve(t,Pt);let e=ve(t.firestore,Ue),n=mt(e),r=new ci(e);return l1(n,t._query,{source:"server"}).then(i=>new ir(e,r,t,i))}function sD(t,e,n){t=ve(t,Pe);let r=ve(t.firestore,Ue),i=Tm(t.converter,e,n);return Sc(r,[Cm(Eo(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,ze.none())])}function oD(t,e,n,...r){t=ve(t,Pe);let i=ve(t.firestore,Ue),s=Eo(i),o;return o=typeof(e=le(e))=="string"||e instanceof rr?tD(s,"updateDoc",t._key,e,n,r):eD(s,"updateDoc",t._key,e),Sc(i,[o.toMutation(t._key,ze.exists(!0))])}function Y1(t){return Sc(ve(t.firestore,Ue),[new ns(t._key,ze.none())])}function Z1(t,e){let n=ve(t.firestore,Ue),r=Td(t),i=Tm(t.converter,e);return Sc(n,[Cm(Eo(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,ze.exists(!1))]).then(()=>r)}function aD(t,...e){var n,r,i;t=le(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||u0(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(u0(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let c,u,l;if(t instanceof Pe)u=ve(t.firestore,Ue),l=Cc(t._key.path),c={next:d=>{e[o]&&e[o](cD(u,t,d))},error:e[o+1],complete:e[o+2]};else{let d=ve(t,Pt);u=ve(d.firestore,Ue),l=d._query;let h=new ci(u);c={next:f=>{e[o]&&e[o](new ir(u,h,d,f))},error:e[o+1],complete:e[o+2]},P1(t._query)}return function(h,f,p,g){let m=new _c(g),w=new pd(f,m,p);return h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return V0(yield wc(h),w)})),()=>{m.La(),h.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return L0(yield wc(h),w)}))}}(mt(u),l,a,c)}function X1(t,e){return N9(mt(t=ve(t,Ue)),u0(e)?e:{next:e})}function Sc(t,e){return function(r,i){let s=new ct;return r.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){return d9(yield K0(r),i,s)})),s.promise}(mt(t),e)}function cD(t,e,n){let r=n.docs.get(e._key),i=new ci(t);return new On(t,i,e._key,r,new ri(n.hasPendingWrites,n.fromCache),e.converter)}var L9={maxAttempts:5};var vm=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Eo(e)}set(e,n,r){this._verifyNotCommitted();let i=Gi(e,this._firestore),s=Tm(i.converter,n,r),o=Cm(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,ze.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=Gi(e,this._firestore),o;return o=typeof(n=le(n))=="string"||n instanceof rr?tD(this._dataReader,"WriteBatch.update",s._key,n,r,i):eD(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,ze.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=Gi(e,this._firestore);return this._mutations=this._mutations.concat(new ns(n._key,ze.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new I(v.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Gi(t,e){if((t=le(t)).firestore!==e)throw new I(v.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var I0=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Eo(n)}get(n){let r=Gi(n,this._firestore),i=new E0(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return F();let o=s[0];if(o.isFoundDocument())return new vo(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new vo(this._firestore,i,r._key,null,r.converter);throw F()})}set(n,r,i){let s=Gi(n,this._firestore),o=Tm(s.converter,r,i),a=Cm(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=Gi(n,this._firestore),a;return a=typeof(r=le(r))=="string"||r instanceof rr?tD(this._dataReader,"Transaction.update",o._key,r,i,s):eD(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=Gi(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=Gi(e,this._firestore),r=new ci(this._firestore);return super.get(e).then(i=>new On(this._firestore,r,n._key,i._document,new ri(!1,!1),n.converter))}};function J1(t,e,n){t=ve(t,Ue);let r=Object.assign(Object.assign({},L9),n);return function(s){if(s.maxAttempts<1)throw new I(v.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let c=new ct;return s.asyncQueue.enqueueAndForget(()=>_(this,null,function*(){let u=yield A9(s);new s0(s.asyncQueue,u,a,o,c).ja()})),c.promise}(mt(t),i=>e(new I0(t,i)),r)}function eF(){return new yd("deleteField")}function tF(){return new f0("serverTimestamp")}function nF(...t){return new p0("arrayUnion",t)}function rF(...t){return new g0("arrayRemove",t)}function iF(t){return new m0("increment",t)}(function(e,n=!0){(function(i){Ic=i})(gh),vs(new an("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Ue(new SI(r.getProvider("auth-internal")),new NI(r.getProvider("app-check-internal")),function(u,l){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new I(v.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zi(u.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),jn(UP,"4.4.3",e),jn(UP,"4.4.3","esm2017")})();var j9="@firebase/firestore-compat",U9="0.3.26";function pD(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new I("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function sF(){if(typeof Uint8Array>"u")throw new I("unimplemented","Uint8Arrays are not available in this environment.")}function oF(){if(!Zk())throw new I("unimplemented","Blobs are unavailable in Firestore in this environment.")}var bm=class t{constructor(e){this._delegate=e}static fromBase64String(e){return oF(),new t(Pr.fromBase64String(e))}static fromUint8Array(e){return sF(),new t(Pr.fromUint8Array(e))}toBase64(){return oF(),this._delegate.toBase64()}toUint8Array(){return sF(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function uD(t){return B9(t,["next","error","complete"])}function B9(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var lD=class{enableIndexedDbPersistence(e,n){return y1(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return v1(e._delegate)}clearIndexedDbPersistence(e){return w1(e._delegate)}},Am=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Zi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&Pn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){f1(this._delegate,e,n,r)}enableNetwork(){return I1(this._delegate)}disableNetwork(){return C1(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,Y0("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return E1(this._delegate)}onSnapshotsInSync(e){return X1(this._delegate,e)}get app(){if(!this._appCompat)throw new I("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Rc(this,Z0(this._delegate,e))}catch(n){throw Yt(n,"collection()","Firestore.collection()")}}doc(e){try{return new kr(this,Td(this._delegate,e))}catch(n){throw Yt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new bo(this,p1(this._delegate,e))}catch(n){throw Yt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return J1(this._delegate,n=>e(new Sm(this,n)))}batch(){return mt(this._delegate),new xm(new vm(this._delegate,e=>Sc(this._delegate,e)))}loadBundle(e){return D1(this._delegate,e)}namedQuery(e){return T1(this._delegate,e).then(n=>n?new bo(this,n):null)}},xc=class extends Ec{constructor(e){super(),this.firestore=e}convertBytes(e){return new bm(new Pr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return kr.forKey(n,this.firestore,null)}};function $9(t){jk(t)}var Sm=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new xc(e)}get(e){let n=Co(e);return this._delegate.get(n).then(r=>new Do(this._firestore,new On(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Co(e);return r?(pD("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Co(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Co(e);return this._delegate.delete(n),this}},xm=class{constructor(e){this._delegate=e}set(e,n,r){let i=Co(e);return r?(pD("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Co(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Co(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},Mc=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Wi(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new To(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new xc(e),n),i.set(n,s)),s}};Mc.INSTANCES=new WeakMap;var kr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new xc(e)}static forPath(e,n,r){if(e.length%2!==0)throw new I("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new Pe(n._delegate,r,new S(e)))}static forKey(e,n,r){return new t(n,new Pe(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Rc(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Rc(this.firestore,Z0(this._delegate,e))}catch(n){throw Yt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=le(e),e instanceof Pe?X0(this._delegate,e):!1}set(e,n){n=pD("DocumentReference.set",n);try{return n?sD(this._delegate,e,n):sD(this._delegate,e)}catch(r){throw Yt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?oD(this._delegate,e):oD(this._delegate,e,n,...r)}catch(i){throw Yt(i,"updateDoc()","DocumentReference.update()")}}delete(){return Y1(this._delegate)}onSnapshot(...e){let n=aF(e),r=cF(e,i=>new Do(this.firestore,new On(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return aD(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=G1(this._delegate):e?.source==="server"?n=z1(this._delegate):n=H1(this._delegate),n.then(r=>new Do(this.firestore,new On(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Mc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Yt(t,e,n){return t.message=t.message.replace(e,n),t}function aF(t){for(let e of t)if(typeof e=="object"&&!uD(e))return e;return{}}function cF(t,e){var n,r;let i;return uD(t[0])?i=t[0]:uD(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Do=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new kr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return iD(this._delegate,e._delegate)}},To=class extends Do{data(e){let n=this._delegate.data(e);return this._delegate._converter||Uk(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},bo=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new xc(e)}where(e,n,r){try{return new t(this.firestore,li(this._delegate,k1(e,n,r)))}catch(i){throw Yt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,li(this._delegate,O1(e,n)))}catch(r){throw Yt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,li(this._delegate,F1(e)))}catch(n){throw Yt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,li(this._delegate,V1(e)))}catch(n){throw Yt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,li(this._delegate,L1(...e)))}catch(n){throw Yt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,li(this._delegate,j1(...e)))}catch(n){throw Yt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,li(this._delegate,U1(...e)))}catch(n){throw Yt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,li(this._delegate,B1(...e)))}catch(n){throw Yt(n,"endAt()","Query.endAt()")}}isEqual(e){return J0(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=K1(this._delegate):e?.source==="server"?n=Q1(this._delegate):n=W1(this._delegate),n.then(r=>new bd(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=aF(e),r=cF(e,i=>new bd(this.firestore,new ir(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return aD(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Mc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},dD=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new To(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},bd=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new bo(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new To(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new dD(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new To(this._firestore,r))})}isEqual(e){return iD(this._delegate,e._delegate)}},Rc=class t extends bo{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new kr(this.firestore,e):null}doc(e){try{return e===void 0?new kr(this.firestore,Td(this._delegate)):new kr(this.firestore,Td(this._delegate,e))}catch(n){throw Yt(n,"doc()","CollectionReference.doc()")}}add(e){return Z1(this._delegate,e).then(n=>new kr(this.firestore,n))}isEqual(e){return X0(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Mc.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Co(t){return ve(t,Pe)}var hD=class t{constructor(...e){this._delegate=new rr(...e)}static documentId(){return new t(Xe.keyField().canonicalString())}isEqual(e){return e=le(e),e instanceof rr?this._delegate._internalPath.isEqual(e._internalPath):!1}};var fD=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=tF();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=eF();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=nF(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=rF(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=iF(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var q9={Firestore:Am,GeoPoint:yo,Timestamp:$e,Blob:bm,Transaction:Sm,WriteBatch:xm,DocumentReference:kr,DocumentSnapshot:Do,Query:bo,QueryDocumentSnapshot:To,QuerySnapshot:bd,CollectionReference:Rc,FieldPath:hD,FieldValue:fD,setLogLevel:$9,CACHE_SIZE_UNLIMITED:g1};function H9(t,e){t.INTERNAL.registerComponent(new an("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},q9)))}function G9(t){H9(t,(e,n)=>new Am(e,n,new lD)),t.registerVersion(j9,U9)}G9(vt);function z9(t,e=Cs){return new ne(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function uF(t,e){return z9(t,e)}function W9(t,e){return uF(t,e).pipe(Ds(void 0),nu(),O(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function yD(t,e){return uF(t,e).pipe(O(n=>({payload:n,type:"query"})))}var Mm=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=hF(r,n);return new Nm(i,s,this.afs)}snapshotChanges(){return W9(this.ref,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return this.snapshotChanges().pipe(O(({payload:n})=>e.idField?ge(x({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return fe(this.ref.get(e)).pipe(Ye)}};function Rm(t,e){return yD(t,e).pipe(Ds(void 0),nu(),O(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,c)=>{let u=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(a.metadata)||!u&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function lF(t,e,n){return Rm(t,n).pipe(lr((r,i)=>K9(r,i.map(s=>s.payload),e),[]),tu(),O(r=>r.map(i=>({type:i.type,payload:i}))))}function K9(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=Q9(t,r))}),t}function gD(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function Q9(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return gD(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return gD(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return gD(t,e.oldIndex,1);break}return t}function dF(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var Nm=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=Rm(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(O(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(Ds(void 0),nu(),dt(([r,i])=>i.length>0||!r),O(([,r])=>r),Ye)}auditTrail(e){return this.stateChanges(e).pipe(lr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=dF(e);return lF(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return yD(this.query,this.afs.schedulers.outsideAngular).pipe(O(n=>n.payload.docs.map(r=>e.idField?ge(x({},r.data()),{[e.idField]:r.id}):r.data())),Ye)}get(e){return fe(this.query.get(e)).pipe(Ye)}add(e){return this.ref.add(e)}doc(e){return new Mm(this.ref.doc(e),this.afs)}},mD=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?Rm(this.query,this.afs.schedulers.outsideAngular).pipe(Ye):Rm(this.query,this.afs.schedulers.outsideAngular).pipe(O(n=>n.filter(r=>e.indexOf(r.type)>-1)),dt(n=>n.length>0),Ye)}auditTrail(e){return this.stateChanges(e).pipe(lr((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=dF(e);return lF(this.query,n,this.afs.schedulers.outsideAngular).pipe(Ye)}valueChanges(e={}){return yD(this.query,this.afs.schedulers.outsideAngular).pipe(O(r=>r.payload.docs.map(i=>e.idField?x({[e.idField]:i.id},i.data()):i.data())),Ye)}get(e){return fe(this.query.get(e)).pipe(Ye)}},Y9=new A("angularfire2.enableFirestorePersistence"),Z9=new A("angularfire2.firestore.persistenceSettings"),X9=new A("angularfire2.firestore.settings"),J9=new A("angularfire2.firestore.use-emulator");function hF(t,e=n=>n){return{query:e(t),ref:t}}var fF=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,g,m,w,P){this.schedulers=c;let T=Ws(n,a,r),V=l;d&&gl(T,a,h,p,g,m,f,w),[this.firestore,this.persistenceEnabled$]=Ua(`${T.name}.firestore`,"AngularFirestore",T.name,()=>{let G=a.runOutsideAngular(()=>T.firestore());if(s&&G.settings(s),V&&G.useEmulator(...V),i&&!Us(o)){let W=()=>{try{return fe(G.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(Ee){return typeof console<"u"&&console.warn(Ee),U(!1)}};return[G,a.runOutsideAngular(W)]}else return[G,U(!1)]},[s,V,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=hF(i,r),a=this.schedulers.ngZone.run(()=>s);return new Nm(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new mD(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new Mm(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(E(Li),E(ji,8),E(Y9,8),E(X9,8),E(_t),E(de),E(ja),E(Z9,8),E(J9,8),E(Ks,8),E(ul,8),E(ll,8),E(dl,8),E(hl,8),E(fl,8),E(pl,8),E(Jr,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var as=(()=>{let e=class e{constructor(r){this.firestore=r,this.collectionName="atendimentos"}buscarAtendimentoPorCpf(r){return console.log("Buscando atendimento por CPF:",r),this.firestore.collection(this.collectionName,i=>i.where("clienteCpf","==",r)).valueChanges({idField:"id"}).pipe(O(i=>{if(i.length>0){let s=i[0];return console.log("Atendimento encontrado:",s),s}else return console.log("Nenhum atendimento encontrado para o CPF fornecido."),null}))}atualizarAtendimento(r){console.log("Atualizando atendimento:",r);let o=r,{clienteCpf:i}=o,s=Sy(o,["clienteCpf"]);return this.firestore.collection(this.collectionName,a=>a.where("clienteCpf","==",i)).get().toPromise().then(a=>{if(a&&!a.empty){let c=a.docs[0].id;return this.firestore.doc(`${this.collectionName}/${c}`).update(s).then(()=>console.log("Atendimento atualizado com sucesso!")).catch(u=>console.error("Erro ao atualizar atendimento:",u))}else throw console.error("Nenhum documento encontrado para o CPF fornecido."),new Error("Nenhum documento encontrado para o CPF fornecido.")}).catch(a=>{throw console.error("Erro ao buscar/atualizar atendimento:",a),a})}cadastrarAtendimento(r){return console.log("Cadastrando novo atendimento:",r),this.firestore.collection(this.collectionName).add(r).then(i=>(console.log("Atendimento cadastrado com ID:",i.id),i.id)).catch(i=>{throw console.error("Erro ao cadastrar atendimento:",i),i})}listarAtendimentos(){return console.log("Listando atendimentos"),this.firestore.collection(this.collectionName).snapshotChanges().pipe(O(r=>{let i=r.map(s=>{let o=s.payload.doc.data(),a=o.clienteCpf;return ge(x({},o),{clienteCpf:a})});return console.log("Atendimentos encontrados:",i),i}))}deletarAtendimentoPorCpf(r){return this.firestore.collection(this.collectionName,i=>i.where("clienteCpf","==",r)).get().toPromise().then(i=>{i?i.forEach(s=>{s.ref.delete()}):console.error("Nenhum documento encontrado para o CPF fornecido.")}).catch(i=>{console.error("Erro ao excluir atendimento:",i)})}};e.\u0275fac=function(i){return new(i||e)(E(fF))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var cs=(()=>{let e=class e{constructor(r,i){this.afAuth=r,this.router=i,this.user$=r.authState}login(r,i){this.afAuth.signInWithEmailAndPassword(r,i).then(()=>{console.log("Login bem-sucedido!"),this.router.navigate(["/listagem"])}).catch(s=>{console.error("Erro no login:",s),alert("Email ou senha incorretos. Por favor, tente novamente.")})}signUp(r,i){this.afAuth.createUserWithEmailAndPassword(r,i).then(()=>{console.log("Cadastro bem-sucedido!"),this.router.navigate(["/listagem"])}).catch(s=>{console.error("Erro no cadastro:",s)})}logout(){this.afAuth.signOut().then(()=>{console.log("Logout bem-sucedido!"),this.router.navigate(["/login"])}).catch(r=>{console.error("Erro no logout:",r)})}};e.\u0275fac=function(i){return new(i||e)(E(Ks),E(Mt))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function t5(t,e){t&1&&(j(0,"div"),$(1," Nome do Pet \xE9 obrigat\xF3rio. "),N())}function n5(t,e){t&1&&(j(0,"div"),$(1," Nome do Cliente \xE9 obrigat\xF3rio. "),N())}function r5(t,e){t&1&&(j(0,"div"),$(1," CPF do Cliente \xE9 obrigat\xF3rio. "),N())}function i5(t,e){t&1&&(j(0,"div"),$(1," Data do Atendimento \xE9 obrigat\xF3ria. "),N())}var pF=(()=>{let e=class e{constructor(r,i,s){this.formBuilder=r,this.atendimentoService=i,this.authService=s,this.atendimento={petName:"",clienteName:"",data:"",observacoes:"",clienteCpf:""},this.atendimentoForm=this.formBuilder.group({petName:["",Mn.required],clienteName:["",Mn.required],clienteCpf:["",Mn.required],data:["",Mn.required],observacoes:[""]})}get petName(){return this.atendimentoForm.get("petName")}get clienteName(){return this.atendimentoForm.get("clienteName")}get clienteCpf(){return this.atendimentoForm.get("clienteCpf")}get data(){return this.atendimentoForm.get("data")}submitForm(){if(!this.atendimentoForm){console.error("O formul\xE1rio n\xE3o est\xE1 definido.");return}if(this.atendimentoForm.invalid){console.error("O formul\xE1rio cont\xE9m erros. Por favor, corrija-os antes de enviar.");return}this.atendimento=this.atendimentoForm.value,this.atendimentoService.cadastrarAtendimento(this.atendimento).then(()=>{this.atendimentoForm.reset()}).catch(r=>{console.error("Ocorreu um erro durante o cadastro:",r)})}logout(){this.authService.logout()}};e.\u0275fac=function(i){return new(i||e)(L(kp),L(as),L(cs))},e.\u0275cmp=sn({type:e,selectors:[["app-cadastro-atendimento"]],decls:37,vars:5,consts:[["routerLink","/listagem","routerLinkActive","active"],["routerLink","/cadastro","routerLinkActive","active"],[1,"logout-button"],[3,"click"],[1,"container"],[1,"form-container"],[3,"formGroup","ngSubmit"],["for","petName"],["type","text","id","petName","name","petName","formControlName","petName"],[4,"ngIf"],["for","clienteName"],["type","text","id","clienteName","name","clienteName","formControlName","clienteName"],["for","clienteCpf"],["type","text","id","clienteCpf","name","clienteCpf","formControlName","clienteCpf"],["for","data"],["type","date","id","data","name","data","formControlName","data"],["for","observacoes"],["id","observacoes","name","observacoes","formControlName","observacoes"],["type","submit"]],template:function(i,s){if(i&1&&(j(0,"nav")(1,"a",0),$(2,"Detalhes de Atendimentos"),N(),j(3,"a",1),$(4,"Cadastro de Atendimento"),N(),j(5,"div",2)(6,"button",3),pt("click",function(){return s.logout()}),$(7,"Logout"),N()()(),j(8,"div",4)(9,"div",5)(10,"form",6),pt("ngSubmit",function(){return s.submitForm()}),j(11,"div")(12,"label",7),$(13,"Nome do Pet:"),N(),un(14,"input",8),ft(15,t5,2,0,"div",9),N(),j(16,"div")(17,"label",10),$(18,"Nome do Cliente:"),N(),un(19,"input",11),ft(20,n5,2,0,"div",9),N(),j(21,"div")(22,"label",12),$(23,"CPF do Cliente:"),N(),un(24,"input",13),ft(25,r5,2,0,"div",9),N(),j(26,"div")(27,"label",14),$(28,"Data do Atendimento:"),N(),un(29,"input",15),ft(30,i5,2,0,"div",9),N(),j(31,"div")(32,"label",16),$(33,"Observa\xE7\xF5es:"),N(),un(34,"textarea",17),N(),j(35,"button",18),$(36,"Cadastrar"),N()()()()),i&2){let o,a,c,u;se(10),Ne("formGroup",s.atendimentoForm),se(5),Ne("ngIf",((o=s.atendimentoForm.get("petName"))==null?null:o.invalid)&&(((o=s.atendimentoForm.get("petName"))==null?null:o.dirty)||((o=s.atendimentoForm.get("petName"))==null?null:o.touched))),se(5),Ne("ngIf",((a=s.atendimentoForm.get("clienteName"))==null?null:a.invalid)&&(((a=s.atendimentoForm.get("clienteName"))==null?null:a.dirty)||((a=s.atendimentoForm.get("clienteName"))==null?null:a.touched))),se(5),Ne("ngIf",((c=s.atendimentoForm.get("clienteCpf"))==null?null:c.invalid)&&(((c=s.atendimentoForm.get("clienteCpf"))==null?null:c.dirty)||((c=s.atendimentoForm.get("clienteCpf"))==null?null:c.touched))),se(5),Ne("ngIf",((u=s.atendimentoForm.get("data"))==null?null:u.invalid)&&(((u=s.atendimentoForm.get("data"))==null?null:u.dirty)||((u=s.atendimentoForm.get("data"))==null?null:u.touched)))}},dependencies:[_r,Ra,Ip,La,Oi,Fa,Va,sl,ol],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.form-container[_ngcontent-%COMP%]{width:300px;padding:20px;border:1px solid #ccc;border-radius:8px;margin-top:50px}form[_ngcontent-%COMP%]{width:100%}div[_ngcontent-%COMP%]{margin-bottom:15px;display:flex;flex-direction:column}label[_ngcontent-%COMP%]{font-weight:700;color:#333;margin-bottom:5px}input[type=text][_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:8px;font-size:16px;border:1px solid #ccc;border-radius:4px;box-sizing:border-box}input[type=date][_ngcontent-%COMP%]{-webkit-appearance:none;appearance:none}button[type=submit][_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px 20px;font-size:16px;border:none;border-radius:4px;cursor:pointer;transition:background-color .3s ease;width:100%;box-sizing:border-box}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#0056b3}nav[_ngcontent-%COMP%]{background-color:#333;padding:10px 20px;display:flex;align-items:center}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;margin-right:20px;transition:color .3s ease}nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#ff8c00}.logout-button[_ngcontent-%COMP%]{margin-left:auto;align-items:center;margin-bottom:1px}.logout-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff;background-color:#dc3545;border:none;border-radius:5px;padding:8px 16px;font-size:14px;cursor:pointer;transition:background-color .3s,color .3s}.logout-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#c82333}.logout-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}"]});let t=e;return t})();function s5(t,e){if(t&1){let n=ya();j(0,"div",8)(1,"div")(2,"strong"),$(3,"Nome do Pet:"),N(),$(4),N(),j(5,"div")(6,"strong"),$(7,"Nome do Cliente:"),N(),$(8),N(),j(9,"div")(10,"strong"),$(11,"CPF do Cliente:"),N(),$(12),N(),j(13,"div")(14,"strong"),$(15,"Data do Atendimento:"),N(),$(16),N(),j(17,"div")(18,"strong"),$(19,"Observa\xE7\xF5es:"),N(),$(20),N(),j(21,"button",3),pt("click",function(){let s=Tn(n).$implicit,o=gt();return bn(o.deleteAtendimento(s.clienteCpf))}),$(22,"Excluir"),N(),j(23,"button",3),pt("click",function(){let s=Tn(n).$implicit,o=gt();return bn(o.editarAtendimento(s.clienteCpf))}),$(24,"Editar"),N()()}if(t&2){let n=e.$implicit;se(4),kt(" ",n.petName," "),se(4),kt(" ",n.clienteName," "),se(4),kt(" ",n.clienteCpf," "),se(4),kt(" ",n.data," "),se(4),kt(" ",n.observacoes," ")}}function o5(t,e){t&1&&(j(0,"div")(1,"p"),$(2,"Nenhum atendimento registrado."),N()())}var gF=(()=>{let e=class e{constructor(r,i,s){this.atendimentoService=r,this.router=i,this.authService=s,this.atendimentos=[]}ngOnInit(){this.carregarAtendimentos()}carregarAtendimentos(){this.atendimentoService.listarAtendimentos().subscribe(r=>this.atendimentos=r)}deleteAtendimento(r){confirm("Tem certeza que deseja excluir este atendimento?")&&this.atendimentoService.deletarAtendimentoPorCpf(r).then(()=>{console.log("Atendimento exclu\xEDdo com sucesso!"),this.carregarAtendimentos()}).catch(i=>{console.error("Erro ao excluir atendimento:",i)})}editarAtendimento(r){this.router.navigate(["/edicao",r])}logout(){this.authService.logout()}};e.\u0275fac=function(i){return new(i||e)(L(as),L(Mt),L(cs))},e.\u0275cmp=sn({type:e,selectors:[["app-listagem-atendimentos"]],decls:14,vars:2,consts:[["routerLink","/listagem","routerLinkActive","active"],["routerLink","/cadastro","routerLinkActive","active"],[1,"logout-button"],[3,"click"],[1,"atendimentos-container"],[1,"atendimentos-grid"],["class","atendimento-card",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"atendimento-card"]],template:function(i,s){i&1&&(j(0,"nav")(1,"a",0),$(2,"Detalhes de Atendimentos"),N(),j(3,"a",1),$(4,"Cadastro de Atendimento"),N(),j(5,"div",2)(6,"button",3),pt("click",function(){return s.logout()}),$(7,"Logout"),N()()(),j(8,"div",4)(9,"h2"),$(10,"Detalhes de Atendimentos"),N(),j(11,"div",5),ft(12,s5,25,5,"div",6),N()(),ft(13,o5,3,0,"div",7)),i&2&&(se(12),Ne("ngForOf",s.atendimentos),se(),Ne("ngIf",!s.atendimentos||s.atendimentos.length===0))},dependencies:[dM,_r,Ra,Ip],styles:[".atendimentos-container[_ngcontent-%COMP%]{margin-bottom:20px}.atendimentos-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px}.atendimento-card[_ngcontent-%COMP%]{flex:1 0 300px;border:1px solid #ccc;border-radius:5px;padding:15px;background-color:#f9f9f9}.atendimento-card[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:10px}button[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff;border:none;border-radius:5px;padding:5px 10px;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#c82333}nav[_ngcontent-%COMP%]{background-color:#333;padding:10px 20px;display:flex;align-items:center}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;margin-right:20px;transition:color .3s ease}nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#ff8c00}.logout-button[_ngcontent-%COMP%]{margin-left:auto;display:flex;align-items:center}.logout-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#fff;background-color:#dc3545;border:none;border-radius:5px;padding:8px 16px;font-size:14px;cursor:pointer;transition:background-color .3s,color .3s}.logout-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#c82333}.logout-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}"]});let t=e;return t})();function a5(t,e){if(t&1){let n=ya();j(0,"form",4),pt("ngSubmit",function(){Tn(n);let i=gt();return bn(i.submitForm())}),j(1,"div")(2,"label",5),$(3,"Nome do Pet:"),N(),j(4,"input",6),_a("ngModelChange",function(i){Tn(n);let s=gt();return Du(s.atendimento.petName,i)||(s.atendimento.petName=i),bn(i)}),N()(),j(5,"div")(6,"label",7),$(7,"Nome do Cliente:"),N(),j(8,"input",8),_a("ngModelChange",function(i){Tn(n);let s=gt();return Du(s.atendimento.clienteName,i)||(s.atendimento.clienteName=i),bn(i)}),N()(),j(9,"div")(10,"label",9),$(11,"Data do Atendimento:"),N(),j(12,"input",10),_a("ngModelChange",function(i){Tn(n);let s=gt();return Du(s.atendimento.data,i)||(s.atendimento.data=i),bn(i)}),N()(),j(13,"div")(14,"label",11),$(15,"Observa\xE7\xF5es:"),N(),j(16,"textarea",12),_a("ngModelChange",function(i){Tn(n);let s=gt();return Du(s.atendimento.observacoes,i)||(s.atendimento.observacoes=i),bn(i)}),N()(),j(17,"button",13),$(18,"Salvar Altera\xE7\xF5es"),N()()}if(t&2){let n=gt();se(4),va("ngModel",n.atendimento.petName),se(4),va("ngModel",n.atendimento.clienteName),se(4),va("ngModel",n.atendimento.data),se(4),va("ngModel",n.atendimento.observacoes)}}function c5(t,e){if(t&1&&(j(0,"div",14)(1,"p"),$(2),N()()),t&2){let n=gt();se(2),Cu(n.mensagem)}}var mF=(()=>{let e=class e{constructor(r,i,s){this.route=r,this.router=i,this.atendimentoService=s,this.atendimento=null,this.atualizacaoConcluida=!1,this.mensagem=""}ngOnInit(){this.obterDetalhesAtendimento()}obterDetalhesAtendimento(){let r=this.route.snapshot.paramMap.get("clienteCpf");if(r){let i=r;this.atendimentoService.buscarAtendimentoPorCpf(i).subscribe(s=>{s?this.atendimento=s:console.error("Atendimento n\xE3o encontrado.")})}else console.error("Par\xE2metro CPF n\xE3o encontrado.")}submitForm(){this.atendimento?this.atendimentoService.atualizarAtendimento(this.atendimento).then(()=>{this.atualizacaoConcluida=!0,this.mensagem="Atendimento atualizado!",this.redirecionarParaDetalhes(),this.atendimento=null}).catch(r=>{console.error("Erro ao atualizar o atendimento:",r),this.mensagem="Erro ao atualizar o atendimento"}):(console.error("Atendimento n\xE3o encontrado."),this.mensagem="Atendimento n\xE3o encontrado.")}redirecionarParaDetalhes(){if(this.atendimento&&this.atendimento.clienteCpf){let r=this.atendimento.clienteCpf;this.router.navigate(["/listagem"])}else console.error("CPF do cliente n\xE3o encontrado.")}};e.\u0275fac=function(i){return new(i||e)(L(Zn),L(Mt),L(as))},e.\u0275cmp=sn({type:e,selectors:[["app-edicao-atendimento"]],decls:4,vars:2,consts:[[1,"container"],[1,"form-container"],[3,"ngSubmit",4,"ngIf"],["class","mensagem-container",4,"ngIf"],[3,"ngSubmit"],["for","petName"],["type","text","id","petName","name","petName","required","",3,"ngModel","ngModelChange"],["for","clienteName"],["type","text","id","clienteName","name","clienteName","required","",3,"ngModel","ngModelChange"],["for","data"],["type","date","id","data","name","data","required","",3,"ngModel","ngModelChange"],["for","observacoes"],["id","observacoes","name","observacoes",3,"ngModel","ngModelChange"],["type","submit"],[1,"mensagem-container"]],template:function(i,s){i&1&&(j(0,"div",0)(1,"div",1),ft(2,a5,19,4,"form",2),N()(),ft(3,c5,3,1,"div",3)),i&2&&(se(2),Ne("ngIf",s.atendimento),se(),Ne("ngIf",s.atualizacaoConcluida))},dependencies:[_r,La,Oi,Fa,Va,al,_E,vE],styles:[".container[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;justify-content:center;align-items:center}.form-container[_ngcontent-%COMP%]{width:300px;margin:50px auto;padding:20px;border:1px solid #ccc;border-radius:8px}.mensagem-container[_ngcontent-%COMP%]{margin-top:20px}form[_ngcontent-%COMP%]{width:100%}div[_ngcontent-%COMP%]{margin-bottom:15px}label[_ngcontent-%COMP%]{display:block;font-weight:700;color:#333}input[type=text][_ngcontent-%COMP%], input[type=date][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:calc(100% - 10px);padding:8px;font-size:16px;border:1px solid #ccc;border-radius:4px}input[type=date][_ngcontent-%COMP%]{-webkit-appearance:none;appearance:none}button[type=submit][_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px 20px;font-size:16px;border:none;border-radius:4px;cursor:pointer;transition:background-color .3s ease}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#0056b3}"]});let t=e;return t})();function u5(t,e){if(t&1&&(j(0,"div")(1,"p")(2,"strong"),$(3,"Nome do Pet:"),N(),$(4),N(),j(5,"p")(6,"strong"),$(7,"Nome do Cliente:"),N(),$(8),N(),j(9,"p")(10,"strong"),$(11,"CPF do Cliente:"),N(),$(12),N(),j(13,"p")(14,"strong"),$(15,"Data do Atendimento:"),N(),$(16),N(),j(17,"p")(18,"strong"),$(19,"Observa\xE7\xF5es:"),N(),$(20),N()()),t&2){let n=gt();se(4),kt(" ",n.atendimento.petName,""),se(4),kt(" ",n.atendimento.clienteName,""),se(4),kt(" ",n.atendimento.clienteCpf,""),se(4),kt(" ",n.atendimento.data,""),se(4),kt(" ",n.atendimento.observacoes,"")}}function l5(t,e){t&1&&(j(0,"div")(1,"p"),$(2,"Atendimento n\xE3o encontrado."),N()())}var yF=(()=>{let e=class e{constructor(r,i){this.route=r,this.atendimentoService=i,this.atendimento=null}ngOnInit(){this.obterDetalhesAtendimento()}obterDetalhesAtendimento(){let r=this.route.snapshot.paramMap.get("clienteCpf");if(r){let i=r;this.atendimentoService.buscarAtendimentoPorCpf(i).subscribe(s=>{s?this.atendimento=s:console.error("Atendimento n\xE3o encontrado.")})}else console.error("Par\xE2metro CPF n\xE3o encontrado.")}};e.\u0275fac=function(i){return new(i||e)(L(Zn),L(as))},e.\u0275cmp=sn({type:e,selectors:[["app-detalhamento-atendimento"]],decls:2,vars:2,consts:[[4,"ngIf"]],template:function(i,s){i&1&&ft(0,u5,21,5,"div",0)(1,l5,3,0,"div",0),i&2&&(Ne("ngIf",s.atendimento),se(),Ne("ngIf",!s.atendimento))},dependencies:[_r],styles:["p[_ngcontent-%COMP%]{margin-bottom:10px}strong[_ngcontent-%COMP%]{font-weight:700}.data[_ngcontent-%COMP%]{color:#333;font-size:16px;margin-bottom:5px}.petName[_ngcontent-%COMP%]{color:#007bff}.clienteName[_ngcontent-%COMP%]{color:#28a745}.dataAtendimento[_ngcontent-%COMP%]{color:#dc3545}.observacoes[_ngcontent-%COMP%]{color:#6c757d}"]});let t=e;return t})();function vF(){return t=>{let e=t.value||"";return/[A-Z]/.test(e)?null:{uppercase:!0}}}function d5(t,e){t&1&&(j(0,"small"),$(1,"O e-mail \xE9 obrigat\xF3rio."),N())}function h5(t,e){t&1&&(j(0,"small"),$(1,"O e-mail n\xE3o \xE9 v\xE1lido."),N())}function f5(t,e){if(t&1&&(j(0,"div"),ft(1,d5,2,0,"small",4)(2,h5,2,0,"small",4),N()),t&2){let n=gt(2),r,i;se(),Ne("ngIf",(r=n.authForm.get("email"))==null||r.errors==null?null:r.errors.required),se(),Ne("ngIf",(i=n.authForm.get("email"))==null||i.errors==null?null:i.errors.email)}}function p5(t,e){t&1&&(j(0,"small"),$(1,"A senha \xE9 obrigat\xF3ria."),N())}function g5(t,e){t&1&&(j(0,"small"),$(1,"A senha deve ter pelo menos 6 caracteres."),N())}function m5(t,e){t&1&&(j(0,"small"),$(1,"A senha deve conter pelo menos uma letra mai\xFAscula."),N())}function y5(t,e){if(t&1&&(j(0,"div"),ft(1,p5,2,0,"small",4)(2,g5,2,0,"small",4)(3,m5,2,0,"small",4),N()),t&2){let n=gt(2),r,i,s;se(),Ne("ngIf",(r=n.authForm.get("password"))==null||r.errors==null?null:r.errors.required),se(),Ne("ngIf",(i=n.authForm.get("password"))==null||i.errors==null?null:i.errors.minlength),se(),Ne("ngIf",(s=n.authForm.get("password"))==null||s.errors==null?null:s.errors.uppercase)}}function v5(t,e){if(t&1){let n=ya();j(0,"form",1),pt("ngSubmit",function(){Tn(n);let i=gt();return bn(i.submitForm())}),un(1,"input",2)(2,"input",3),ft(3,f5,3,2,"div",4)(4,y5,4,3,"div",4),j(5,"button",5),$(6),N(),j(7,"button",6),pt("click",function(){Tn(n);let i=gt();return bn(i.toggleMode())}),$(8),N()()}if(t&2){let n=gt(),r,i;Ne("formGroup",n.authForm),se(3),Ne("ngIf",(r=n.authForm.get("email"))==null?null:r.errors),se(),Ne("ngIf",(i=n.authForm.get("password"))==null?null:i.errors),se(2),Cu(n.isLoginMode?"Login":"Cadastrar"),se(2),kt(" ",n.isLoginMode?"N\xE3o tem uma conta? Clique aqui para se cadastrar.":"J\xE1 tem uma conta? Clique aqui para fazer login."," ")}}var _F=(()=>{let e=class e{constructor(r,i){this.authService=r,this.fb=i,this.email="",this.password="",this.isLoginMode=!0,this.authForm=this.fb.group({email:["",[Mn.required,Mn.email]],password:["",[Mn.required,Mn.minLength(6),vF()]]})}submitForm(){let r=this.authForm.value.email,i=this.authForm.value.password;this.isLoginMode?this.authService.login(r,i):this.authService.signUp(r,i)}toggleMode(){this.isLoginMode=!this.isLoginMode,this.authForm.reset()}};e.\u0275fac=function(i){return new(i||e)(L(cs),L(kp))},e.\u0275cmp=sn({type:e,selectors:[["app-auth"]],decls:1,vars:1,consts:[[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],["type","email","formControlName","email","placeholder","E-mail","required",""],["type","password","formControlName","password","placeholder","Senha","required",""],[4,"ngIf"],["type","submit"],["type","button",3,"click"]],template:function(i,s){i&1&&ft(0,v5,9,5,"form",0),i&2&&Ne("ngIf",s.authForm)},dependencies:[_r,La,Oi,Fa,Va,al,sl,ol],styles:["form[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh}input[_ngcontent-%COMP%]{margin-bottom:.5rem;padding:.5rem;border:1px solid #ccc;border-radius:5px;font-size:1rem;width:300px}button[_ngcontent-%COMP%]{margin-top:.5rem;margin-bottom:.5rem;padding:.5rem 1rem;background-color:#007bff;color:#fff;border:none;border-radius:5px;font-size:1rem;cursor:pointer}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}button[_ngcontent-%COMP%]:focus{outline:none}nav[_ngcontent-%COMP%]{background-color:#333;padding:10px 20px}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;margin-right:20px;transition:color .3s ease}nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#ff8c00}"]});let t=e;return t})();var Ad=(()=>{let e=class e{constructor(r,i){this.authService=r,this.router=i}canActivate(){return this.authService.user$.pipe($n(1),O(r=>r?!0:(this.router.navigate(["/login"]),!1)))}};e.\u0275fac=function(i){return new(i||e)(E(cs),E(Mt))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var _5=[{path:"cadastro",component:pF,canActivate:[Ad]},{path:"listagem",component:gF,canActivate:[Ad]},{path:"edicao/:clienteCpf",component:mF,canActivate:[Ad]},{path:"detalhamento/:id",component:yF,canActivate:[Ad]},{path:"login",component:_F},{path:"",redirectTo:"/login",pathMatch:"full"}],wF=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Le({type:e}),e.\u0275inj=je({imports:[cE.forRoot(_5),cE]});let t=e;return t})();var EF=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=sn({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(i,s){i&1&&un(0,"router-outlet")},dependencies:[tE],styles:['nav[_ngcontent-%COMP%]{background-color:#333;padding:10px 20px}nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#fff;text-decoration:none;margin-right:20px;transition:color .3s ease}nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#ff8c00}.content[_ngcontent-%COMP%]{background-image:url("./media/img-MNODQG6O.png");background-size:cover;background-position:center;padding:20px;color:#333}']});let t=e;return t})();var IF="@firebase/database",CF="1.0.3";var xT="";function MT(t){xT=t}var TD=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),et(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:hh(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var bD=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return vn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var eV=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new TD(e)}}catch{}return new bD},So=eV("localStorage"),AD=eV("sessionStorage");var Oc=new pi("@firebase/database"),tV=function(){let t=1;return function(){return t++}}(),nV=function(t){let e=Db(t),n=new Cb;n.update(e);let r=n.digest();return uh.encodeByteArray(r)},Zd=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Zd.apply(null,r):typeof r=="object"?e+=et(r):e+=r,e+=" "}return e},xo=null,DF=!0,rV=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Oc.logLevel=_n.VERBOSE,xo=Oc.log.bind(Oc),e&&AD.set("logging_enabled",!0)):typeof t=="function"?xo=t:(xo=null,AD.remove("logging_enabled"))},Tt=function(...t){if(DF===!0&&(DF=!1,xo===null&&AD.get("logging_enabled")===!0&&rV(!0)),xo){let e=Zd.apply(null,t);xo(e)}},Xd=function(t){return function(...e){Tt(t,...e)}},SD=function(...t){let e="FIREBASE INTERNAL ERROR: "+Zd(...t);Oc.error(e)},Vr=function(...t){let e=`FIREBASE FATAL ERROR: ${Zd(...t)}`;throw Oc.error(e),new Error(e)},Ut=function(...t){let e="FIREBASE WARNING: "+Zd(...t);Oc.warn(e)},w5=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Ut("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},cy=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},E5=function(t){if(ar()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},hs="[MIN_NAME]",di="[MAX_NAME]",Ro=function(t,e){if(t===e)return 0;if(t===hs||e===di)return-1;if(e===hs||t===di)return 1;{let n=TF(t),r=TF(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},I5=function(t,e){return t===e?0:t<e?-1:1},Sd=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+et(e))},RT=function(t){if(typeof t!="object"||t===null)return et(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=et(e[r]),n+=":",n+=RT(t[e[r]]);return n+="}",n},iV=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function bt(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var sV=function(t){D(!cy(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,c;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let u=[];for(c=n;c;c-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();let l=u.join(""),d="";for(c=0;c<64;c+=8){let h=parseInt(l.substr(c,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},C5=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},D5=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function T5(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var b5=new RegExp("^-?(0*)\\d{1,10}$"),A5=-2147483648,S5=2147483647,TF=function(t){if(b5.test(t)){let e=Number(t);if(e>=A5&&e<=S5)return e}return null},Hc=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw Ut("Exception was thrown by user callback.",n),e},Math.floor(0))}},x5=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Nd=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var xD=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Ut(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var MD=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Tt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Ut(e)}},Pd=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Fm="5",oV="v",aV="s",cV="r",uV="f",lV=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,dV="ls",hV="p",RD="ac",fV="websocket",pV="long_polling";var Vm=class{constructor(e,n,r,i,s=!1,o="",a=!1,c=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=c,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=So.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&So.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function M5(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function gV(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===fV)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===pV)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);M5(t)&&(n.ns=t.namespace);let i=[];return bt(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var ND=class{constructor(){this.counters_={}}incrementCounter(e,n=1){vn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return mb(this.counters_)}};var vD={},_D={};function NT(t){let e=t.toString();return vD[e]||(vD[e]=new ND),vD[e]}function R5(t,e){let n=t.toString();return _D[n]||(_D[n]=e()),_D[n]}var PD=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Hc(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var bF="start",N5="close",P5="pLPCommand",k5="pRTLPCB",mV="id",yV="pw",vV="ser",O5="cb",F5="seg",V5="ts",L5="d",j5="dframe",_V=1870,wV=30,U5=_V-wV,B5=25e3,$5=3e4,Vd=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Xd(e),this.stats_=NT(n),this.urlFn=c=>(this.appCheckToken&&(c[RD]=this.appCheckToken),gV(n,pV,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new PD(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor($5)),E5(()=>{if(this.isClosed_)return;this.scriptTagHolder=new kD((...s)=>{let[o,a,c,u,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===bF)this.id=a,this.password=c;else if(o===N5)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[bF]="t",r[vV]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[O5]=this.scriptTagHolder.uniqueCallbackIdentifier),r[oV]=Fm,this.transportSessionId&&(r[aV]=this.transportSessionId),this.lastSessionId&&(r[dV]=this.lastSessionId),this.applicationId&&(r[hV]=this.applicationId),this.appCheckToken&&(r[RD]=this.appCheckToken),typeof location<"u"&&location.hostname&&lV.test(location.hostname)&&(r[cV]=uV);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return ar()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!C5()&&!D5()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=et(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=gb(n),i=iV(r,U5);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(ar())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[j5]="t",r[mV]=e,r[yV]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=et(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},kD=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,ar())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=tV(),window[P5+this.uniqueCallbackIdentifier]=e,window[k5+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Tt("frame writing exception"),a.stack&&Tt(a.stack),Tt(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Tt("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[mV]=this.myID,e[yV]=this.myPW,e[vV]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+wV+r.length<=_V;){let o=this.pendingSegs.shift();r=r+"&"+F5+i+"="+o.seg+"&"+V5+i+"="+o.ts+"&"+L5+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(B5)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){ar()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{Tt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var q5=16384,H5=45e3,Lm=null;typeof MozWebSocket<"u"?Lm=MozWebSocket:typeof WebSocket<"u"&&(Lm=WebSocket);var Pc=(()=>{class t{constructor(n,r,i,s,o,a,c){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Xd(this.connId),this.stats_=NT(r),this.connURL=t.connectionURL_(r,a,c,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[oV]=Fm,!ar()&&typeof location<"u"&&location.hostname&&lV.test(location.hostname)&&(a[cV]=uV),r&&(a[aV]=r),i&&(a[dV]=i),s&&(a[RD]=s),o&&(a[hV]=o),gV(n,fV,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,So.set("previous_websocket_failure",!0);try{let i;if(ar()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Fm}/${xT}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Lm(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Lm!==null&&!t.forceDisallow_}static previouslyFailed(){return So.isInMemoryStorage||So.get("previous_websocket_failure")===!0}markConnectionHealthy(){So.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=hh(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(D(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=et(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=iV(r,q5);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(H5))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),EV=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Vd,Pc]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Pc&&Pc.isAvailable(),i=r&&!Pc.previouslyFailed();if(n.webSocketOnly&&(r||Ut("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Pc];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),G5=6e4,z5=5e3,W5=10*1024,K5=100*1024,wD="t",AF="d",Q5="s",SF="r",Y5="e",xF="o",MF="a",RF="n",NF="p",Z5="h",OD=class{constructor(e,n,r,i,s,o,a,c,u,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=u,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Xd("c:"+this.id+":"),this.transportManager_=new EV(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Nd(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>K5?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>W5?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(wD in e){let n=e[wD];n===MF?this.upgradeIfSecondaryHealthy_():n===SF?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===xF&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=Sd("t",e),r=Sd("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:NF,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:MF,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:RF,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=Sd("t",e),r=Sd("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=Sd(wD,e);if(AF in e){let r=e[AF];if(n===Z5){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===RF){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Q5?this.onConnectionShutdown_(r):n===SF?this.onReset_(r):n===Y5?SD("Server Error: "+r):n===xF?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):SD("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Fm!==r&&Ut("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Nd(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(G5))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Nd(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(z5))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:NF,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(So.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var jm=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Um=class{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Bm=class t extends Um{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!My()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var PF=32,kF=768,we=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function _e(){return new we("")}function oe(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function fs(t){return t.pieces_.length-t.pieceNum_}function Me(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new we(t.pieces_,e)}function PT(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function X5(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Ld(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function IV(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new we(e,0)}function Be(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof we)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new we(n,0)}function ae(t){return t.pieceNum_>=t.pieces_.length}function Zt(t,e){let n=oe(t),r=oe(e);if(n===null)return e;if(n===r)return Zt(Me(t),Me(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function J5(t,e){let n=Ld(t,0),r=Ld(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=Ro(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function kT(t,e){if(fs(t)!==fs(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function Fn(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(fs(t)>fs(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var FD=class{constructor(e,n){this.errorPrefix_=n,this.parts_=Ld(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=Zc(this.parts_[r]);CV(this)}};function e6(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Zc(e),CV(t)}function t6(t){let e=t.parts_.pop();t.byteLength_-=Zc(e),t.parts_.length>0&&(t.byteLength_-=1)}function CV(t){if(t.byteLength_>kF)throw new Error(t.errorPrefix_+"has a key path longer than "+kF+" bytes ("+t.byteLength_+").");if(t.parts_.length>PF)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+PF+") or object contains a cycle "+Ao(t))}function Ao(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var VD=class t extends Um{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}};var xd=1e3,n6=60*5*1e3,OF=30*1e3,r6=1.3,i6=3e4,s6="server_kill",FF=3,OT=(()=>{class t extends jm{constructor(n,r,i,s,o,a,c,u){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=c,this.authOverride_=u,this.id=t.nextPersistentConnectionId_++,this.log_=Xd("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=xd,this.maxReconnectDelay_=n6,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!ar())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");VD.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Bm.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(et(o)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new yt,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let c=a.d;a.s==="ok"?r.resolve(c):r.reject(c)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let c={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,c),this.connected_&&this.sendListen_(c)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,c=>{let u=c.d,l=c.s;t.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",c),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,u))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&vn(n,"w")){let i=fi(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Ut(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||Eb(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=OF)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=wb(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let c=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(c):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+et(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):SD("Unrecognized action received from server: "+et(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xd,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=xd,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>i6&&(this.reconnectDelay_=xd),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*r6)}this.onConnectStatus_(!1)}establishConnection_(){return _(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,c=null,u=function(){c?c.close():(a=!0,i())},l=function(h){D(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(h)};this.realtime_={close:u,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?Tt("getToken() completed but was canceled"):(Tt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,c=new OD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{Ut(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(s6)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&Ut(h),u())}}})}interrupt(n){Tt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){Tt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],fh(this.interruptReasons_)&&(this.reconnectDelay_=xd,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>RT(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new we(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){Tt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=FF&&(this.reconnectDelay_=OF,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){Tt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=FF&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";ar()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+xT.replace(/\./g,"-")]=1,My()?n["framework.cordova"]=1:yb()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Bm.getInstance().currentlyOnline();return fh(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),ue=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var Fc=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new ue(hs,e),i=new ue(hs,n);return this.compare(r,i)!==0}minPost(){return ue.MIN}};var Om,$m=class extends Fc{static get __EMPTY_NODE(){return Om}static set __EMPTY_NODE(e){Om=e}compare(e,n){return Ro(e.name,n.name)}isDefinedOn(e){throw Fo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return ue.MIN}maxPost(){return new ue(di,Om)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new ue(e,Om)}toString(){return".key"}},Fr=new $m;var kc=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},sr=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Vn.EMPTY_NODE,this.right=o??Vn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Vn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Vn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),LD=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new sr(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Vn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,sr.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,sr.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new kc(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new kc(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new kc(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new kc(this.root_,null,this.comparator_,!0,e)}};Vn.EMPTY_NODE=new LD;function o6(t,e){return Ro(t.name,e.name)}function FT(t,e){return Ro(t,e)}var jD;function a6(t){jD=t}var DV=function(t){return typeof t=="number"?"number:"+sV(t):"string:"+t},TV=function(t){if(t.isLeafNode()){let e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&vn(e,".sv"),"Priority must be a string or number.")}else D(t===jD||t.isEmpty(),"priority of unexpected type.");D(t===jD||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var VF,Vc=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),TV(this.priorityNode_)}static set __childrenNodeConstructor(n){VF=n}static get __childrenNodeConstructor(){return VF}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return ae(n)?this:oe(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=oe(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(D(i!==".priority"||fs(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Me(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+DV(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=sV(this.value_):n+=this.value_,this.lazyHash_=nV(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(D(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return D(s>=0,"Unknown leaf type: "+r),D(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),bV,AV;function c6(t){bV=t}function u6(t){AV=t}var UD=class extends Fc{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?Ro(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return ue.MIN}maxPost(){return new ue(di,new Vc("[PRIORITY-POST]",AV))}makePost(e,n){let r=bV(e);return new ue(n,new Vc("[PRIORITY-POST]",r))}toString(){return".priority"}},ke=new UD;var l6=Math.log(2),BD=class{constructor(e){let n=s=>parseInt(Math.log(s)/l6,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},qm=function(t,e,n,r){t.sort(e);let i=function(c,u){let l=u-c,d,h;if(l===0)return null;if(l===1)return d=t[c],h=n?n(d):d,new sr(h,d.node,sr.BLACK,null,null);{let f=parseInt(l/2,10)+c,p=i(c,f),g=i(f+1,u);return d=t[f],h=n?n(d):d,new sr(h,d.node,sr.BLACK,p,g)}},s=function(c){let u=null,l=null,d=t.length,h=function(p,g){let m=d-p,w=d;d-=p;let P=i(m+1,w),T=t[m],V=n?n(T):T;f(new sr(V,T.node,g,null,P))},f=function(p){u?(u.left=p,u=p):(l=p,u=p)};for(let p=0;p<c.count;++p){let g=c.nextBitIsOne(),m=Math.pow(2,c.count-(p+1));g?h(m,sr.BLACK):(h(m,sr.BLACK),h(m,sr.RED))}return l},o=new BD(t.length),a=s(o);return new Vn(r||e,a)};var ED,Nc={},Lc=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(Nc&&ke,"ChildrenNode.ts has not been loaded"),ED=ED||new t({".priority":Nc},{".priority":ke}),ED}get(e){let n=fi(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Vn?n:null}hasIndex(e){return vn(this.indexSet_,e.toString())}addIndex(e,n){D(e!==Fr,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(ue.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=qm(r,e.getCompare()):a=Nc;let c=e.toString(),u=Object.assign({},this.indexSet_);u[c]=e;let l=Object.assign({},this.indexes_);return l[c]=a,new t(l,u)}addToIndexes(e,n){let r=Yc(this.indexes_,(i,s)=>{let o=fi(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===Nc)if(o.isDefinedOn(e.node)){let a=[],c=n.getIterator(ue.Wrap),u=c.getNext();for(;u;)u.name!==e.name&&a.push(u),u=c.getNext();return a.push(e),qm(a,o.getCompare())}else return Nc;else{let a=n.get(e.name),c=i;return a&&(c=c.remove(new ue(e.name,a))),c.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=Yc(this.indexes_,i=>{if(i===Nc)return i;{let s=n.get(e.name);return s?i.remove(new ue(e.name,s)):i}});return new t(r,this.indexSet_)}};var Md,ee=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&TV(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Md||(Md=new t(new Vn(FT),null,Lc.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Md}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Md:r}}getChild(n){let r=oe(n);return r===null?this:this.getImmediateChild(r).getChild(Me(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(D(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new ue(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Md:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=oe(n);if(i===null)return r;{D(oe(n)!==".priority"||fs(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(Me(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(ke,(a,c)=>{r[a]=c.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let c in r)a[c]=r[c];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+DV(this.getPriority().val())+":"),this.forEachChild(ke,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":nV(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new ue(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new ue(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new ue(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,ue.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,ue.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===Jd?-1:0}withIndex(n){if(n===Fr||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===Fr||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(ke),s=r.getIterator(ke),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===Fr?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),$D=class extends ee{constructor(){super(new Vn(FT),ee.EMPTY_NODE,Lc.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ee.EMPTY_NODE}isEmpty(){return!1}},Jd=new $D;Object.defineProperties(ue,{MIN:{value:new ue(hs,ee.EMPTY_NODE)},MAX:{value:new ue(di,Jd)}});$m.__EMPTY_NODE=ee.EMPTY_NODE;Vc.__childrenNodeConstructor=ee;a6(Jd);u6(Jd);var d6=!0;function qe(t,e=null){if(t===null)return ee.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new Vc(n,qe(e))}if(!(t instanceof Array)&&d6){let n=[],r=!1;if(bt(t,(o,a)=>{if(o.substring(0,1)!=="."){let c=qe(a);c.isEmpty()||(r=r||!c.getPriority().isEmpty(),n.push(new ue(o,c)))}}),n.length===0)return ee.EMPTY_NODE;let s=qm(n,o6,o=>o.name,FT);if(r){let o=qm(n,ke.getCompare());return new ee(s,qe(e),new Lc({".priority":o},{".priority":ke}))}else return new ee(s,qe(e),Lc.Default)}else{let n=ee.EMPTY_NODE;return bt(t,(r,i)=>{if(vn(t,r)&&r.substring(0,1)!=="."){let s=qe(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(qe(e))}}c6(qe);var jd=class extends Fc{constructor(e){super(),this.indexPath_=e,D(!ae(e)&&oe(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?Ro(e.name,n.name):s}makePost(e,n){let r=qe(e),i=ee.EMPTY_NODE.updateChild(this.indexPath_,r);return new ue(n,i)}maxPost(){let e=ee.EMPTY_NODE.updateChild(this.indexPath_,Jd);return new ue(di,e)}toString(){return Ld(this.indexPath_,0).join("/")}};var qD=class extends Fc{compare(e,n){let r=e.node.compareTo(n.node);return r===0?Ro(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return ue.MIN}maxPost(){return ue.MAX}makePost(e,n){let r=qe(e);return new ue(n,r)}toString(){return".value"}},VT=new qD;function SV(t){return{type:"value",snapshotNode:t}}function jc(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ud(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Bd(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function h6(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var $d=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(Ud(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(jc(n,r)):o.trackChildChange(Bd(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(ke,(i,s)=>{n.hasChild(i)||r.trackChildChange(Ud(i,s))}),n.isLeafNode()||n.forEachChild(ke,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Bd(i,s,o))}else r.trackChildChange(jc(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ee.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Hm=class t{constructor(e){this.indexedFilter_=new $d(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new ue(n,r))||(r=ee.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=ee.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(ee.EMPTY_NODE);let s=this;return n.forEachChild(ke,(o,a)=>{s.matches(new ue(o,a))||(i=i.updateImmediateChild(o,ee.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var HD=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Hm(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new ue(n,r))||(r=ee.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=ee.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=ee.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(ee.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,ee.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;D(a.numChildren()===this.limit_,"");let c=new ue(n,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(c);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,u,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,c);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(Bd(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(Ud(n,d));let g=a.updateImmediateChild(n,ee.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(jc(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(u,c)>=0?(s!=null&&(s.trackChildChange(Ud(u.name,u.node)),s.trackChildChange(jc(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(u.name,ee.EMPTY_NODE)):e}};var qd=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ke}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:hs}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:di}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===ke}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function f6(t){return t.loadsAllData()?new $d(t.getIndex()):t.hasLimit()?new HD(t):new Hm(t)}function p6(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function g6(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function GD(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function m6(t,e,n){let r;return t.index_===Fr||n?r=GD(t,e,n):r=GD(t,e,di),r.startAfterSet_=!0,r}function zD(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function y6(t,e,n){let r;return t.index_===Fr||n?r=zD(t,e,n):r=zD(t,e,hs),r.endBeforeSet_=!0,r}function uy(t,e){let n=t.copy();return n.index_=e,n}function LF(t){let e={};if(t.isDefault())return e;let n;if(t.index_===ke?n="$priority":t.index_===VT?n="$value":t.index_===Fr?n="$key":(D(t.index_ instanceof jd,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=et(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=et(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+et(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=et(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+et(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function jF(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==ke&&(e.i=t.index_.toString()),e}var WD=class t extends jm{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Xd("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let c=LF(e._queryParams);this.restRequest_(s+".json",c,(u,l)=>{let d=l;if(u===404&&(d=null,u=null),u===null&&this.onDataUpdate_(s,d,!1,r),fi(this.listens_,o)===a){let h;u?u===401?h="permission_denied":h="rest_error:"+u:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=LF(e._queryParams),r=e._path.toString(),i=new yt;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Ib(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=hh(a.responseText)}catch{Ut("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,c)}else a.status!==401&&a.status!==404&&Ut("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var KD=class{constructor(){this.rootNode_=ee.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Gm(){return{value:null,children:new Map}}function Gc(t,e,n){if(ae(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=oe(e);t.children.has(r)||t.children.set(r,Gm());let i=t.children.get(r);e=Me(e),Gc(i,e,n)}}function QD(t,e){if(ae(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(ke,(r,i)=>{Gc(t,new we(r),i)}),QD(t,e)}}else if(t.children.size>0){let n=oe(e);return e=Me(e),t.children.has(n)&&QD(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function YD(t,e,n){t.value!==null?n(e,t.value):v6(t,(r,i)=>{let s=new we(e.toString()+"/"+r);YD(i,s,n)})}function v6(t,e){t.children.forEach((n,r)=>{e(r,n)})}var ZD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&bt(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var UF=10*1e3,_6=30*1e3,w6=5*60*1e3,XD=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new ZD(e);let r=UF+(_6-UF)*Math.random();Nd(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;bt(e,(i,s)=>{s>0&&vn(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Nd(this.reportStats_.bind(this),Math.floor(Math.random()*2*w6))}};var Or=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(Or||{});function LT(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function jT(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function UT(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var JD=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Or.ACK_USER_WRITE,this.source=LT()}operationForChild(e){if(ae(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new we(e));return new t(_e(),n,this.revert)}}else return D(oe(this.path)===e,"operationForChild called for unrelated child."),new t(Me(this.path),this.affectedTree,this.revert)}};var zm=class t{constructor(e,n){this.source=e,this.path=n,this.type=Or.LISTEN_COMPLETE}operationForChild(e){return ae(this.path)?new t(this.source,_e()):new t(this.source,Me(this.path))}};var Uc=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Or.OVERWRITE}operationForChild(e){return ae(this.path)?new t(this.source,_e(),this.snap.getImmediateChild(e)):new t(this.source,Me(this.path),this.snap)}};var Hd=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Or.MERGE}operationForChild(e){if(ae(this.path)){let n=this.children.subtree(new we(e));return n.isEmpty()?null:n.value?new Uc(this.source,_e(),n.value):new t(this.source,_e(),n)}else return D(oe(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Me(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var Lr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(ae(e))return this.isFullyInitialized()&&!this.filtered_;let n=oe(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var eT=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function E6(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(h6(o.childName,o.snapshotNode))}),Rd(t,i,"child_removed",e,r,n),Rd(t,i,"child_added",e,r,n),Rd(t,i,"child_moved",s,r,n),Rd(t,i,"child_changed",e,r,n),Rd(t,i,"value",e,r,n),i}function Rd(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,c)=>C6(t,a,c)),o.forEach(a=>{let c=I6(t,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(c,t.query_))})})}function I6(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function C6(t,e,n){if(e.childName==null||n.childName==null)throw Fo("Should only compare child_ events.");let r=new ue(e.childName,e.snapshotNode),i=new ue(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function ly(t,e){return{eventCache:t,serverCache:e}}function kd(t,e,n,r){return ly(new Lr(e,n,r),t.serverCache)}function xV(t,e,n,r){return ly(t.eventCache,new Lr(e,n,r))}function Wm(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Mo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var ID,D6=()=>(ID||(ID=new Vn(I5)),ID),Xt=class t{constructor(e,n=D6()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return bt(e,(r,i)=>{n=n.set(new we(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:_e(),value:this.value};if(ae(e))return null;{let r=oe(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(Me(e),n);return s!=null?{path:Be(new we(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(ae(e))return this;{let n=oe(e),r=this.children.get(n);return r!==null?r.subtree(Me(e)):new t(null)}}set(e,n){if(ae(e))return new t(n,this.children);{let r=oe(e),s=(this.children.get(r)||new t(null)).set(Me(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(ae(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=oe(e),r=this.children.get(n);if(r){let i=r.remove(Me(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(ae(e))return this.value;{let n=oe(e),r=this.children.get(n);return r?r.get(Me(e)):null}}setTree(e,n){if(ae(e))return n;{let r=oe(e),s=(this.children.get(r)||new t(null)).setTree(Me(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(_e(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Be(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,_e(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(ae(e))return null;{let s=oe(e),o=this.children.get(s);return o?o.findOnPath_(Me(e),Be(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,_e(),n)}foreachOnPath_(e,n,r){if(ae(e))return this;{this.value&&r(n,this.value);let i=oe(e),s=this.children.get(i);return s?s.foreachOnPath_(Me(e),Be(n,i),r):new t(null)}}foreach(e){this.foreach_(_e(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(Be(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var or=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Xt(null))}};function Od(t,e,n){if(ae(e))return new or(new Xt(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Zt(i,e);return s=s.updateChild(o,n),new or(t.writeTree_.set(i,s))}else{let i=new Xt(n),s=t.writeTree_.setTree(e,i);return new or(s)}}}function tT(t,e,n){let r=t;return bt(n,(i,s)=>{r=Od(r,Be(e,i),s)}),r}function BF(t,e){if(ae(e))return or.empty();{let n=t.writeTree_.setTree(e,new Xt(null));return new or(n)}}function nT(t,e){return No(t,e)!=null}function No(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Zt(n.path,e)):null}function $F(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(ke,(r,i)=>{e.push(new ue(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new ue(r,i.value))}),e}function ls(t,e){if(ae(e))return t;{let n=No(t,e);return n!=null?new or(new Xt(n)):new or(t.writeTree_.subtree(e))}}function rT(t){return t.writeTree_.isEmpty()}function Bc(t,e){return MV(_e(),t.writeTree_,e)}function MV(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=MV(Be(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Be(t,".priority"),r)),n}}function dy(t,e){return kV(e,t)}function T6(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Od(t.visibleWrites,e,n)),t.lastWriteId=r}function b6(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=tT(t.visibleWrites,e,n),t.lastWriteId=r}function A6(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function S6(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&x6(a,r.path)?i=!1:Fn(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return M6(t),!0;if(r.snap)t.visibleWrites=BF(t.visibleWrites,r.path);else{let a=r.children;bt(a,c=>{t.visibleWrites=BF(t.visibleWrites,Be(r.path,c))})}return!0}else return!1}function x6(t,e){if(t.snap)return Fn(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&Fn(Be(t.path,n),e))return!0;return!1}function M6(t){t.visibleWrites=RV(t.allWrites,R6,_e()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function R6(t){return t.visible}function RV(t,e,n){let r=or.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)Fn(n,o)?(a=Zt(n,o),r=Od(r,a,s.snap)):Fn(o,n)&&(a=Zt(o,n),r=Od(r,_e(),s.snap.getChild(a)));else if(s.children){if(Fn(n,o))a=Zt(n,o),r=tT(r,a,s.children);else if(Fn(o,n))if(a=Zt(o,n),ae(a))r=tT(r,_e(),s.children);else{let c=fi(s.children,oe(a));if(c){let u=c.getChild(Me(a));r=Od(r,_e(),u)}}}else throw Fo("WriteRecord should have .snap or .children")}}return r}function NV(t,e,n,r,i){if(!r&&!i){let s=No(t.visibleWrites,e);if(s!=null)return s;{let o=ls(t.visibleWrites,e);if(rT(o))return n;if(n==null&&!nT(o,_e()))return null;{let a=n||ee.EMPTY_NODE;return Bc(o,a)}}}else{let s=ls(t.visibleWrites,e);if(!i&&rT(s))return n;if(!i&&n==null&&!nT(s,_e()))return null;{let o=function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(Fn(u.path,e)||Fn(e,u.path))},a=RV(t.allWrites,o,e),c=n||ee.EMPTY_NODE;return Bc(a,c)}}}function N6(t,e,n){let r=ee.EMPTY_NODE,i=No(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ke,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=ls(t.visibleWrites,e);return n.forEachChild(ke,(o,a)=>{let c=Bc(ls(s,new we(o)),a);r=r.updateImmediateChild(o,c)}),$F(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=ls(t.visibleWrites,e);return $F(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function P6(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=Be(e,n);if(nT(t.visibleWrites,s))return null;{let o=ls(t.visibleWrites,s);return rT(o)?i.getChild(n):Bc(o,i.getChild(n))}}function k6(t,e,n,r){let i=Be(e,n),s=No(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=ls(t.visibleWrites,i);return Bc(o,r.getNode().getImmediateChild(n))}else return null}function O6(t,e){return No(t.visibleWrites,e)}function F6(t,e,n,r,i,s,o){let a,c=ls(t.visibleWrites,e),u=No(c,_e());if(u!=null)a=u;else if(n!=null)a=Bc(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function V6(){return{visibleWrites:or.empty(),allWrites:[],lastWriteId:-1}}function Km(t,e,n,r){return NV(t.writeTree,t.treePath,e,n,r)}function BT(t,e){return N6(t.writeTree,t.treePath,e)}function qF(t,e,n,r){return P6(t.writeTree,t.treePath,e,n,r)}function Qm(t,e){return O6(t.writeTree,Be(t.treePath,e))}function L6(t,e,n,r,i,s){return F6(t.writeTree,t.treePath,e,n,r,i,s)}function $T(t,e,n){return k6(t.writeTree,t.treePath,e,n)}function PV(t,e){return kV(Be(t.treePath,e),t.writeTree)}function kV(t,e){return{treePath:t,writeTree:e}}var iT=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Bd(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,Ud(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,jc(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Bd(r,e.snapshotNode,i.oldSnap));else throw Fo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var sT=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},OV=new sT,Gd=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new Lr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return $T(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Mo(this.viewCache_),s=L6(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function j6(t){return{filter:t}}function U6(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function B6(t,e,n,r,i){let s=new iT,o,a;if(n.type===Or.OVERWRITE){let u=n;u.source.fromUser?o=oT(t,e,u.path,u.snap,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!ae(u.path),o=Ym(t,e,u.path,u.snap,r,i,a,s))}else if(n.type===Or.MERGE){let u=n;u.source.fromUser?o=q6(t,e,u.path,u.children,r,i,s):(D(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=aT(t,e,u.path,u.children,r,i,a,s))}else if(n.type===Or.ACK_USER_WRITE){let u=n;u.revert?o=z6(t,e,u.path,r,i,s):o=H6(t,e,u.path,u.affectedTree,r,i,s)}else if(n.type===Or.LISTEN_COMPLETE)o=G6(t,e,n.path,r,s);else throw Fo("Unknown operation type: "+n.type);let c=s.getChanges();return $6(e,o,c),{viewCache:o,changes:c}}function $6(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Wm(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(SV(Wm(e)))}}function FV(t,e,n,r,i,s){let o=e.eventCache;if(Qm(r,n)!=null)return e;{let a,c;if(ae(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let u=Mo(e),l=u instanceof ee?u:ee.EMPTY_NODE,d=BT(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let u=Km(r,Mo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{let u=oe(n);if(u===".priority"){D(fs(n)===1,"Can't have a priority with additional path components");let l=o.getNode();c=e.serverCache.getNode();let d=qF(r,n,l,c);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=Me(n),d;if(o.isCompleteForChild(u)){c=e.serverCache.getNode();let h=qF(r,n,o.getNode(),c);h!=null?d=o.getNode().getImmediateChild(u).updateChild(l,h):d=o.getNode().getImmediateChild(u)}else d=$T(r,u,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),u,d,l,i,s):a=o.getNode()}}return kd(e,a,o.isFullyInitialized()||ae(n),t.filter.filtersNodes())}}function Ym(t,e,n,r,i,s,o,a){let c=e.serverCache,u,l=o?t.filter:t.filter.getIndexedFilter();if(ae(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){let f=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),f,null)}else{let f=oe(n);if(!c.isCompleteForPath(n)&&fs(n)>1)return e;let p=Me(n),m=c.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?u=l.updatePriority(c.getNode(),m):u=l.updateChild(c.getNode(),f,m,p,OV,null)}let d=xV(e,u,c.isFullyInitialized()||ae(n),l.filtersNodes()),h=new Gd(i,d,s);return FV(t,d,n,i,h,a)}function oT(t,e,n,r,i,s,o){let a=e.eventCache,c,u,l=new Gd(i,e,s);if(ae(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,o),c=kd(e,u,!0,t.filter.filtersNodes());else{let d=oe(n);if(d===".priority")u=t.filter.updatePriority(e.eventCache.getNode(),r),c=kd(e,u,a.isFullyInitialized(),a.isFiltered());else{let h=Me(n),f=a.getNode().getImmediateChild(d),p;if(ae(h))p=r;else{let g=l.getCompleteChild(d);g!=null?PT(h)===".priority"&&g.getChild(IV(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=ee.EMPTY_NODE}if(f.equals(p))c=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);c=kd(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function HF(t,e){return t.eventCache.isCompleteForChild(e)}function q6(t,e,n,r,i,s,o){let a=e;return r.foreach((c,u)=>{let l=Be(n,c);HF(e,oe(l))&&(a=oT(t,a,l,u,i,s,o))}),r.foreach((c,u)=>{let l=Be(n,c);HF(e,oe(l))||(a=oT(t,a,l,u,i,s,o))}),a}function GF(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function aT(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,u;ae(n)?u=r:u=new Xt(null).setTree(n,r);let l=e.serverCache.getNode();return u.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=GF(t,f,h);c=Ym(t,c,new we(d),p,i,s,o,a)}}),u.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=GF(t,p,h);c=Ym(t,c,new we(d),g,i,s,o,a)}}),c}function H6(t,e,n,r,i,s,o){if(Qm(i,n)!=null)return e;let a=e.serverCache.isFiltered(),c=e.serverCache;if(r.value!=null){if(ae(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Ym(t,e,n,c.getNode().getChild(n),i,s,a,o);if(ae(n)){let u=new Xt(null);return c.getNode().forEachChild(Fr,(l,d)=>{u=u.set(new we(l),d)}),aT(t,e,n,u,i,s,a,o)}else return e}else{let u=new Xt(null);return r.foreach((l,d)=>{let h=Be(n,l);c.isCompleteForPath(h)&&(u=u.set(l,c.getNode().getChild(h)))}),aT(t,e,n,u,i,s,a,o)}}function G6(t,e,n,r,i){let s=e.serverCache,o=xV(e,s.getNode(),s.isFullyInitialized()||ae(n),s.isFiltered());return FV(t,o,n,r,OV,i)}function z6(t,e,n,r,i,s){let o;if(Qm(r,n)!=null)return e;{let a=new Gd(r,e,i),c=e.eventCache.getNode(),u;if(ae(n)||oe(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=Km(r,Mo(e));else{let d=e.serverCache.getNode();D(d instanceof ee,"serverChildren would be complete if leaf node"),l=BT(r,d)}l=l,u=t.filter.updateFullNode(c,l,s)}else{let l=oe(n),d=$T(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=c.getImmediateChild(l)),d!=null?u=t.filter.updateChild(c,l,d,Me(n),a,s):e.eventCache.getNode().hasChild(l)?u=t.filter.updateChild(c,l,ee.EMPTY_NODE,Me(n),a,s):u=c,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Km(r,Mo(e)),o.isLeafNode()&&(u=t.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||Qm(r,_e())!=null,kd(e,u,o,t.filter.filtersNodes())}}var cT=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new $d(r.getIndex()),s=f6(r);this.processor_=j6(s);let o=n.serverCache,a=n.eventCache,c=i.updateFullNode(ee.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(ee.EMPTY_NODE,a.getNode(),null),l=new Lr(c,o.isFullyInitialized(),i.filtersNodes()),d=new Lr(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=ly(d,l),this.eventGenerator_=new eT(this.query_)}get query(){return this.query_}};function W6(t){return t.viewCache_.serverCache.getNode()}function K6(t){return Wm(t.viewCache_)}function Q6(t,e){let n=Mo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!ae(e)&&!n.getImmediateChild(oe(e)).isEmpty())?n.getChild(e):null}function zF(t){return t.eventRegistrations_.length===0}function Y6(t,e){t.eventRegistrations_.push(e)}function WF(t,e,n){let r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function KF(t,e,n,r){e.type===Or.MERGE&&e.source.queryId!==null&&(D(Mo(t.viewCache_),"We should always have a full cache before handling merges"),D(Wm(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=B6(t.processor_,i,e,n,r);return U6(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,VV(t,s.changes,s.viewCache.eventCache.getNode(),null)}function Z6(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ke,(s,o)=>{r.push(jc(s,o))}),n.isFullyInitialized()&&r.push(SV(n.getNode())),VV(t,r,n.getNode(),e)}function VV(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return E6(t.eventGenerator_,e,n,i)}var Zm,Xm=class{constructor(){this.views=new Map}};function X6(t){D(!Zm,"__referenceConstructor has already been defined"),Zm=t}function J6(){return D(Zm,"Reference.ts has not been loaded"),Zm}function e8(t){return t.views.size===0}function qT(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),KF(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(KF(o,e,n,r));return s}}function LV(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Km(n,i?r:null),c=!1;a?c=!0:r instanceof ee?(a=BT(n,r),c=!1):(a=ee.EMPTY_NODE,c=!1);let u=ly(new Lr(a,c,!1),new Lr(r,i,!1));return new cT(e,u)}return o}function t8(t,e,n,r,i,s){let o=LV(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),Y6(o,n),Z6(o,n)}function n8(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=ps(t);if(i==="default")for(let[c,u]of t.views.entries())o=o.concat(WF(u,n,r)),zF(u)&&(t.views.delete(c),u.query._queryParams.loadsAllData()||s.push(u.query));else{let c=t.views.get(i);c&&(o=o.concat(WF(c,n,r)),zF(c)&&(t.views.delete(i),c.query._queryParams.loadsAllData()||s.push(c.query)))}return a&&!ps(t)&&s.push(new(J6())(e._repo,e._path)),{removed:s,events:o}}function jV(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ds(t,e){let n=null;for(let r of t.views.values())n=n||Q6(r,e);return n}function UV(t,e){if(e._queryParams.loadsAllData())return hy(t);{let r=e._queryIdentifier;return t.views.get(r)}}function BV(t,e){return UV(t,e)!=null}function ps(t){return hy(t)!=null}function hy(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Jm;function r8(t){D(!Jm,"__referenceConstructor has already been defined"),Jm=t}function i8(){return D(Jm,"Reference.ts has not been loaded"),Jm}var s8=1,ey=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Xt(null),this.pendingWriteTree_=V6(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function HT(t,e,n,r,i){return T6(t.pendingWriteTree_,e,n,r,i),i?zc(t,new Uc(LT(),e,n)):[]}function o8(t,e,n,r){b6(t.pendingWriteTree_,e,n,r);let i=Xt.fromObject(n);return zc(t,new Hd(LT(),e,i))}function us(t,e,n=!1){let r=A6(t.pendingWriteTree_,e);if(S6(t.pendingWriteTree_,e)){let s=new Xt(null);return r.snap!=null?s=s.set(_e(),!0):bt(r.children,o=>{s=s.set(new we(o),!0)}),zc(t,new JD(r.path,s,n))}else return[]}function eh(t,e,n){return zc(t,new Uc(jT(),e,n))}function a8(t,e,n){let r=Xt.fromObject(n);return zc(t,new Hd(jT(),e,r))}function c8(t,e){return zc(t,new zm(jT(),e))}function u8(t,e,n){let r=GT(t,n);if(r){let i=zT(r),s=i.path,o=i.queryId,a=Zt(s,e),c=new zm(UT(o),a);return WT(t,s,c)}else return[]}function ty(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||BV(o,e))){let c=n8(o,e,n,r);e8(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let u=c.removed;if(a=c.events,!i){let l=u.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>ps(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=h8(h);for(let p=0;p<f.length;++p){let g=f[p],m=g.query,w=GV(t,g);t.listenProvider_.startListening(Fd(m),zd(t,m),w.hashFn,w.onComplete)}}}!d&&u.length>0&&!r&&(l?t.listenProvider_.stopListening(Fd(e),null):u.forEach(h=>{let f=t.queryToTagMap.get(py(h));t.listenProvider_.stopListening(Fd(h),f)}))}f8(t,u)}return a}function $V(t,e,n,r){let i=GT(t,r);if(i!=null){let s=zT(i),o=s.path,a=s.queryId,c=Zt(o,e),u=new Uc(UT(a),c,n);return WT(t,o,u)}else return[]}function l8(t,e,n,r){let i=GT(t,r);if(i){let s=zT(i),o=s.path,a=s.queryId,c=Zt(o,e),u=Xt.fromObject(n),l=new Hd(UT(a),c,u);return WT(t,o,l)}else return[]}function uT(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Zt(h,i);s=s||ds(f,p),o=o||ps(f)});let a=t.syncPointTree_.get(i);a?(o=o||ps(a),s=s||ds(a,_e())):(a=new Xm,t.syncPointTree_=t.syncPointTree_.set(i,a));let c;s!=null?c=!0:(c=!1,s=ee.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=ds(p,_e());g&&(s=s.updateImmediateChild(f,g))}));let u=BV(a,e);if(!u&&!e._queryParams.loadsAllData()){let h=py(e);D(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=p8();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=dy(t.pendingWriteTree_,i),d=t8(a,e,n,l,s,c);if(!u&&!o&&!r){let h=UV(a,e);d=d.concat(g8(t,e,h))}return d}function fy(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let c=Zt(o,e),u=ds(a,c);if(u)return u});return NV(i,e,s,n,!0)}function d8(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(u,l)=>{let d=Zt(u,n);r=r||ds(l,d)});let i=t.syncPointTree_.get(n);i?r=r||ds(i,_e()):(i=new Xm,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new Lr(r,!0,!1):null,a=dy(t.pendingWriteTree_,e._path),c=LV(i,e,a,s?o.getNode():ee.EMPTY_NODE,s);return K6(c)}function zc(t,e){return qV(e,t.syncPointTree_,null,dy(t.pendingWriteTree_,_e()))}function qV(t,e,n,r){if(ae(t.path))return HV(t,e,n,r);{let i=e.get(_e());n==null&&i!=null&&(n=ds(i,_e()));let s=[],o=oe(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){let u=n?n.getImmediateChild(o):null,l=PV(r,o);s=s.concat(qV(a,c,u,l))}return i&&(s=s.concat(qT(i,t,r,n))),s}}function HV(t,e,n,r){let i=e.get(_e());n==null&&i!=null&&(n=ds(i,_e()));let s=[];return e.children.inorderTraversal((o,a)=>{let c=n?n.getImmediateChild(o):null,u=PV(r,o),l=t.operationForChild(o);l&&(s=s.concat(HV(l,a,c,u)))}),i&&(s=s.concat(qT(i,t,r,n))),s}function GV(t,e){let n=e.query,r=zd(t,n);return{hashFn:()=>(W6(e)||ee.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?u8(t,n._path,r):c8(t,n._path);{let s=T5(i,n);return ty(t,n,null,s)}}}}function zd(t,e){let n=py(e);return t.queryToTagMap.get(n)}function py(t){return t._path.toString()+"$"+t._queryIdentifier}function GT(t,e){return t.tagToQueryMap.get(e)}function zT(t){let e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new we(t.substr(0,e))}}function WT(t,e,n){let r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");let i=dy(t.pendingWriteTree_,e);return qT(r,n,i,null)}function h8(t){return t.fold((e,n,r)=>{if(n&&ps(n))return[hy(n)];{let i=[];return n&&(i=jV(n)),bt(r,(s,o)=>{i=i.concat(o)}),i}})}function Fd(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(i8())(t._repo,t._path):t}function f8(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=py(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function p8(){return s8++}function g8(t,e,n){let r=e._path,i=zd(t,e),s=GV(t,n),o=t.listenProvider_.startListening(Fd(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!ps(a.value),"If we're adding a query, it shouldn't be shadowed");else{let c=a.fold((u,l,d)=>{if(!ae(u)&&l&&ps(l))return[hy(l).query];{let h=[];return l&&(h=h.concat(jV(l).map(f=>f.query))),bt(d,(f,p)=>{h=h.concat(p)}),h}});for(let u=0;u<c.length;++u){let l=c[u];t.listenProvider_.stopListening(Fd(l),zd(t,l))}}return o}var lT=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},dT=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=Be(this.path_,e);return new t(this.syncTree_,n)}node(){return fy(this.syncTree_,this.path_)}},m8=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},QF=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return y8(t[".sv"],e,n);if(typeof t[".sv"]=="object")return v8(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},y8=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},v8=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);let i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},zV=function(t,e,n,r){return QT(e,new dT(n,t),r)},KT=function(t,e,n){return QT(t,new lT(e),n)};function QT(t,e,n){let r=t.getPriority().val(),i=QF(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=QF(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new Vc(a,qe(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new Vc(i))),o.forEachChild(ke,(a,c)=>{let u=QT(c,e.getImmediateChild(a),n);u!==c&&(s=s.updateImmediateChild(a,u))}),s}}var Wd=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function gy(t,e){let n=e instanceof we?e:new we(e),r=t,i=oe(n);for(;i!==null;){let s=fi(r.node.children,i)||{children:{},childCount:0};r=new Wd(i,r,s),n=Me(n),i=oe(n)}return r}function Po(t){return t.node.value}function YT(t,e){t.node.value=e,hT(t)}function WV(t){return t.node.childCount>0}function _8(t){return Po(t)===void 0&&!WV(t)}function my(t,e){bt(t.node.children,(n,r)=>{e(new Wd(n,t,r))})}function KV(t,e,n,r){n&&!r&&e(t),my(t,i=>{KV(i,e,!0,r)}),n&&r&&e(t)}function w8(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function th(t){return new we(t.parent===null?t.name:th(t.parent)+"/"+t.name)}function hT(t){t.parent!==null&&E8(t.parent,t.name,t)}function E8(t,e,n){let r=_8(n),i=vn(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,hT(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,hT(t))}var I8=/[\[\].#$\/\u0000-\u001F\u007F]/,C8=/[\[\].#$\u0000-\u001F\u007F]/,CD=10*1024*1024,yy=function(t){return typeof t=="string"&&t.length!==0&&!I8.test(t)},QV=function(t){return typeof t=="string"&&t.length!==0&&!C8.test(t)},D8=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),QV(t)},Kd=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!cy(t)||t&&typeof t=="object"&&vn(t,".sv")},jr=function(t,e,n,r){r&&e===void 0||nh(tn(t,"value"),e,n)},nh=function(t,e,n){let r=n instanceof we?new FD(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ao(r));if(typeof e=="function")throw new Error(t+"contains a function "+Ao(r)+" with contents = "+e.toString());if(cy(e))throw new Error(t+"contains "+e.toString()+" "+Ao(r));if(typeof e=="string"&&e.length>CD/3&&Zc(e)>CD)throw new Error(t+"contains a string greater than "+CD+" utf8 bytes "+Ao(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(bt(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!yy(o)))throw new Error(t+" contains an invalid key ("+o+") "+Ao(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);e6(r,o),nh(t,a,r),t6(r)}),i&&s)throw new Error(t+' contains ".value" child '+Ao(r)+" in addition to actual children.")}},T8=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=Ld(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!yy(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(J5);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&Fn(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},YV=function(t,e,n,r){if(r&&e===void 0)return;let i=tn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];bt(e,(o,a)=>{let c=new we(o);if(nh(i,a,Be(n,c)),PT(c)===".priority"&&!Kd(a))throw new Error(i+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(c)}),T8(i,s)},ZT=function(t,e,n){if(!(n&&e===void 0)){if(cy(e))throw new Error(tn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Kd(e))throw new Error(tn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},rh=function(t,e,n,r){if(!(r&&n===void 0)&&!yy(n))throw new Error(tn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Wc=function(t,e,n,r){if(!(r&&n===void 0)&&!QV(n))throw new Error(tn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},b8=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Wc(t,e,n,r)},pn=function(t,e){if(oe(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},ZV=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!yy(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!D8(n))throw new Error(tn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var fT=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function vy(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!kT(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function XV(t,e,n){vy(t,n),JV(t,r=>kT(r,e))}function gn(t,e,n){vy(t,n),JV(t,r=>Fn(r,e)||Fn(e,r))}function JV(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(A8(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function A8(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();xo&&Tt("event: "+n.toString()),Hc(r)}}}var eL="repo_interrupt",S8=25,pT=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new fT,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Gm(),this.transactionQueueTree_=new Wd,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function x8(t,e,n){if(t.stats_=NT(t.repoInfo_),t.forceRestClient_||x5())t.server_=new WD(t.repoInfo_,(r,i,s,o)=>{YF(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>ZF(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{et(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new OT(t.repoInfo_,e,(r,i,s,o)=>{YF(t,r,i,s,o)},r=>{ZF(t,r)},r=>{M8(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=R5(t.repoInfo_,()=>new XD(t.stats_,t.server_)),t.infoData_=new KD,t.infoSyncTree_=new ey({startListening:(r,i,s,o)=>{let a=[],c=t.infoData_.getNode(r._path);return c.isEmpty()||(a=eh(t.infoSyncTree_,r._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),XT(t,"connected",!1),t.serverSyncTree_=new ey({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,c)=>{let u=o(a,c);gn(t.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function tL(t){let n=t.infoData_.getNode(new we(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function ih(t){return m8({timestamp:tL(t)})}function YF(t,e,n,r,i){t.dataUpdateCount++;let s=new we(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let c=Yc(n,u=>qe(u));o=l8(t.serverSyncTree_,s,c,i)}else{let c=qe(n);o=$V(t.serverSyncTree_,s,c,i)}else if(r){let c=Yc(n,u=>qe(u));o=a8(t.serverSyncTree_,s,c)}else{let c=qe(n);o=eh(t.serverSyncTree_,s,c)}let a=s;o.length>0&&(a=$c(t,s)),gn(t.eventQueue_,a,o)}function ZF(t,e){XT(t,"connected",e),e===!1&&P8(t)}function M8(t,e){bt(e,(n,r)=>{XT(t,n,r)})}function XT(t,e,n){let r=new we("/.info/"+e),i=qe(n);t.infoData_.updateSnapshot(r,i);let s=eh(t.infoSyncTree_,r,i);gn(t.eventQueue_,r,s)}function _y(t){return t.nextWriteId_++}function R8(t,e,n){let r=d8(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=qe(i).withIndex(e._queryParams.getIndex());uT(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=eh(t.serverSyncTree_,e._path,s);else{let a=zd(t.serverSyncTree_,e);o=$V(t.serverSyncTree_,e._path,s,a)}return gn(t.eventQueue_,e._path,o),ty(t.serverSyncTree_,e,n,null,!0),s},i=>(Kc(t,"get for query "+et(e)+" failed: "+i),Promise.reject(new Error(i))))}function JT(t,e,n,r,i){Kc(t,"set",{path:e.toString(),value:n,priority:r});let s=ih(t),o=qe(n,r),a=fy(t.serverSyncTree_,e),c=KT(o,a,s),u=_y(t),l=HT(t.serverSyncTree_,e,c,u,!0);vy(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||Ut("set at "+e+" failed: "+h);let g=us(t.serverSyncTree_,u,!p);gn(t.eventQueue_,e,g),gs(t,i,h,f)});let d=tb(t,e);$c(t,d),gn(t.eventQueue_,d,[])}function N8(t,e,n,r){Kc(t,"update",{path:e.toString(),value:n});let i=!0,s=ih(t),o={};if(bt(n,(a,c)=>{i=!1,o[a]=zV(Be(e,a),qe(c),t.serverSyncTree_,s)}),i)Tt("update() called with empty data.  Don't do anything."),gs(t,r,"ok",void 0);else{let a=_y(t),c=o8(t.serverSyncTree_,e,o,a);vy(t.eventQueue_,c),t.server_.merge(e.toString(),n,(u,l)=>{let d=u==="ok";d||Ut("update at "+e+" failed: "+u);let h=us(t.serverSyncTree_,a,!d),f=h.length>0?$c(t,e):e;gn(t.eventQueue_,f,h),gs(t,r,u,l)}),bt(n,u=>{let l=tb(t,Be(e,u));$c(t,l)}),gn(t.eventQueue_,e,[])}}function P8(t){Kc(t,"onDisconnectEvents");let e=ih(t),n=Gm();YD(t.onDisconnect_,_e(),(i,s)=>{let o=zV(i,s,t.serverSyncTree_,e);Gc(n,i,o)});let r=[];YD(n,_e(),(i,s)=>{r=r.concat(eh(t.serverSyncTree_,i,s));let o=tb(t,i);$c(t,o)}),t.onDisconnect_=Gm(),gn(t.eventQueue_,_e(),r)}function k8(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&QD(t.onDisconnect_,e),gs(t,n,r,i)})}function XF(t,e,n,r){let i=qe(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&Gc(t.onDisconnect_,e,i),gs(t,r,s,o)})}function O8(t,e,n,r,i){let s=qe(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&Gc(t.onDisconnect_,e,s),gs(t,i,o,a)})}function F8(t,e,n,r){if(fh(n)){Tt("onDisconnect().update() called with empty data.  Don't do anything."),gs(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&bt(n,(o,a)=>{let c=qe(a);Gc(t.onDisconnect_,Be(e,o),c)}),gs(t,r,i,s)})}function V8(t,e,n){let r;oe(e._path)===".info"?r=uT(t.infoSyncTree_,e,n):r=uT(t.serverSyncTree_,e,n),XV(t.eventQueue_,e._path,r)}function gT(t,e,n){let r;oe(e._path)===".info"?r=ty(t.infoSyncTree_,e,n):r=ty(t.serverSyncTree_,e,n),XV(t.eventQueue_,e._path,r)}function nL(t){t.persistentConnection_&&t.persistentConnection_.interrupt(eL)}function L8(t){t.persistentConnection_&&t.persistentConnection_.resume(eL)}function Kc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Tt(n,...e)}function gs(t,e,n,r){e&&Hc(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function j8(t,e,n,r,i,s){Kc(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:tV(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=eb(t,e,void 0);o.currentInputSnapshot=a;let c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{nh("transaction failed: Data returned ",c,o.path),o.status=0;let u=gy(t.transactionQueueTree_,e),l=Po(u)||[];l.push(o),YT(u,l);let d;typeof c=="object"&&c!==null&&vn(c,".priority")?(d=fi(c,".priority"),D(Kd(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(fy(t.serverSyncTree_,e)||ee.EMPTY_NODE).getPriority().val();let h=ih(t),f=qe(c,d),p=KT(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=_y(t);let g=HT(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);gn(t.eventQueue_,e,g),wy(t,t.transactionQueueTree_)}}function eb(t,e,n){return fy(t.serverSyncTree_,e,n)||ee.EMPTY_NODE}function wy(t,e=t.transactionQueueTree_){if(e||Ey(t,e),Po(e)){let n=iL(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&U8(t,th(e),n)}else WV(e)&&my(e,n=>{wy(t,n)})}function U8(t,e,n){let r=n.map(u=>u.currentWriteId),i=eb(t,e,r),s=i,o=i.hash();for(let u=0;u<n.length;u++){let l=n[u];D(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Zt(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),c=e;t.server_.put(c.toString(),a,u=>{Kc(t,"transaction put response",{path:c.toString(),status:u});let l=[];if(u==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(us(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();Ey(t,gy(t.transactionQueueTree_,e)),wy(t,t.transactionQueueTree_),gn(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)Hc(d[h])}else{if(u==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{Ut("transaction at "+c.toString()+" failed: "+u);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=u}$c(t,e)}},o)}function $c(t,e){let n=rL(t,e),r=th(n),i=iL(t,n);return B8(t,i,r),r}function B8(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let c=e[a],u=Zt(n,c.path),l=!1,d;if(D(u!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)l=!0,d=c.abortReason,i=i.concat(us(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=S8)l=!0,d="maxretry",i=i.concat(us(t.serverSyncTree_,c.currentWriteId,!0));else{let h=eb(t,c.path,o);c.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){nh("transaction failed: Data returned ",f,c.path);let p=qe(f);typeof f=="object"&&f!=null&&vn(f,".priority")||(p=p.updatePriority(h.getPriority()));let m=c.currentWriteId,w=ih(t),P=KT(p,h,w);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=P,c.currentWriteId=_y(t),o.splice(o.indexOf(m),1),i=i.concat(HT(t.serverSyncTree_,c.path,P,c.currentWriteId,c.applyLocally)),i=i.concat(us(t.serverSyncTree_,m,!0))}else l=!0,d="nodata",i=i.concat(us(t.serverSyncTree_,c.currentWriteId,!0))}gn(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}Ey(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Hc(r[a]);wy(t,t.transactionQueueTree_)}function rL(t,e){let n,r=t.transactionQueueTree_;for(n=oe(e);n!==null&&Po(r)===void 0;)r=gy(r,n),e=Me(e),n=oe(e);return r}function iL(t,e){let n=[];return sL(t,e,n),n.sort((r,i)=>r.order-i.order),n}function sL(t,e,n){let r=Po(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);my(e,i=>{sL(t,i,n)})}function Ey(t,e){let n=Po(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,YT(e,n.length>0?n:void 0)}my(e,r=>{Ey(t,r)})}function tb(t,e){let n=th(rL(t,e)),r=gy(t.transactionQueueTree_,e);return w8(r,i=>{DD(t,i)}),DD(t,r),KV(r,i=>{DD(t,i)}),n}function DD(t,e){let n=Po(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(us(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?YT(e,void 0):n.length=s+1,gn(t.eventQueue_,th(e),i);for(let o=0;o<r.length;o++)Hc(r[o])}}function $8(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function q8(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Ut(`Invalid query segment '${n}' in query '${t}'`)}return e}var mT=function(t,e){let n=H8(t),r=n.namespace;n.domain==="firebase.com"&&Vr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Vr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||w5();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Vm(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new we(n.pathString)}},H8=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",c=443;if(typeof t=="string"){let u=t.indexOf("//");u>=0&&(a=t.substring(0,u-1),t=t.substring(u+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=$8(t.substring(l,d)));let h=q8(t.substring(Math.min(t.length,d)));u=e.indexOf(":"),u>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(u+1),10)):u=e.length;let f=e.slice(0,u);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var JF="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",G8=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=JF.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=JF.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();var ny=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+et(this.snapshot.exportVal())}},ry=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var Qd=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var iy=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new yt;return k8(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){pn("OnDisconnect.remove",this._path);let e=new yt;return XF(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){pn("OnDisconnect.set",this._path),jr("OnDisconnect.set",e,this._path,!1);let n=new yt;return XF(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){pn("OnDisconnect.setWithPriority",this._path),jr("OnDisconnect.setWithPriority",e,this._path,!1),ZT("OnDisconnect.setWithPriority",n,!1);let r=new yt;return O8(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){pn("OnDisconnect.update",this._path),YV("OnDisconnect.update",e,this._path,!1);let n=new yt;return F8(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Jt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return ae(this._path)?null:PT(this._path)}get ref(){return new mn(this._repo,this._path)}get _queryIdentifier(){let e=jF(this._queryParams),n=RT(e);return n==="{}"?"default":n}get _queryObject(){return jF(this._queryParams)}isEqual(e){if(e=le(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=kT(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+X5(this._path)}};function Iy(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function ys(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Fr){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==hs)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==di)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===ke){if(e!=null&&!Kd(e)||n!=null&&!Kd(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof jd||t.getIndex()===VT,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Cy(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var mn=class t extends Jt{constructor(e,n){super(e,n,new qd,!1)}get parent(){let e=IV(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},qc=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new we(e),r=ms(this.ref,e);return new t(this._node.getChild(n),r,ke)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,ms(this.ref,r),ke)))}hasChild(e){let n=new we(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function nb(t,e){return t=le(t),t._checkNotDeleted("ref"),e!==void 0?ms(t._root,e):t._root}function rb(t,e){t=le(t),t._checkNotDeleted("refFromURL");let n=mT(e,t._repo.repoInfo_.nodeAdmin);ZV("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Vr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),nb(t,n.path.toString())}function ms(t,e){return t=le(t),oe(t._path)===null?b8("child","path",e,!1):Wc("child","path",e,!1),new mn(t._repo,Be(t._path,e))}function oL(t,e){t=le(t),pn("push",t._path),jr("push",e,t._path,!0);let n=tL(t._repo),r=G8(n),i=ms(t,r),s=ms(t,r),o;return e!=null?o=Dy(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function aL(t){return pn("remove",t._path),Dy(t,null)}function Dy(t,e){t=le(t),pn("set",t._path),jr("set",e,t._path,!1);let n=new yt;return JT(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function cL(t,e){t=le(t),pn("setPriority",t._path),ZT("setPriority",e,!1);let n=new yt;return JT(t._repo,Be(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function uL(t,e,n){if(pn("setWithPriority",t._path),jr("setWithPriority",e,t._path,!1),ZT("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new yt;return JT(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function lL(t,e){YV("update",e,t._path,!1);let n=new yt;return N8(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function dL(t){t=le(t);let e=new Qd(()=>{}),n=new Yd(e);return R8(t._repo,t,n).then(r=>new qc(r,new mn(t._repo,t._path),t._queryParams.getIndex()))}var Yd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new ny("value",this,new qc(e.snapshotNode,new mn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new ry(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},sy=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new ry(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");let r=ms(new mn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new ny(e.type,this,new qc(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function sh(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let c=n,u=(l,d)=>{gT(t._repo,t,a),c(l,d)};u.userCallback=n.userCallback,u.context=n.context,n=u}let o=new Qd(n,s||void 0),a=e==="value"?new Yd(o):new sy(e,o);return V8(t._repo,t,a),()=>gT(t._repo,t,a)}function Ty(t,e,n,r){return sh(t,"value",e,n,r)}function ib(t,e,n,r){return sh(t,"child_added",e,n,r)}function sb(t,e,n,r){return sh(t,"child_changed",e,n,r)}function ob(t,e,n,r){return sh(t,"child_moved",e,n,r)}function ab(t,e,n,r){return sh(t,"child_removed",e,n,r)}function cb(t,e,n){let r=null,i=n?new Qd(n):null;e==="value"?r=new Yd(i):e&&(r=new sy(e,i)),gT(t._repo,t,r)}var yn=class{},oy=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){jr("endAt",this._value,e._path,!0);let n=zD(e._queryParams,this._value,this._key);if(Cy(n),ys(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Jt(e._repo,e._path,n,e._orderByCalled)}};function hL(t,e){return rh("endAt","key",e,!0),new oy(t,e)}var yT=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){jr("endBefore",this._value,e._path,!1);let n=y6(e._queryParams,this._value,this._key);if(Cy(n),ys(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Jt(e._repo,e._path,n,e._orderByCalled)}};function fL(t,e){return rh("endBefore","key",e,!0),new yT(t,e)}var ay=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){jr("startAt",this._value,e._path,!0);let n=GD(e._queryParams,this._value,this._key);if(Cy(n),ys(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Jt(e._repo,e._path,n,e._orderByCalled)}};function pL(t=null,e){return rh("startAt","key",e,!0),new ay(t,e)}var vT=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){jr("startAfter",this._value,e._path,!1);let n=m6(e._queryParams,this._value,this._key);if(Cy(n),ys(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Jt(e._repo,e._path,n,e._orderByCalled)}};function gL(t,e){return rh("startAfter","key",e,!0),new vT(t,e)}var _T=class extends yn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Jt(e._repo,e._path,p6(e._queryParams,this._limit),e._orderByCalled)}};function mL(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new _T(t)}var wT=class extends yn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Jt(e._repo,e._path,g6(e._queryParams,this._limit),e._orderByCalled)}};function yL(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new wT(t)}var ET=class extends yn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){Iy(e,"orderByChild");let n=new we(this._path);if(ae(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new jd(n),i=uy(e._queryParams,r);return ys(i),new Jt(e._repo,e._path,i,!0)}};function vL(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Wc("orderByChild","path",t,!1),new ET(t)}var IT=class extends yn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){Iy(e,"orderByKey");let n=uy(e._queryParams,Fr);return ys(n),new Jt(e._repo,e._path,n,!0)}};function _L(){return new IT}var CT=class extends yn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){Iy(e,"orderByPriority");let n=uy(e._queryParams,ke);return ys(n),new Jt(e._repo,e._path,n,!0)}};function wL(){return new CT}var DT=class extends yn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){Iy(e,"orderByValue");let n=uy(e._queryParams,VT);return ys(n),new Jt(e._repo,e._path,n,!0)}};function EL(){return new DT}var TT=class extends yn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(jr("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new oy(this._value,this._key)._apply(new ay(this._value,this._key)._apply(e))}};function IL(t,e){return rh("equalTo","key",e,!0),new TT(t,e)}function Ln(t,...e){let n=le(t);for(let r of e)n=r._apply(n);return n}X6(mn);r8(mn);var z8="FIREBASE_DATABASE_EMULATOR_HOST",bT={},W8=!1;function K8(t,e,n,r){t.repoInfo_=new Vm(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function ub(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Vr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Tt("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=mT(s,i),a=o.repoInfo,c,u;typeof process<"u"&&process.env&&(u=process.env[z8]),u?(c=!0,s=`http://${u}?ns=${a.namespace}`,o=mT(s,i),a=o.repoInfo):c=!o.repoInfo.secure;let l=i&&c?new Pd(Pd.OWNER):new MD(t.name,t.options,e);ZV("Invalid Firebase Database URL",o),ae(o.path)||Vr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=Y8(a,t,l,new xD(t.name,n));return new AT(d,t)}function Q8(t,e){let n=bT[e];(!n||n[t.key]!==t)&&Vr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),nL(t),delete n[t.key]}function Y8(t,e,n,r){let i=bT[e.name];i||(i={},bT[e.name]=i);let s=i[t.toURLString()];return s&&Vr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new pT(t,W8,n,r),i[t.toURLString()]=s,s}var AT=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(x8(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new mn(this._repo,_e())),this._rootInternal}_delete(){return this._rootInternal!==null&&(Q8(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Vr("Cannot call "+e+" on a deleted database.")}};function CL(){EV.IS_TRANSPORT_INITIALIZED&&Ut("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function DL(){CL(),Vd.forceDisallow()}function TL(){CL(),Pc.forceDisallow(),Vd.forceAllow()}function bL(t,e,n,r={}){t=le(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Vr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Vr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Pd(Pd.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:lh(r.mockUserToken,t.app.options.projectId);s=new Pd(o)}K8(i,e,n,s)}function AL(t){t=le(t),t._checkNotDeleted("goOffline"),nL(t._repo)}function SL(t){t=le(t),t._checkNotDeleted("goOnline"),L8(t._repo)}function xL(t,e){rV(t,e)}function Z8(t){MT(gh),vs(new an("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return ub(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),jn(IF,CF,t),jn(IF,CF,"esm2017")}var X8={".sv":"timestamp"};function ML(){return X8}function RL(t){return{".sv":{increment:t}}}var ST=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function NL(t,e,n){var r;if(t=le(t),pn("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new yt,o=(c,u,l)=>{let d=null;c?s.reject(c):(d=new qc(l,new mn(t._repo,t._path),ke),s.resolve(new ST(u,d)))},a=Ty(t,()=>{});return j8(t._repo,t._path,e,o,a,i),s.promise}OT.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};OT.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};Z8();var J8="@firebase/database-compat",eK="1.0.3";var tK=new pi("@firebase/database-compat"),PL=function(t){let e="FIREBASE WARNING: "+t;tK.warn(e)};var nK=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(tn(t,e)+"must be a boolean.")},rK=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(tn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var lb=class{constructor(e){this._delegate=e}cancel(e){z("OnDisconnect.cancel",0,1,arguments.length),lt("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){z("OnDisconnect.remove",0,1,arguments.length),lt("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){z("OnDisconnect.set",1,2,arguments.length),lt("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){z("OnDisconnect.setWithPriority",2,3,arguments.length),lt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(z("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,PL("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}lt("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var db=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return z("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var ko=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return z("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return z("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return z("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return z("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return z("DataSnapshot.child",0,1,arguments.length),e=String(e),Wc("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return z("DataSnapshot.hasChild",1,1,arguments.length),Wc("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return z("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return z("DataSnapshot.forEach",1,1,arguments.length),lt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return z("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return z("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return z("DataSnapshot.ref",0,0,arguments.length),new hi(this._database,this._delegate.ref)}get ref(){return this.getRef()}},by=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;z("Query.on",2,4,arguments.length),lt("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(u,l)=>{n.call(o.context,new ko(this.database,u),l)};a.userCallback=n,a.context=o.context;let c=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return Ty(this._delegate,a,c),n;case"child_added":return ib(this._delegate,a,c),n;case"child_removed":return ab(this._delegate,a,c),n;case"child_changed":return sb(this._delegate,a,c),n;case"child_moved":return ob(this._delegate,a,c),n;default:throw new Error(tn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(z("Query.off",0,3,arguments.length),rK("Query.off",e,!0),lt("Query.off","callback",n,!0),Py("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,cb(this._delegate,e,i)}else cb(this._delegate,e)}get(){return dL(this._delegate).then(e=>new ko(this.database,e))}once(e,n,r,i){z("Query.once",1,4,arguments.length),lt("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new yt,a=(u,l)=>{let d=new ko(this.database,u);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let c=u=>{s.cancel&&s.cancel.call(s.context,u),o.reject(u)};switch(e){case"value":Ty(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":ib(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":ab(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":sb(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":ob(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(tn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return z("Query.limitToFirst",1,1,arguments.length),new t(this.database,Ln(this._delegate,mL(e)))}limitToLast(e){return z("Query.limitToLast",1,1,arguments.length),new t(this.database,Ln(this._delegate,yL(e)))}orderByChild(e){return z("Query.orderByChild",1,1,arguments.length),new t(this.database,Ln(this._delegate,vL(e)))}orderByKey(){return z("Query.orderByKey",0,0,arguments.length),new t(this.database,Ln(this._delegate,_L()))}orderByPriority(){return z("Query.orderByPriority",0,0,arguments.length),new t(this.database,Ln(this._delegate,wL()))}orderByValue(){return z("Query.orderByValue",0,0,arguments.length),new t(this.database,Ln(this._delegate,EL()))}startAt(e=null,n){return z("Query.startAt",0,2,arguments.length),new t(this.database,Ln(this._delegate,pL(e,n)))}startAfter(e=null,n){return z("Query.startAfter",0,2,arguments.length),new t(this.database,Ln(this._delegate,gL(e,n)))}endAt(e=null,n){return z("Query.endAt",0,2,arguments.length),new t(this.database,Ln(this._delegate,hL(e,n)))}endBefore(e=null,n){return z("Query.endBefore",0,2,arguments.length),new t(this.database,Ln(this._delegate,fL(e,n)))}equalTo(e,n){return z("Query.equalTo",1,2,arguments.length),new t(this.database,Ln(this._delegate,IL(e,n)))}toString(){return z("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return z("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(z("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,lt(e,"cancel",i.cancel,!0),i.context=r,Py(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(tn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new hi(this.database,new mn(this._delegate._repo,this._delegate._path))}},hi=class t extends by{constructor(e,n){super(e,new Jt(n._repo,n._path,new qd,!1)),this.database=e,this._delegate=n}getKey(){return z("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return z("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,ms(this._delegate,e))}getParent(){z("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return z("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){z("Reference.set",1,2,arguments.length),lt("Reference.set","onComplete",n,!0);let r=Dy(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(z("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,PL("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}pn("Reference.update",this._delegate._path),lt("Reference.update","onComplete",n,!0);let r=lL(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){z("Reference.setWithPriority",2,3,arguments.length),lt("Reference.setWithPriority","onComplete",r,!0);let i=uL(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){z("Reference.remove",0,1,arguments.length),lt("Reference.remove","onComplete",e,!0);let n=aL(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){z("Reference.transaction",1,3,arguments.length),lt("Reference.transaction","transactionUpdate",e,!1),lt("Reference.transaction","onComplete",n,!0),nK("Reference.transaction","applyLocally",r,!0);let i=NL(this._delegate,e,{applyLocally:r}).then(s=>new db(s.committed,new ko(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){z("Reference.setPriority",1,2,arguments.length),lt("Reference.setPriority","onComplete",n,!0);let r=cL(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){z("Reference.push",0,2,arguments.length),lt("Reference.push","onComplete",n,!0);let r=oL(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return pn("Reference.onDisconnect",this._delegate._path),new lb(new iy(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var Oo=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:DL,forceLongPolling:TL}}useEmulator(e,n,r={}){bL(this._delegate,e,n,r)}ref(e){if(z("database.ref",0,1,arguments.length),e instanceof hi){let n=rb(this._delegate,e.toString());return new hi(this,n)}else{let n=nb(this._delegate,e);return new hi(this,n)}}refFromURL(e){z("database.refFromURL",1,1,arguments.length);let r=rb(this._delegate,e);return new hi(this,r)}goOffline(){return z("database.goOffline",0,0,arguments.length),AL(this._delegate)}goOnline(){return z("database.goOnline",0,0,arguments.length),SL(this._delegate)}};Oo.ServerValue={TIMESTAMP:ML(),increment:t=>RL(t)};function iK({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){MT(n);let a=new ky("database-standalone"),c=new ph("auth-internal",a);c.setComponent(new an("auth-internal",()=>r,"PRIVATE"));let u;return i&&(u=new ph("app-check-internal",a),u.setComponent(new an("app-check-internal",()=>i,"PRIVATE"))),{instance:new Oo(ub(t,c,u,e,o),t),namespace:s}}var sK=Object.freeze({__proto__:null,initStandalone:iK});var oK=Oo.ServerValue;function aK(t){t.INTERNAL.registerComponent(new an("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new Oo(i,r)},"PUBLIC").setServiceProps({Reference:hi,Query:by,Database:Oo,DataSnapshot:ko,enableLogging:xL,INTERNAL:sK,ServerValue:oK}).setMultipleInstances(!0)),t.registerVersion(J8,eK)}aK(vt);function oh(t,e,n="on",r=Cs){return new ne(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(O(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),ru())}function cK(t){return typeof t=="string"}function uK(t){return typeof t.exportVal=="function"}function LL(t){return t==null}function jL(t){return typeof t.set=="function"}function kL(t,e){return jL(e)?e:t.ref(e)}function UL(t,e){if(cK(t))return e.stringCase();if(jL(t))return e.firebaseCase();if(uK(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function BL(t){return(LL(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function $L(t,e,n){e=BL(e);let r=e.map(i=>oh(t,i,"on",n));return Qo(...r)}function lK(t,e,n){let r=$L(t,e).pipe(lr((i,s)=>[...i,s],[]));return hK(t,r,n)}function dK(t,e){return oh(t,"value","on",e).pipe(O(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function hK(t,e,n){return dK(t,n).pipe(iv(e),O(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(c=>c.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),nv(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),O(i=>i.actions))}function OL(t,e){return function(r,i){return UL(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function fK(t){return function(n){return n?UL(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function pK(t,e,n){return oh(t,"value","once",n).pipe(Re(r=>{let i=[U(r)];return e.forEach(s=>i.push(oh(t,s,"on",n))),Qo(...i).pipe(lr(mK,[]))}),tu())}function qL(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function gK(t,e){if(LL(e))return 0;{let n=qL(t,e);return n===-1?t.length:n+1}}function mK(t,e){let{payload:n,prevKey:r,key:i}=e,s=qL(t,i),o=gK(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(c=>{let u={payload:c,type:"value",prevKey:a,key:c.key};return a=c.key,t=[...t,u],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(c=>c.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function FL(t,e,n){return e=BL(e),pK(t,e,n)}function yK(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:OL(r,"update"),set:OL(r,"set"),push:i=>r.push(i),remove:fK(r),snapshotChanges(i){return FL(t,i,n).pipe(Ye)},stateChanges(i){return $L(t,i,n).pipe(Ye)},auditTrail(i){return lK(t,i,n).pipe(Ye)},valueChanges(i,s){return FL(t,i,n).pipe(O(a=>a.map(c=>s&&s.idField?ge(x({},c.payload.val()),{[s.idField]:c.key}):c.payload.val())),Ye)}}}function VL(t,e){return function(){return oh(t,"value","on",e)}}function vK(t,e){return{query:t,snapshotChanges(){return VL(t,e.schedulers.outsideAngular)().pipe(Ye)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return VL(t,e.schedulers.outsideAngular)().pipe(Ye,O(r=>r.payload.exists()?r.payload.val():null))}}}var _K=new A("angularfire2.realtimeDatabaseURL"),wK=new A("angularfire2.database.use-emulator"),EK=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,c,u,l,d,h,f,p,g,m){this.schedulers=a;let w=c,P=Ws(n,o,r);u&&gl(P,o,l,h,f,p,d,g),this.database=Ua(`${P.name}.database.${i}`,"AngularFireDatabase",P.name,()=>{let T=o.runOutsideAngular(()=>P.database(i||void 0));return w&&T.useEmulator(...w),T},[w])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>kL(this.database,n)),s=i;return r&&(s=r(i)),yK(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>kL(this.database,n));return vK(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(E(Li),E(ji,8),E(_K,8),E(_t),E(de),E(ja),E(wK,8),E(Ks,8),E(ul,8),E(ll,8),E(dl,8),E(hl,8),E(fl,8),E(pl,8),E(Jr,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),HL=(()=>{class t{constructor(){vt.registerVersion("angularfire",Fi.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Le({type:t});static \u0275inj=je({providers:[EK]})}return t})();var GL=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Le({type:e,bootstrap:[EF]}),e.\u0275inj=je({imports:[vN,PM,wF,DM,eN,tN,yN.initializeApp({apiKey:"AIzaSyDWB3HnIpD_A1sP9w9mldueXqMQn9Y0P1c",authDomain:"shop-79eaa.firebaseapp.com",databaseURL:"https://shop-79eaa-default-rtdb.firebaseio.com",projectId:"shop-79eaa",storageBucket:"shop-79eaa.appspot.com",messagingSenderId:"271724379478",appId:"1:271724379478:web:06726cedaab0d43bc12af7"}),HL]});let t=e;return t})();NM().bootstrapModule(GL).catch(t=>console.error(t));
